VERSION 5.00
Object = "{B02F3647-766B-11CE-AF28-C3A2FBE76A13}#3.0#0"; "SPR32X30.ocx"
Object = "{831FDD16-0C5C-11D2-A9FC-0000F8754DA1}#2.0#0"; "MSCOMCTL.OCX"
Begin VB.Form frmQPAV_CEnt082 
   BorderStyle     =   1  'å≈íË(é¿ê¸)
   Caption         =   "ñºäÒÇπì¸óÕ"
   ClientHeight    =   8250
   ClientLeft      =   585
   ClientTop       =   1500
   ClientWidth     =   14325
   KeyPreview      =   -1  'True
   LinkTopic       =   "Form5"
   LockControls    =   -1  'True
   ScaleHeight     =   8250
   ScaleWidth      =   14325
   StartUpPosition =   2  'âÊñ ÇÃíÜâõ
   Begin MSComctlLib.ProgressBar prgBar 
      Height          =   240
      Left            =   4245
      TabIndex        =   23
      Top             =   7980
      Visible         =   0   'False
      Width           =   3780
      _ExtentX        =   6668
      _ExtentY        =   423
      _Version        =   393216
      Appearance      =   1
   End
   Begin MSComctlLib.StatusBar stbSystem 
      Align           =   2  'â∫ëµÇ¶
      Height          =   330
      Left            =   0
      TabIndex        =   22
      Top             =   7920
      Width           =   14325
      _ExtentX        =   25268
      _ExtentY        =   582
      _Version        =   393216
      BeginProperty Panels {8E3867A5-8586-11D1-B16A-00C0F0283628} 
         NumPanels       =   5
         BeginProperty Panel1 {8E3867AB-8586-11D1-B16A-00C0F0283628} 
            AutoSize        =   1
            Object.Width           =   14208
         EndProperty
         BeginProperty Panel2 {8E3867AB-8586-11D1-B16A-00C0F0283628} 
            Object.Width           =   2822
            MinWidth        =   2822
            Text            =   "ïxémí Å@ëæòY"
            TextSave        =   "ïxémí Å@ëæòY"
         EndProperty
         BeginProperty Panel3 {8E3867AB-8586-11D1-B16A-00C0F0283628} 
            Object.Width           =   2999
            MinWidth        =   2999
            Text            =   "9999999999999999"
            TextSave        =   "9999999999999999"
         EndProperty
         BeginProperty Panel4 {8E3867AB-8586-11D1-B16A-00C0F0283628} 
            Style           =   6
            Alignment       =   1
            TextSave        =   "2006/04/21"
         EndProperty
         BeginProperty Panel5 {8E3867AB-8586-11D1-B16A-00C0F0283628} 
            Style           =   5
            Alignment       =   1
            TextSave        =   "18:53"
         EndProperty
      EndProperty
   End
   Begin VB.PictureBox Picture1 
      Height          =   7005
      Left            =   0
      ScaleHeight     =   6945
      ScaleWidth      =   14265
      TabIndex        =   18
      TabStop         =   0   'False
      Top             =   0
      Width           =   14325
      Begin VB.Frame Frame1 
         Appearance      =   0  'Ã◊Øƒ
         ForeColor       =   &H80000008&
         Height          =   810
         Left            =   75
         TabIndex        =   20
         Top             =   0
         Width           =   14115
         Begin VB.TextBox txtKaiinsimeiKana 
            BackColor       =   &H00FFFFFF&
            BeginProperty Font 
               Name            =   "ÇlÇr ÉSÉVÉbÉN"
               Size            =   11.25
               Charset         =   128
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   330
            IMEMode         =   6  'îºäp∂¿∂≈
            Left            =   5130
            MaxLength       =   30
            TabIndex        =   0
            Top             =   285
            Width           =   3330
         End
         Begin VB.Label lblLabel 
            Alignment       =   2  'íÜâõëµÇ¶
            AutoSize        =   -1  'True
            Caption         =   "é–àıéÅñº(∂≈)"
            BeginProperty Font 
               Name            =   "ÇlÇr ÉSÉVÉbÉN"
               Size            =   11.25
               Charset         =   128
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00000000&
            Height          =   225
            Index           =   2
            Left            =   3495
            TabIndex        =   21
            Top             =   345
            Width           =   1395
         End
      End
      Begin VB.Frame Frame2 
         Appearance      =   0  'Ã◊Øƒ
         ForeColor       =   &H80000008&
         Height          =   5520
         Left            =   75
         TabIndex        =   19
         Top             =   840
         Width           =   14115
         Begin FPSpread.vaSpread sprList 
            Height          =   4770
            Left            =   405
            TabIndex        =   1
            Top             =   420
            Width           =   13305
            _Version        =   196608
            _ExtentX        =   23469
            _ExtentY        =   8414
            _StockProps     =   64
            MaxCols         =   8
            MaxRows         =   20
            OperationMode   =   2
            ScrollBarExtMode=   -1  'True
            ScrollBars      =   2
            SelectBlockOptions=   0
            SpreadDesigner  =   "QPAV_CEnt082.frx":0000
            VisibleCols     =   500
            VisibleRows     =   500
         End
      End
      Begin VB.CommandButton cmdExec 
         Caption         =   "åà íË"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   480
         Left            =   75
         TabIndex        =   2
         Top             =   6420
         Width           =   1230
      End
   End
   Begin VB.PictureBox picPfMenu 
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   8.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   480
      Left            =   0
      ScaleHeight     =   420
      ScaleWidth      =   14265
      TabIndex        =   10
      TabStop         =   0   'False
      Top             =   7440
      Width           =   14325
      Begin VB.CommandButton cmdPFK 
         Caption         =   "F12:éÊè¡"
         Height          =   375
         Index           =   12
         Left            =   13080
         TabIndex        =   7
         Top             =   30
         Width           =   1155
      End
      Begin VB.CommandButton cmdPFK 
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   11
         Left            =   11895
         TabIndex        =   17
         TabStop         =   0   'False
         Top             =   30
         Width           =   1155
      End
      Begin VB.CommandButton cmdPFK 
         Caption         =   "F10:ëOâÊñ "
         Height          =   375
         Index           =   10
         Left            =   10710
         TabIndex        =   6
         Top             =   30
         Width           =   1155
      End
      Begin VB.CommandButton cmdPFK 
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   9
         Left            =   9525
         TabIndex        =   16
         TabStop         =   0   'False
         Top             =   30
         Width           =   1155
      End
      Begin VB.CommandButton cmdPFK 
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   8
         Left            =   8340
         TabIndex        =   15
         TabStop         =   0   'False
         Top             =   30
         Width           =   1155
      End
      Begin VB.CommandButton cmdPFK 
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   7
         Left            =   7155
         TabIndex        =   14
         TabStop         =   0   'False
         Top             =   30
         Width           =   1155
      End
      Begin VB.CommandButton cmdPFK 
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   6
         Left            =   5970
         TabIndex        =   13
         TabStop         =   0   'False
         Top             =   30
         Width           =   1155
      End
      Begin VB.CommandButton cmdPFK 
         Caption         =   "F5:é¿çs"
         Height          =   375
         Index           =   5
         Left            =   4785
         TabIndex        =   5
         Top             =   30
         Width           =   1155
      End
      Begin VB.CommandButton cmdPFK 
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   4
         Left            =   3600
         TabIndex        =   12
         TabStop         =   0   'False
         Top             =   30
         Width           =   1155
      End
      Begin VB.CommandButton cmdPFK 
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   3
         Left            =   2415
         TabIndex        =   11
         TabStop         =   0   'False
         Top             =   30
         Width           =   1155
      End
      Begin VB.CommandButton cmdPFK 
         Caption         =   "F2: ∞ƒﬁ∫Àﬂ∞"
         Height          =   375
         Index           =   2
         Left            =   1230
         TabIndex        =   4
         Top             =   30
         Width           =   1155
      End
      Begin VB.CommandButton cmdPFK 
         Height          =   375
         Index           =   1
         Left            =   45
         TabIndex        =   3
         Top             =   30
         Width           =   1155
      End
   End
   Begin VB.PictureBox picMsg 
      BackColor       =   &H00FFFFFF&
      Height          =   405
      Left            =   0
      ScaleHeight     =   345
      ScaleWidth      =   14265
      TabIndex        =   8
      TabStop         =   0   'False
      Top             =   7020
      Width           =   14325
      Begin VB.Label lblMsg 
         BackStyle       =   0  'ìßñæ
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H000000FF&
         Height          =   285
         Left            =   30
         TabIndex        =   9
         Top             =   30
         Width           =   12405
      End
   End
End
Attribute VB_Name = "frmQPAV_CEnt082"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit
Private blnInit_Flg       As Boolean     'èâä˙ÉtÉâÉO
Private strSyainMyouji    As String      'âÔàıéÅñºÉJÉiñºéöÅ@ñºäÒÇπåüçıópïœêî
Private strSyainNamae     As String      'âÔàıéÅñºÉJÉiñºëOÅ@ñºäÒÇπåüçıópïœêî
'******************************************************************************
'*    FORM_LOAD ÉCÉxÉìÉg
'******************************************************************************
Private Sub Form_Load()
    
'ADD 2006.04.28 by NBC.Nomura >> ã@ñßèÓïÒÇÃàÛç¸ÅEÉRÉsÅ[êßå¿é¿é{ <<
    Dim clsActX490 As QSAV_ActX490.ActX490C
    
    Me.Caption = "ñºäÒÇπåüçı (" & gstrCommandLine(8) & ")"
    
    'Å°âÊñ èâä˙âª
    Call subFormInitialize
    
'-- Start Of ADD 2006.04.28 by NBC.Nomura >> ã@ñßèÓïÒÇÃàÛç¸ÅEÉRÉsÅ[êßå¿é¿é{ <<
    'ëÄçÏêßå¿âÊñ îªíËèàóù
    Set clsActX490 = CreateObject("QSAV_ActX490.ActX490C")
    Set clsActX490.podbDatabase = odbDatabase
    Call clsActX490.subQSAV_ActX490(Me.Name, _
                                    gstrCommandLine(1), _
                                    gstrCommandLine(5), _
                                    gstrCommandLine(8), _
                                    gstrCommandLine(10), _
                                    gstrCommandLine(11))
    Me.Caption = Me.Caption & clsActX490.strHcopyNotName
    Set clsActX490 = Nothing
'-- Finish Of ADD 2006.04.28 by NBC.Nomura >> ã@ñßèÓïÒÇÃàÛç¸ÅEÉRÉsÅ[êßå¿é¿é{ <<
    
    'ñºäÒÇπÃ◊∏ﬁèâä˙âª
    gblnNayoseFlg = False
    
End Sub
'******************************************************************************
'*    FORM UNLOAD ÉCÉxÉìÉg
'******************************************************************************
Private Sub Form_Unload(CANCEL As Integer)
End Sub
'******************************************************************************
'*    FORM_ACTIVATE ÉCÉxÉìÉg
'******************************************************************************
Private Sub Form_Activate()
End Sub
'******************************************************************************
'*    FORM_KEYDOWN ÉtÉ@ÉìÉNÉVÉáÉìÉLÅ[ê›íË
'******************************************************************************
Private Sub Form_KeyDown(KeyCode As Integer, Shift As Integer)
    
    Select Case KeyCode
        Case vbKeyReturn   'Enter
            SendKeys "{TAB}"
        Case vbKeyF1   'F1
            Call cmdPFK_Click(1)
        Case vbKeyF2   'F2
            Call cmdPFK_Click(2)
        Case vbKeyF5   'F5
            If cmdPFK(5).Enabled = True Then
                Call cmdPFK_Click(5)
            End If
        Case vbKeyF10   'F10
            Call cmdPFK_Click(10)
        Case vbKeyF12   'F12
            Call cmdPFK_Click(12)
        Case vbKeyDelete    'DELÉLÅ[ÇâüÇµÇΩéû
            Call Form_KeyPress(46)
        Case vbKeyUp
            Call subErrKaijo
        Case vbKeyDown
            Call subErrKaijo
        Case vbKeyRight
            Call subErrKaijo
        Case vbKeyLeft
            Call subErrKaijo
    End Select

End Sub
'******************************************************************************
'*    FORM_KEYPRESS ÉCÉxÉìÉg
'******************************************************************************
Private Sub Form_KeyPress(KeyAscii As Integer)

    'ENTER Beepâπè¡ãé
    Call subErrKaijo
        
    If KeyAscii = vbKeyReturn Then
        KeyAscii = 0
    End If

End Sub
'******************************************************************************
'*    äeÉtÉ@ÉìÉNÉVÉáÉìÉLÅ[ã@î\
'******************************************************************************
Private Sub cmdPFK_Click(Index As Integer)
    
'ADD 2006.04.28 by NBC.Nomura >> ã@ñßèÓïÒÇÃàÛç¸ÅEÉRÉsÅ[êßå¿é¿é{ <<
    Dim clsActX1001     As QSAV_ActX1001.ActX1001C
    
    Select Case Index
        Case 1  'ÉÅÉjÉÖÅ[
'            Unload Me
'            Exit Sub
        Case 2  'ÉnÅ[ÉhÉRÉsÅ[
'DEL 2006.04.28 by NBC.Nomura >> ã@ñßèÓïÒÇÃàÛç¸ÅEÉRÉsÅ[êßå¿é¿é{ <<
'           Call gsubQSAV_ActX1001
'--Start Of ADD 2006.04.28 by NBC.Nomura >> ã@ñßèÓïÒÇÃàÛç¸ÅEÉRÉsÅ[êßå¿é¿é{ <<
            'ÉnÅ[ÉhÉRÉsÅ[ópDLLåƒèoèàóùÇ…âÊñ ÉLÉÉÉvÉVÉáÉìÇÉpÉâÉÅÅ[É^Ç∆ÇµÇƒí«â¡
            Set clsActX1001 = CreateObject("QSAV_ActX1001.ActX1001C")
            Call clsActX1001.subQSAV_ActX1001(Me.Caption)
            
            Set clsActX1001 = Nothing
'--Finish Of ADD 2006.04.28 by NBC.Nomura >> ã@ñßèÓïÒÇÃàÛç¸ÅEÉRÉsÅ[êßå¿é¿é{ <<
        
        Case 5  'é¿çs
            Call subcmdPFK5
        Case 10 'ëOâÊñ 
            Unload Me
            Exit Sub
        Case 12 'éÊè¡
            Call subFormInitialize
            txtKaiinsimeiKana.SetFocus
    End Select
    
End Sub
'******************************************************************************
'*    âÊñ èâä˙âª
'******************************************************************************
Private Sub subFormInitialize()
 Dim intX As Integer
 
    'äeï\é¶çÄñ⁄ÉNÉäÉA
    txtKaiinsimeiKana.Text = ""
    lblMsg.Caption = ""
    Call gsubSpdClear(sprList)
    sprList.MaxRows = 0

    cmdPFK(5).Enabled = True
    cmdExec.Enabled = False
    
    'ÉXÉeÅ[É^ÉXÉoÅ[èâä˙âª
    Call gsubInitStatusBar(stbSystem)
    
    'äeÉRÉìÉgÉçÅ[Éãêßå‰
    txtKaiinsimeiKana.Enabled = True

End Sub
'******************************************************************************
'*    é¿çsÉ{É^Éìèàóù
'******************************************************************************
Private Sub subcmdPFK5()
 Dim intNameSpcPst As Integer 'ÉXÉyÅ[ÉXà íu
 Dim intNameLen    As Integer 'ï∂éöêî
 Dim strSyainName  As String

    cmdPFK(5).SetFocus

    'Å°ì¸óÕÉ`ÉFÉbÉN
    If txtKaiinsimeiKana.Text = "" Then
        lblMsg.Caption = "é–àıéÅñºÅiÉJÉiÅjÇì¸óÕÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB"
        txtKaiinsimeiKana.BackColor = vbRed
        txtKaiinsimeiKana.Enabled = True
        txtKaiinsimeiKana.SetFocus
        Exit Sub
    Else
        strSyainName = Trim$(txtKaiinsimeiKana)
    End If
    
    If InStr(strSyainName, " ") = 0 Then
        strSyainMyouji = strSyainName
        strSyainNamae = strSyainName
    Else
        intNameSpcPst = InStr(strSyainName, " ")
        intNameLen = Len(strSyainName)
        strSyainMyouji = Mid(strSyainName, 1, intNameSpcPst - 1)
        strSyainNamae = Mid(strSyainName, intNameSpcPst + 1, intNameLen - intNameSpcPst)
    End If
        
    'àÍóóÇ™ï\é¶Ç≥ÇÍÇÈÇ‹Ç≈é¿çsŒﬁ¿›,ñºäÒÇπÇégópïsâ¬ÅEÉ}ÉEÉXÉ|ÉCÉìÉ^Å[(çªéûåv)
    cmdPFK(5).Enabled = False
    Screen.MousePointer = vbHourglass
    stbSystem.Panels.Item(1).Text = "èàóùíÜÅDÅDÅD"
    DoEvents
    
    'Å°ñºäÒÇπåüçıópSPåƒèo
    If fncblnSyainSearch = False Then
        prgBar.Visible = False
        cmdPFK(5).Enabled = True
        Screen.MousePointer = vbNormal
        stbSystem.Panels.Item(1).Text = ""
        cmdExec.Enabled = False
        txtKaiinsimeiKana.SetFocus
        txtKaiinsimeiKana.Enabled = True
        Exit Sub
    End If
    
    prgBar.Visible = False
    cmdPFK(5).Enabled = False
    Screen.MousePointer = vbNormal
    stbSystem.Panels.Item(1).Text = ""
    cmdExec.Enabled = True
    cmdExec.SetFocus
    txtKaiinsimeiKana.Enabled = False
    
        
End Sub
'******************************************************************************
'*    ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWÉ{ÉbÉNÉXÇï\é¶Ç∑ÇÈÅB
'******************************************************************************
Public Sub subShowErrorMsgBox(strErrCode As String, strErrMsg As String)

    Load QSAV_SysErr
    Call QSAV_SysErr.subSysErr("ñºäÒÇπì¸óÕ", _
              gstrCommandLine(1), _
              gstrCommandLine(5), _
              Format(Now, "YYYY/MM/DD HH:MM:SS"), _
              frmQPAV_CEnt082.Name, _
              strErrCode, _
              strErrMsg)

End Sub
'******************************************************************************
'*    ÉGÉâÅ[âèúèàóù
'******************************************************************************
Private Sub subErrKaijo()
    lblMsg.Caption = ""
    stbSystem.Panels.Item(1).Text = ""
    txtKaiinsimeiKana.BackColor = vbWhite
End Sub



Private Sub sprList_DblClick(ByVal Col As Long, ByVal Row As Long)
    Call cmdExec_Click
End Sub

'******************************************************************************
'*    ÉeÉLÉXÉgëIë
'******************************************************************************
Private Sub txtKaiinsimeiKana_GotFocus()
    Call gsubSelectText(txtKaiinsimeiKana)
End Sub
'******************************************************************************
'*    ñºäÒÇπåüçıópSP
'******************************************************************************
Private Function fncblnSyainSearch() As Boolean
 Dim strSQL            As String
 Dim lngSprStartCnt    As Long
 Dim lngSprEndCnt      As Long
 Dim i                 As Long
 Dim lngSpCnt          As Long

 Const cnslngAryCnt As Long = 100    'îzóÒÇÃåèêî  ãyÇ—ÅAÇPâÒÇ≈éÊìæÇ∑ÇÈÇlÇ`ÇwÇÃåèêî

On Error GoTo errfncblnSyainSearch

    fncblnSyainSearch = False

    lngSpCnt = 0

    'é–àıéÅñºÉJÉiñºéö
    odbDatabase.Parameters.Add "InStrSyainMyouji", strSyainMyouji, ORAPARM_INPUT
    odbDatabase.Parameters("InStrSyainMyouji").ServerType = ORATYPE_VARCHAR2
    'é–àıéÅñºÉJÉiñºëO
    odbDatabase.Parameters.Add "InStrSyainName", strSyainNamae, ORAPARM_INPUT
    odbDatabase.Parameters("InStrSyainName").ServerType = ORATYPE_VARCHAR2
    'ç≈ëÂîzóÒäiî[åèêî
    odbDatabase.Parameters.Add "InNumMaxRec", cnslngAryCnt, ORAPARM_INPUT
    odbDatabase.Parameters("InNumMaxRec").ServerType = ORATYPE_NUMBER
    'åƒèoâÒêî
    odbDatabase.Parameters.Add "IoNumSpCnt", lngSpCnt, ORAPARM_BOTH
    odbDatabase.Parameters("IoNumSpCnt").ServerType = ORATYPE_NUMBER
    'ëçåüçıåèêî
    odbDatabase.Parameters.Add "OtNumRecCount", 0, ORAPARM_OUTPUT
    odbDatabase.Parameters("OtNumRecCount").ServerType = ORATYPE_NUMBER
    'îzóÒäiî[åèêî
    odbDatabase.Parameters.Add "OtNumAryCount", 0, ORAPARM_OUTPUT
    odbDatabase.Parameters("OtNumAryCount").ServerType = ORATYPE_NUMBER
    'EndFlg
    odbDatabase.Parameters.Add "OtStrEndFlg", "0", ORAPARM_OUTPUT
    odbDatabase.Parameters("OtStrEndFlg").ServerType = ORATYPE_VARCHAR2
    'é–àıÉfÅ[É^îzóÒ
    odbDatabase.Parameters.AddTable "OtStrDatAryN", ORAPARM_OUTPUT, ORATYPE_VARCHAR2, cnslngAryCnt, 200    '100çsÅE200åÖ

             strSQL = "BEGIN QPAP_CEnt080PkG.QPAP_CEnt080SyainSearch("
    strSQL = strSQL & " :InStrSyainMyouji"
    strSQL = strSQL & ",:InStrSyainName"
    strSQL = strSQL & ",:InNumMaxRec"
    strSQL = strSQL & ",:IoNumSpCnt"
    strSQL = strSQL & ",:OtNumRecCount"
    strSQL = strSQL & ",:OtNumAryCount"
    strSQL = strSQL & ",:OtStrEndFlg"
    strSQL = strSQL & ",:OtStrDatAryN); END;"

    i = 1               'ïœêîÇÃÉNÉäÉA
    lngSprStartCnt = 0
    lngSprEndCnt = 0

    sprList.ReDraw = False
    Do
        'É}ÉXÉ^èÓïÒàÍóóÇÃéÊìæ
        odbDatabase.DbexecuteSQL (strSQL)

        If i = 1 Then
            'Å°äYìñ√ﬁ∞¿óLñ≥ämîF
            If odbDatabase.Parameters("OtNumRecCount") = 0 Then
                lblMsg.Caption = "äYìñÇ∑ÇÈÉfÅ[É^Ç™å©Ç¬Ç©ÇËÇ‹ÇπÇÒÅB"
                txtKaiinsimeiKana.SetFocus
                Call gsubParaRemove(odbDatabase)
                sprList.ReDraw = True
                Exit Function
            End If
            
            glngSPCount = odbDatabase.Parameters("OtNumRecCount")
            prgBar.Visible = False
            prgBar.Max = glngSPCount
            
            'Å°àÍóóÇÃçsêîê›íË(ΩÃﬂ⁄Øƒﬁ)
            'åüçıëçêîÇ™20åèÇÊÇËÇ‡ëΩÇ¢èÍçáÇÕΩÃﬂ⁄ØƒﬁçsêîÇåüçıëçêîÇ∆ìØÇ∂Ç…Ç∑ÇÈ
'            If odbDatabase.Parameters("OtNumRecCount") > 20 Then
                sprList.MaxRows = odbDatabase.Parameters("OtNumRecCount")
'            Else
'                'åüçıëçêî20åèà»â∫ÇÃèÍçá20åèÇ‹Ç≈ΩÃﬂ⁄ØƒﬁÇï\é¶Ç∑ÇÈ
'                sprList.MaxRows = 20
'            End If
        End If

        'àÍóóÇÃÉfÅ[É^ì‡óeÇê›íËÇ∑ÇÈäJénà íu
        lngSprStartCnt = (i - 1) * cnslngAryCnt + 1

        'àÍóóÇÃèIóπà íu
        If glngSPCount - (i - 1) * cnslngAryCnt > odbDatabase.Parameters("OtNumAryCount") Then
'            lngSprEndCnt = lngSprEndCnt + odbDatabase.Parameters("OtNumAryCount")      'ÅyWin2000ëŒâûÅzDel by Yokoyama@NBC 2004/04/16
            lngSprEndCnt = lngSprEndCnt + CLng(odbDatabase.Parameters("OtNumAryCount")) 'ÅyWin2000ëŒâûÅzAdd by Yokoyama@NBC 2004/04/16
        Else
            lngSprEndCnt = glngSPCount
        End If
        
        'àÍóóï\ çÄñ⁄ÉZÉbÉg
        Call subItiranDsp(lngSprStartCnt, lngSprEndCnt)

        i = i + 1
        
    Loop Until odbDatabase.Parameters("OtStrEndFlg") = "1"

    sprList.ReDraw = True

    'ÉIÉuÉWÉFÉNÉgÇÃäJï˙
    Call gsubParaRemove(odbDatabase)
    
    fncblnSyainSearch = True

    Exit Function

errfncblnSyainSearch:
'ÉGÉâÅ[èàóù

    'ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWï\é¶
    Call gsubDBErrorMessage(gstrCommandLine(8), cpubMyPrjName, _
                           gstrCommandLine(3), gstrCommandLine(5), gstrGetErrDateFormat)
    'ÉIÉuÉWÉFÉNÉgÇÃäJï˙
    Call gsubParaRemove(odbDatabase)

End Function
'******************************************************************************
'*    ã@î\ÅFÅ@ñºäÒÇπåüçıÇ…ÇÊÇ¡ÇƒéÊìæÇµÇΩé–àıÉfÅ[É^ÇÉXÉvÉåÉbÉhÇ…ï\é¶
'*    à¯êîÅFÅ@àÍóóÇÃäJénà íuÅAèIóπà íu
'******************************************************************************
Private Sub subItiranDsp(lngStCnt As Long, lngEdCnt As Long)
 Dim i           As Long
 Dim j           As Long
 Dim strDetail   As String
 Dim strWk       As String
 Dim StrWk1      As String
 Dim StrWk2      As String

    j = 0
    For i = lngStCnt To lngEdCnt

        strDetail = odbDatabase.Parameters("OtStrDatAryN").Get_Value(j)
        j = j + 1
        
        'é–àıÉRÅ[Éh1 & é–àıÉRÅ[Éh2
        StrWk1 = gfncstrDlm2(strDetail, 1)
        StrWk1 = Trim$(StrWk1)
        StrWk2 = gfncstrDlm2(strDetail, 2)
        StrWk2 = Trim$(StrWk2)
        sprList.SetText 1, i, Trim(StrWk1 & StrWk2)
                
        'éÅñºäøéö
        strWk = gfncstrDlm2(strDetail, 3)
        strWk = Trim$(strWk)
        sprList.SetText 3, i, strWk
        
        'èäëÆìXÉRÅ[Éh
        strWk = gfncstrDlm2(strDetail, 4)
        strWk = Trim$(strWk)
        sprList.SetText 4, i, strWk
        
        'ìåêºãÊï™
        strWk = gfncstrDlm2(strDetail, 5)
        strWk = Trim$(strWk)
        If strWk = 1 Then
            sprList.SetText 6, i, "ìå"
        ElseIf strWk = 2 Then
            sprList.SetText 6, i, "êº"
        Else
            sprList.SetText 6, i, ""
        End If
        
        'èäëÆïîñÂÉRÅ[Éh
        strWk = gfncstrDlm2(strDetail, 6)
        strWk = Trim$(strWk)
        sprList.SetText 7, i, strWk
                
        'èäëÆìXñºèÃ
        strWk = gfncstrDlm2(strDetail, 13)
        strWk = Trim$(strWk)
        sprList.SetText 5, i, strWk
        
        'èäëÆïîñÂñºèÃ
        strWk = gfncstrDlm2(strDetail, 14)
        strWk = Trim$(strWk)
        sprList.SetText 8, i, strWk
        
        'éÅñºÉJÉi
        strWk = gfncstrDlm2(strDetail, 15)
        strWk = Trim$(strWk)
        sprList.SetText 2, i, strWk
        
        prgBar.Value = i
    Next i
    
    Me.lblMsg.Caption = ""

End Sub
'******************************************************************************
'*    åàíËÉ{É^Éìâüâ∫éûèàóù
'******************************************************************************
Private Sub cmdExec_Click()
 Dim lngSprRow  As Long    'ΩÃﬂ⁄ØƒﬁëIëçs
 Dim strSyainCd As String  'é–àıÉRÅ[Éh
 Dim S          As Variant
 
    'ëIëÇ≥ÇÍÇƒÇ¢ÇÈΩÃﬂ⁄ØƒﬁçsÇæØƒ
    lngSprRow = sprList.ActiveRow
    
    'ëIëÇµÇΩçsÇÃ√ﬁ∞¿ÇÃóLñ≥¡™Ø∏
    If sprList.GetText(1, lngSprRow, S) = False Then
        Exit Sub
    End If
    
    '“≤›Ã´∞—Ç…é–àı∫∞ƒﬁÇê›íË
    strSyainCd = gVarSpdGetText(sprList, 1, lngSprRow)
    
    If Len(strSyainCd) = 7 Then
        frmQPAV_CEnt080.txtSyainCd(0).Text = " "
        frmQPAV_CEnt080.txtSyainCd(1).Text = strSyainCd
    ElseIf Len(strSyainCd) = 8 Then
        frmQPAV_CEnt080.txtSyainCd(0).Text = Mid(strSyainCd, 1, 1)
        frmQPAV_CEnt080.txtSyainCd(1).Text = Mid(strSyainCd, 2, 7)
    Else
        frmQPAV_CEnt080.txtSyainCd(0).Text = ""
        frmQPAV_CEnt080.txtSyainCd(1).Text = ""
    End If
    
    'ñºäÒÇπÃ◊∏ﬁê›íË
    gblnNayoseFlg = True
    
    'ñºäÒÇπåüçıâÊñ èIóπ
    Unload Me
    
End Sub
