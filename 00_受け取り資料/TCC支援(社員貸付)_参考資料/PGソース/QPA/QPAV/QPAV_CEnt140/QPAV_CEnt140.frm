VERSION 5.00
Object = "{B02F3647-766B-11CE-AF28-C3A2FBE76A13}#3.0#0"; "SPR32X30.ocx"
Object = "{00025600-0000-0000-C000-000000000046}#5.2#0"; "Crystl32.OCX"
Object = "{831FDD16-0C5C-11D2-A9FC-0000F8754DA1}#2.0#0"; "MSCOMCTL.OCX"
Begin VB.Form frmQPAV_CEnt140 
   BorderStyle     =   1  'å≈íË(é¿ê¸)
   Caption         =   "çTèúòAóçï\àÛç¸"
   ClientHeight    =   8580
   ClientLeft      =   180
   ClientTop       =   1095
   ClientWidth     =   14385
   BeginProperty Font 
      Name            =   "ÇlÇr ÉSÉVÉbÉN"
      Size            =   9.75
      Charset         =   128
      Weight          =   400
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   KeyPreview      =   -1  'True
   LinkTopic       =   "Form13"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   PaletteMode     =   1  'Z µ∞¿ﬁ∞
   ScaleHeight     =   8580
   ScaleWidth      =   14385
   StartUpPosition =   2  'âÊñ ÇÃíÜâõ
   Begin VB.CommandButton cmdInst 
      Caption         =   "ÉfÅ[É^çÏê¨"
      BeginProperty Font 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   405
      Left            =   10350
      TabIndex        =   4
      Top             =   6630
      Width           =   1185
   End
   Begin VB.CommandButton cmdPrint 
      Caption         =   "àÍóóàÛç¸"
      BeginProperty Font 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   405
      Index           =   1
      Left            =   12810
      TabIndex        =   6
      Top             =   6645
      Width           =   1185
   End
   Begin VB.CommandButton cmdPrint 
      Caption         =   "ÉvÉåÉrÉÖÅ["
      BeginProperty Font 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   405
      Index           =   0
      Left            =   11580
      TabIndex        =   5
      Top             =   6630
      Width           =   1185
   End
   Begin VB.Frame Frame1 
      Appearance      =   0  'Ã◊Øƒ
      ForeColor       =   &H80000008&
      Height          =   5535
      Left            =   60
      TabIndex        =   26
      Top             =   1020
      Width           =   14250
      Begin FPSpread.vaSpread sprList 
         Height          =   4755
         Left            =   2100
         TabIndex        =   3
         Top             =   420
         Width           =   8985
         _Version        =   196608
         _ExtentX        =   15849
         _ExtentY        =   8387
         _StockProps     =   64
         MaxCols         =   7
         MaxRows         =   20
         OperationMode   =   2
         ScrollBars      =   2
         SelectBlockOptions=   0
         SpreadDesigner  =   "QPAV_CEnt140.frx":0000
         UserResize      =   0
         VisibleCols     =   7
         VisibleRows     =   20
      End
   End
   Begin VB.Frame Frame3 
      Appearance      =   0  'Ã◊Øƒ
      ForeColor       =   &H80000008&
      Height          =   1035
      Left            =   60
      TabIndex        =   23
      Top             =   -15
      Width           =   14250
      Begin Crystal.CrystalReport CrystalReport 
         Left            =   180
         Top             =   270
         _ExtentX        =   741
         _ExtentY        =   741
         _Version        =   348160
         PrintFileLinesPerPage=   60
      End
      Begin VB.OptionButton optKbn 
         Caption         =   " è‹Å@ó^"
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   9
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   360
         Index           =   1
         Left            =   7155
         TabIndex        =   2
         Top             =   555
         Value           =   -1  'True
         Width           =   1140
      End
      Begin VB.OptionButton optKbn 
         Caption         =   " ããÅ@ó^"
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   9
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   360
         Index           =   0
         Left            =   7155
         TabIndex        =   1
         Top             =   210
         Width           =   990
      End
      Begin VB.ComboBox cobSyoriYM 
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   9
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   300
         Left            =   5070
         Style           =   2  'ƒﬁ€ØÃﬂ¿ﬁ≥› ÿΩƒ
         TabIndex        =   0
         Top             =   390
         Width           =   1260
      End
      Begin VB.Label lblKIKAN 
         AutoSize        =   -1  'True
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   9
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   180
         Left            =   10800
         TabIndex        =   27
         Top             =   450
         Width           =   60
      End
      Begin VB.Label lblKyuuyo 
         AutoSize        =   -1  'True
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   9
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   180
         Left            =   8370
         TabIndex        =   25
         Top             =   450
         Width           =   60
      End
      Begin VB.Label Label1 
         Alignment       =   1  'âEëµÇ¶
         AutoSize        =   -1  'True
         BackColor       =   &H00C00000&
         BackStyle       =   0  'ìßñæ
         Caption         =   "èàóùîNåé"
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   9
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   180
         Left            =   4035
         TabIndex        =   24
         Top             =   465
         Width           =   720
      End
   End
   Begin VB.PictureBox picPfMenu 
      Align           =   2  'â∫ëµÇ¶
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   8.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   585
      Left            =   0
      ScaleHeight     =   525
      ScaleWidth      =   14325
      TabIndex        =   22
      TabStop         =   0   'False
      Top             =   7620
      Width           =   14385
      Begin VB.CommandButton cmdPFK 
         Caption         =   "F1:“∆≠-"
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   9
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   1
         Left            =   60
         TabIndex        =   7
         Top             =   90
         Width           =   1155
      End
      Begin VB.CommandButton cmdPFK 
         Caption         =   "F2: ∞ƒﬁ∫Àﬂ∞"
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   9
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   2
         Left            =   1249
         TabIndex        =   8
         Top             =   90
         Width           =   1155
      End
      Begin VB.CommandButton cmdPFK 
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   3
         Left            =   2438
         TabIndex        =   12
         TabStop         =   0   'False
         Top             =   90
         Width           =   1155
      End
      Begin VB.CommandButton cmdPFK 
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   4
         Left            =   3627
         TabIndex        =   13
         TabStop         =   0   'False
         Top             =   90
         Width           =   1155
      End
      Begin VB.CommandButton cmdPFK 
         Caption         =   "F5:é¿çs"
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   9
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   5
         Left            =   4816
         TabIndex        =   9
         Top             =   90
         Width           =   1155
      End
      Begin VB.CommandButton cmdPFK 
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   6
         Left            =   6005
         TabIndex        =   14
         TabStop         =   0   'False
         Top             =   90
         Width           =   1155
      End
      Begin VB.CommandButton cmdPFK 
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   7
         Left            =   7194
         TabIndex        =   15
         TabStop         =   0   'False
         Top             =   90
         Width           =   1155
      End
      Begin VB.CommandButton cmdPFK 
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   8
         Left            =   8383
         TabIndex        =   16
         TabStop         =   0   'False
         Top             =   90
         Width           =   1155
      End
      Begin VB.CommandButton cmdPFK 
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   9
         Left            =   9572
         TabIndex        =   17
         TabStop         =   0   'False
         Top             =   90
         Width           =   1155
      End
      Begin VB.CommandButton cmdPFK 
         Caption         =   "F10:ëOâÊñ "
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   9
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   10
         Left            =   10761
         TabIndex        =   10
         Top             =   90
         Width           =   1155
      End
      Begin VB.CommandButton cmdPFK 
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   11
         Left            =   11950
         TabIndex        =   18
         TabStop         =   0   'False
         Top             =   90
         Width           =   1155
      End
      Begin VB.CommandButton cmdPFK 
         Caption         =   "F12:éÊè¡"
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   9
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   12
         Left            =   13140
         TabIndex        =   11
         Top             =   90
         Width           =   1155
      End
   End
   Begin VB.PictureBox picMsg 
      BackColor       =   &H00FFFFFF&
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   8.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   405
      Left            =   60
      ScaleHeight     =   345
      ScaleWidth      =   14220
      TabIndex        =   20
      TabStop         =   0   'False
      Top             =   7110
      Width           =   14280
      Begin VB.Label lblMsg 
         BackStyle       =   0  'ìßñæ
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H000000FF&
         Height          =   285
         Left            =   60
         TabIndex        =   21
         Top             =   60
         Width           =   12405
      End
   End
   Begin MSComctlLib.StatusBar stbSystem 
      Align           =   2  'â∫ëµÇ¶
      Height          =   375
      Left            =   0
      TabIndex        =   19
      Top             =   8205
      Width           =   14385
      _ExtentX        =   25374
      _ExtentY        =   661
      _Version        =   393216
      BeginProperty Panels {8E3867A5-8586-11D1-B16A-00C0F0283628} 
         NumPanels       =   5
         BeginProperty Panel1 {8E3867AB-8586-11D1-B16A-00C0F0283628} 
            AutoSize        =   1
            Object.Width           =   12894
            MinWidth        =   3528
         EndProperty
         BeginProperty Panel2 {8E3867AB-8586-11D1-B16A-00C0F0283628} 
            Object.Width           =   3351
            MinWidth        =   3351
            Text            =   "ïxémí Å@ëæòY"
            TextSave        =   "ïxémí Å@ëæòY"
         EndProperty
         BeginProperty Panel3 {8E3867AB-8586-11D1-B16A-00C0F0283628} 
            Object.Width           =   3881
            MinWidth        =   3881
            Text            =   "9999999999999999"
            TextSave        =   "9999999999999999"
         EndProperty
         BeginProperty Panel4 {8E3867AB-8586-11D1-B16A-00C0F0283628} 
            Style           =   6
            Alignment       =   1
            TextSave        =   "2010/08/19"
         EndProperty
         BeginProperty Panel5 {8E3867AB-8586-11D1-B16A-00C0F0283628} 
            Style           =   5
            Alignment       =   1
            TextSave        =   "15:31"
         EndProperty
      EndProperty
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
End
Attribute VB_Name = "frmQPAV_CEnt140"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
'----------------------------------------------------------------------------------------------
'çXêVì˙ït  àƒåè/è·äQî‘çÜ    èCê≥óùóR
'20100809  1004091          ÅEíäèoèåèÇ…Ç†ÇÈìåêºãÊï™ÇçÌèú
'                           Å@Å¶ìåêºÇÃÉfÅ[É^ÇàÍìxÇ…ï\é¶ÅEàÛç¸ÇçsÇ§
'                           ÅEêVãKí†ï[ÇÃèoóÕí«â¡
'----------------------------------------------------------------------------------------------
'*********************************************************************************************************************
'2005.05.06 Yasui@NBC çTèúçÏê¨ïsîıëŒâû è‹ó^çTèúçÏê¨ÇÃçÏê¨èàóùÇ…êßå¿ÇÇ©ÇØÇÈ
'*********************************************************************************************************************
Option Explicit
 Private blnInitFlg  As Boolean
 Private blnNoChangeEvFlg  As Boolean   '¡™›ºﬁ ≤Õﬁ›ƒ ñ≥å¯ÉtÉâÉO
 Dim lngFirstCnt As Long '''''''''''
 Dim lngRecCount As Long '''''''''''''''SPóp
 
 Dim lngHigasiCount As Long 'çTèúòAóçï\         ìåÉfÅ[É^åèêî
 Dim lngNisiCount   As Long 'çTèúòAóçï\         êºÉfÅ[É^åèêî
 Dim lngZanCount    As Long 'ñ¢çTèúécçÇàÍóóï\     ÉfÅ[É^åèêî

'2005.05.06 Yasui@NBC çTèúçÏê¨ïsîıëŒâû  ==>
Private Const strDATE1 As String = "05"
Private Const strDATE2 As String = "26"
'ADD 0811051 ÉOÉãÅ[Évé–àıèÿèëë›ïtí†ï[å©íºÇµ NBC ISHIDA START
'çTèúòAóçï\Ç…å©èoÇµÇï\é¶ópÇÃïœêî
'çTèúämíËì˙Ç‚è‹ó^çTèúåéÇ™ïœçXÇ…Ç»Ç¡ÇΩèÍçáÇÕÅAâ∫ãLÇÃèCê≥Ç™ïKóv
Private Const strDATE3 As String = "15"         'ããó^çTèúòAóçï\ÇÃêÿÇËë÷ÇÌÇËì˙(ñàåé15ì˙)
Private Const strDATE4 As String = "06"         'è‹ó^çTèúåé(6åé)
Private Const strDATE5 As String = "0520"         'è‹ó^çTèúåé(12åé)
Private Const strDATE6 As String = "0630"       '6åéè‹ó^çTèúämíËì˙(5åé20ì˙)
Private Const strDATE7 As String = "12"       '6åéè‹ó^çTèúòAóçï\Ç™èoóÕÇ≈Ç´ÇÈç≈èIì˙(6åé30ì˙)
Private Const strDATE8 As String = "1110"       '12åéè‹ó^çTèúämíËì˙(11åé10ì˙)
Private Const strDATE9 As String = "1231"       '12åéè‹ó^çTèúòAóçï\Ç™èoóÕÇ≈Ç´ÇÈç≈èIì˙(12åé31ì˙)
Private Const strDATE10 As String = "0518"      'ããó^çTèúçÏê¨éûä‘
Dim strSyoriMMDDHHMI       As String
'ADD 0811051 ÉOÉãÅ[Évé–àıèÿèëë›ïtí†ï[å©íºÇµ NBC ISHIDA END
Dim strKikan(2) As String
Dim intIDX      As Integer
'2005.05.06 Yasui@NBC çTèúçÏê¨ïsîıëŒâû  <==

'****************************************************************************************
'* è‹ó^ÉfÅ[É^çÏê¨É{É^Éìâüâ∫
'****************************************************************************************
Private Sub cmdInst_Click()

    'è‹ó^çTèúç≈êVì˙ïtéÊìæ
    Call gsubSPGetYM
    
    'èàóùîNåé
    gstrSyoriYM = Left$(cobSyoriYM, 4) & Right$(cobSyoriYM, 2)
    
    'ç≈êVè‹ó^çTèúçÏê¨îNåéÉ`ÉFÉbÉN
    If Val(gstrBonusYM) >= Val(gstrSyoriYM) Then
        lblMsg.Caption = "Ç±ÇÃèàóùîNåéÇÃè‹ó^çTèúÉfÅ[É^ÇÕÅAä˘Ç…çÏê¨Ç≥ÇÍÇƒÇ¢Ç‹Ç∑ÅB"
        Exit Sub
    End If

'2005.05.06 Yasui@NBC çTèúçÏê¨ïsîıëŒâû è‹ó^çTèúçÏê¨ÇÃçÏê¨èàóùÇ…êßå¿ÇÇ©ÇØÇÈ  ==>
    If strDATE1 >= Right(gstrSysDate, 2) Then
        lblMsg.Caption = "WPOE36 " & gstrGetCodeMeisyo(odbDatabase, "E36", "WPO") 'Msg = ÇTì˙Ç‹Ç≈ÅAè‹ó^çTèúÉfÅ[É^ÇÃçÏê¨ÇçsÇ¶Ç‹ÇπÇÒÅB
        Exit Sub
    End If
    If strDATE2 <= Right(gstrSysDate, 2) Then
        lblMsg.Caption = "WPOE37 " & gstrGetCodeMeisyo(odbDatabase, "E37", "WPO") 'Msg = ÇQÇUì˙à»ç~ÇÕÅAè‹ó^çTèúÉfÅ[É^ÇÃçÏê¨ÇçsÇ¶Ç‹ÇπÇÒÅB
        Exit Sub
    End If
'2005.05.06 Yasui@NBC çTèúçÏê¨ïsîıëŒâû  <==
    
    If MsgBox("çTèúÉfÅ[É^çÏê¨ÇäJénÇµÇ‹Ç∑ÅBÇÊÇÎÇµÇ¢Ç≈Ç∑Ç©ÅH", vbQuestion + vbOKCancel, "çTèúòAóçï\àÛç¸") = vbCancel Then
        Exit Sub
    End If
    
    'ÉXÉeÅ[É^ÉXÉoÅ[ÉÅÉbÉZÅ[ÉW
    stbSystem.Panels.Item(1).Text = "èàóùíÜÅDÅDÅD"
    lblMsg.Caption = ""
    DoEvents
    
    'ÅüâÊñ êßå‰
    Call subGamenSeigyo(False)  'âÊñ ÉçÉbÉN
    
    'è‹ó^çTèúÉfÅ[É^çÏê¨
    If blnInstKoujyo = True Then
        lblMsg.Caption = "çTèúÉfÅ[É^çÏê¨Ç™èIóπÇµÇ‹ÇµÇΩÅB"
    Else
        lblMsg.Caption = "çTèúÉfÅ[É^çÏê¨ÇíÜé~ÇµÇ‹ÇµÇΩÅB"
    End If
    
    'ÅüâÊñ êßå‰âèú
    Call subGamenSeigyo(True)   'égópâ¬
    stbSystem.Panels.Item(1).Text = ""

End Sub

Private Sub cmdPrint_Click(Index As Integer)
    Dim strErrMsg As String 'ÉGÉâÅ[ÉÅÉbÉZÅ[ÉW
    Dim strWrk    As String

    Select Case Index
        Case 0
            If MsgBox("ÉvÉåÉrÉÖÅ[ÇäJénÇµÇ‹Ç∑ÅBÇÊÇÎÇµÇ¢Ç≈Ç∑Ç©ÅH", vbQuestion + vbOKCancel, "çTèúòAóçï\àÛç¸") = vbCancel Then
                Exit Sub
            End If
            
'MOD 20100809 1004091 IMZ SHIBUTANI START
'            If lngHigasiCount > 0 Then
'                Call subPrintReport1(crptToWindow, "1") 'ìå
'            End If
'            If lngNisiCount > 0 Then
'                Call subPrintReport1(crptToWindow, "2") 'êº
'            End If
            
            'ìåêºçáéZÇµÇƒîªíËÇçsÇ§
            If lngHigasiCount + lngNisiCount > 0 Then
                Call subPrintReport1(crptToWindow)
            End If
'MOD 20100809 1004091 IMZ SHIBUTANI END
            
            If lngZanCount > 0 Then
                Call subPrintReport2(crptToWindow)
            End If
            
            Call subPrintReport3(crptToWindow)

        Case 1
            If MsgBox("àÛç¸ÇäJénÇµÇ‹Ç∑ÅBÇÊÇÎÇµÇ¢Ç≈Ç∑Ç©ÅH", vbQuestion + vbOKCancel, "çTèúòAóçï\àÛç¸") = vbCancel Then
                Exit Sub
            End If
            
'MOD 20100809 1004091 IMZ SHIBUTANI START
'            If lngHigasiCount > 0 Then
'                Call subPrintReport1(crptToPrinter, "1") 'ìå
'            End If
'            If lngNisiCount > 0 Then
'                Call subPrintReport1(crptToPrinter, "2") 'êº
'            End If
            
            'ìåêºçáéZÇµÇƒîªíËÇçsÇ§
            If lngHigasiCount + lngNisiCount > 0 Then
                Call subPrintReport1(crptToPrinter)
            End If
'MOD 20100809 1004091 IMZ SHIBUTANI END
            
            If lngZanCount > 0 Then
                Call subPrintReport2(crptToPrinter)
            End If
            
            Call subPrintReport3(crptToPrinter)
    
    End Select

End Sub

Private Sub cobSyoriYM_Change()
    If optKbn(0).Value = True Then
        lblKyuuyo.Caption = cobSyoriYM.Text & "ìxããó^ï™"
        lblKIKAN.Caption = ""       '2005.05.06 Yasui@NBC çTèúçÏê¨ïsîıëŒâû
    Else
        lblKyuuyo.Caption = cobSyoriYM.Text & "ìxè‹ó^ï™"
        '2005.05.06 Yasui@NBC çTèúçÏê¨ïsîıëŒâû ==>
        intIDX = IIf(cobSyoriYM.ListIndex <= 0, 0, cobSyoriYM.ListIndex)
        lblKIKAN.Caption = "íäèoä˙ä‘ÅF" & strKikan(intIDX) & "/26Å`" & _
                                strKikan(intIDX + 1) & "/25"
        '2005.05.06 Yasui@NBC çTèúçÏê¨ïsîıëŒâû <==
    End If
End Sub

Private Sub cobSyoriYM_Click()
    Call cobSyoriYM_Change
End Sub

'**************************************************************************************************
'*FormÉçÅ[Éh
'**************************************************************************************************
Private Sub Form_Load()
    'ÉXÉeÅ[É^ÉXÉoÅ[èâä˙âª
    Call gsubInitStatusBar(stbSystem)
    
    'ÉtÉHÅ[ÉÄñºê›íË
    Me.Caption = "çTèúòAóçï\àÛç¸" & " (" & gstrCommandLine(8) & ")"
            
    'ÉtÉâÉOèâä˙âª
    blnInitFlg = True        'èâä˙ÉtÉâÉOê›íËÅièâä˙Åj
    blnNoChangeEvFlg = True  'ÉeÉLÉXÉgÉ{ÉbÉNÉXÉ`ÉFÉìÉWÉCÉxÉìÉgÅiÉ`ÉFÉìÉWÉCÉxÉìÉgñ≥ÇµÅj
    
    'àÍóóï\ÉNÉäÉA
    Call gsubSpdClear(sprList)

    'Spread Seet ï€åÏ
    sprList.Lock = True
    
    'âÊñ èâä˙âª
    blnInitFlg = True
'    Call subInitScreen

End Sub

'**************************************************************************************************
'   Form_ActivateÉCÉxÉìÉg:ÉZÉbÉVÉáÉìÇÃämóß
'                        :ÉfÅ[É^ÉxÅ[ÉXämóß
'**************************************************************************************************
Private Sub Form_Activate()

    If blnInitFlg Then
        stbSystem.Panels.Item(1).Text = "èàóùíÜÅDÅDÅD"    'ÉXÉeÅ[É^ÉXÉoÅ[ÉÅÉbÉZÅ[ÉW
        Call subGamenSeigyo(False)                         'âÊñ ÉçÉbÉN
        DoEvents
        
        'ÉIÉâÉNÉãÉZÉbÉVÉáÉìÇÃämóß
        If Not gblnCreateOracleSession() Then
            'ÉVÉXÉeÉÄÉGÉâÅ[
            Call QSAV_SysErr.subSysErr(gcstrPrjName, gstrCommandLine(1) _
                                    , gstrCommandLine(5), gstrGetErrDateFormat _
                                    , "çTèúòAóçï\àÛç¸ (" & gstrCommandLine(8) & ")" _
                                    , CStr(Err.Number), Err.Description)
            'èIóπ
            Unload Me
            Exit Sub
        End If

        'ÉfÅ[É^ÉxÅ[ÉXÇÃämóß
        If Not gblnConnectOracleDatabase(gstrCommandLine(3), gstrCommandLine(4) _
                                    , gstrCommandLine(0)) Then
            'ÉVÉXÉeÉÄÉGÉâÅ[
            Call QSAV_SysErr.subSysErr(gcstrPrjName, gstrCommandLine(1) _
                                    , gstrCommandLine(5), gstrGetErrDateFormat _
                                    , "çTèúòAóçï\àÛç¸ (" & gstrCommandLine(8) & ")" _
                                    , objSession.LastServerErr, objSession.LastServerErrText)
            'èIóπ
            Unload Me
            Exit Sub
        End If
        
        Call gsubSPInit                     'èâä˙èàóùópÇrÇo(ÉVÉXÉeÉÄì˙ït)
        Call subGamenSeigyo(True)           'âÊñ ÉçÉbÉNâèú
        Call subInitScreen                  'âÊñ èâä˙âª
        Call subGamenSeigyo(True)           'âÊñ ÉçÉbÉNâèú
        stbSystem.Panels.Item(1).Text = ""  'ÉXÉeÅ[É^ÉXÉoÅ[ÉÅÉbÉZÅ[ÉWè¡ãé
               
        blnInitFlg = False
    End If
    
End Sub

'**************************************************************************************************
'*FORM_KEYDOWN ÉtÉ@ÉìÉNÉVÉáÉìÉLÅ[ê›íË
'**************************************************************************************************
Private Sub Form_KeyDown(KeyCode As Integer, Shift As Integer)
    
    Select Case KeyCode
        Case vbKeyReturn   'Enter
            SendKeys "{TAB}"
        Case vbKeyF1   'F1
            Call cmdPFK_Click(1)
        Case vbKeyF2   'F2
            Call cmdPFK_Click(2)
        Case vbKeyF5   'F5
            If cmdPFK(5).Enabled = True Then
                Call cmdPFK_Click(5)
            End If
        Case vbKeyF10   'F10
            Call cmdPFK_Click(10)
        Case vbKeyF12   'F12
            Call cmdPFK_Click(12)
        Case vbKeyDelete    'DELÉLÅ[ÇâüÇµÇΩéû
            Call Form_KeyPress(46)
    End Select

End Sub
'**************************************
'*FORM_KEYPRESS
'**************************************
Private Sub Form_KeyPress(KeyAscii As Integer)
    'ENTER Beepâπè¡ãé
    Call subErrKaijo
        
    If KeyAscii = vbKeyReturn Then
        KeyAscii = 0
    End If

End Sub

'*****************************************************************************************
'äeÉtÉ@ÉìÉNÉVÉáÉìÉLÅ[ã@î\
'*****************************************************************************************
Private Sub cmdPFK_Click(Index As Integer)
    
    Select Case Index
        Case 1  'ÉÅÉjÉÖÅ[
            Unload Me
        Case 2  'ÉnÅ[ÉhÉRÉsÅ[
            Call gsubQSAV_ActX1001
        Case 5  'é¿çs
            Call subCmdJikkou
        Case 10 'ëOâÊñ 
            Unload Me
        Case 12 'éÊè¡
'*** 11/05 è‹ó^ÉfÅ[É^çÏê¨í«â¡ ***
            If cmdInst.Enabled = True Then
                'è‹ó^çTèúç≈êVì˙ïtéÊìæ
                Call gsubSPGetYM
                'èàóùîNåé
                gstrSyoriYM = Left$(cobSyoriYM, 4) & Right$(cobSyoriYM, 2)
                'ç≈êVè‹ó^çTèúçÏê¨îNåéÉ`ÉFÉbÉN
                If Val(gstrBonusYM) < Val(gstrSyoriYM) Then
'2005.05.06 Yasui@NBC çTèúçÏê¨ïsîıëŒâû è‹ó^çTèúçÏê¨ÇÃçÏê¨èàóùÇ…êßå¿ÇÇ©ÇØÇÈ  ==>
'                    If MsgBox("çTèúÉfÅ[É^Ç™çÏê¨Ç≥ÇÍÇƒÇ¢Ç‹ÇπÇÒÇ™ÅAçÏê¨ÇµÇ‹Ç∑Ç©ÅH", vbQuestion + vbYesNo, "çTèúòAóçï\àÛç¸") = vbYes Then
'                        'è‹ó^çTèúÉfÅ[É^çÏê¨
'                        If InstKoujo = False Then
'                            lblMsg.Caption = "çTèúÉfÅ[É^çÏê¨ÇíÜé~ÇµÇ‹ÇµÇΩÅB"
'                            Exit Sub
'                        End If
'                    End If
                    If strDATE1 < Right(gstrSysDate, 2) And _
                       strDATE2 > Right(gstrSysDate, 2) Then
                        If MsgBox("çTèúÉfÅ[É^Ç™çÏê¨Ç≥ÇÍÇƒÇ¢Ç‹ÇπÇÒÇ™ÅAçÏê¨ÇµÇ‹Ç∑Ç©ÅH", vbQuestion + vbYesNo, "çTèúòAóçï\àÛç¸") = vbYes Then
                            'è‹ó^çTèúÉfÅ[É^çÏê¨
                            If InstKoujo = False Then
                                lblMsg.Caption = "çTèúÉfÅ[É^çÏê¨ÇíÜé~ÇµÇ‹ÇµÇΩÅB"
                                Exit Sub
                            End If
                        End If
                    End If
'2005.05.06 Yasui@NBC çTèúçÏê¨ïsîıëŒâû <==
                End If
            End If
            Call subInitScreen
            cobSyoriYM.SetFocus
    End Select
    
End Sub

'****************************************
'*ÉGÉâÅ[âèúèàóù
'****************************************
Private Sub subErrKaijo()
    lblMsg.Caption = ""
End Sub

'*************************************************************************************************
'*é¿çsÉ{É^Éìèàóù
'*************************************************************************************************
Private Sub subCmdJikkou()
    Dim strErrMsg As String 'ÉGÉâÅ[ÉÅÉbÉZÅ[ÉW
    Dim strWrk    As String
    Dim i         As Long
'ADD 0811051 ÉOÉãÅ[Évé–àıèÿèëë›ïtí†ï[å©íºÇµ NBC ISHIDA START
    Dim objTable  As Object
    Dim strSQL    As String

    'æØƒÃ´∞∂ΩÇµÇƒã≠êßìIÇ…äe∫›ƒ€∞ŸÇLost_FocusÇ≥ÇπÇÈ
    cmdPFK(5).SetFocus
    'ÉXÉeÅ[É^ÉXÉoÅ[ÉÅÉbÉZÅ[ÉW
    stbSystem.Panels.Item(1).Text = "èàóùíÜÅDÅDÅD"
    lblMsg.Caption = ""
    DoEvents
    
    'ÅüâÊñ êßå‰
    Call subGamenSeigyo(False)          'âÊñ ÉçÉbÉN
    
    'èàóùîNåé
    gstrSyoriYM = Left$(cobSyoriYM, 4) & Right$(cobSyoriYM, 2)
    
    'èàóùãÊï™
    If optKbn(0).Value = True Then
        gstrSyoriKbn = "1"      'ããó^
    Else
        gstrSyoriKbn = "2"      'è‹ó^
    End If
'ADD 0811051 ÉOÉãÅ[Évé–àıèÿèëë›ïtí†ï[å©íºÇµ NBC ISHIDA START
    'é¿çséûä‘ÇÃéÊìæ
    'SQLï∂ÇÃçÏê¨
    strSQL = "SELECT" _
        & " TO_CHAR(SYSDATE,'MMDDHH24MI')" _
        & " FROM" _
        & " DUAL"

        'íäèoé¿çs
    If Not gblnOpenOracleTable(objTable, strSQL) Then
        strSyoriMMDDHHMI = "00000000"
    Else
        strSyoriMMDDHHMI = objTable.Fields("TO_CHAR(SYSDATE,'MMDDHH24MI')").Value
    End If
'ADD 0811051 ÉOÉãÅ[Évé–àıèÿèëë›ïtí†ï[å©íºÇµ NBC ISHIDA END
    
    'çTèúòAóçï\ÉfÅ[É^çÏê¨
    If blnGetKoujyo Then
    
'2003/01/20 í«â¡
        'ñ¢çTèúòAóçï\ÇÃÉfÅ[É^çÏê¨
        Call blnMakeMekoujyo
'2003/01/20 í«â¡

        'âÊñ êßå‰
        Call subGamenSeigyo(True) 'égópâ¬
        sprList.Enabled = True
        sprList.SetFocus
        'çTèúòAóçï\ÉfÅ[É^ÉXÉvÉåÉbÉgï\é¶
        Call subDispList
        cobSyoriYM.Enabled = False
        optKbn(0).Enabled = False
        optKbn(1).Enabled = False
        cmdPrint(0).Enabled = True
        cmdPrint(1).Enabled = True
        cmdPFK(5).Enabled = False
'**** 11/02 è‹ó^ÉfÅ[É^çÏê¨í«â¡ ****
        If optKbn(0).Value = True Then  'ããó^
            cmdInst.Enabled = False
        Else                            'è‹ó^
            cmdInst.Enabled = True
        End If
    Else
        'âÊñ êßå‰
        Call subGamenSeigyo(True) 'égópâ¬
        lblMsg.Caption = "WPOE10 " & gstrGetCodeMeisyo(odbDatabase, "E10", "WPO") 'Msg = äYìñÉfÅ[É^Ç™ë∂ç›ÇµÇ‹ÇπÇÒ
    End If

    stbSystem.Panels.Item(1).Text = ""
    
End Sub

'**************************************************************************************************
'   Form_UnloadÉCÉxÉìÉg
'**************************************************************************************************
Private Sub Form_Unload(Cancel As Integer)

'*** 11/05 è‹ó^ÉfÅ[É^çÏê¨í«â¡ ***
    If cmdInst.Enabled = True Then
        'è‹ó^çTèúç≈êVì˙ïtéÊìæ
        Call gsubSPGetYM
        'èàóùîNåé
        gstrSyoriYM = Left$(cobSyoriYM, 4) & Right$(cobSyoriYM, 2)
        'ç≈êVè‹ó^çTèúçÏê¨îNåéÉ`ÉFÉbÉN
        If Val(gstrBonusYM) < Val(gstrSyoriYM) Then
'2005.05.06 Yasui@NBC çTèúçÏê¨ïsîıëŒâû è‹ó^çTèúçÏê¨ÇÃçÏê¨èàóùÇ…êßå¿ÇÇ©ÇØÇÈ ==>
'            If MsgBox("çTèúÉfÅ[É^Ç™çÏê¨Ç≥ÇÍÇƒÇ¢Ç‹ÇπÇÒÇ™ÅAçÏê¨ÇµÇ‹Ç∑Ç©ÅH", vbQuestion + vbYesNo, "çTèúòAóçï\àÛç¸") = vbYes Then
'                'è‹ó^çTèúÉfÅ[É^çÏê¨
'                If InstKoujo = False Then
'                    lblMsg.Caption = "çTèúÉfÅ[É^çÏê¨ÇíÜé~ÇµÇ‹ÇµÇΩÅB"
'                    Exit Sub
'                End If
'            End If
            If strDATE1 < Right(gstrSysDate, 2) And _
               strDATE2 > Right(gstrSysDate, 2) Then
                If MsgBox("çTèúÉfÅ[É^Ç™çÏê¨Ç≥ÇÍÇƒÇ¢Ç‹ÇπÇÒÇ™ÅAçÏê¨ÇµÇ‹Ç∑Ç©ÅH", vbQuestion + vbYesNo, "çTèúòAóçï\àÛç¸") = vbYes Then
                    'è‹ó^çTèúÉfÅ[É^çÏê¨
                    If InstKoujo = False Then
                        lblMsg.Caption = "çTèúÉfÅ[É^çÏê¨ÇíÜé~ÇµÇ‹ÇµÇΩÅB"
                        Exit Sub
                    End If
                End If
            End If
'2005.05.06 Yasui@NBC çTèúçÏê¨ïsîıëŒâû <==
        End If
    End If

    'égópÉèÅ[ÉNÉeÅ[ÉuÉãëSçÌèú
    Call subDelWorkTbl

    'µ◊∏ŸæØºÆ›ÇÃêÿíf
    Call gsubTermOracleDB

    Set frmQPAV_CEnt140 = Nothing
End Sub

Private Sub optKbn_Click(Index As Integer)

    'ããó^ÇÃèÍçá
    If Index = 0 Then
       If Right(gstrSysDate, 2) > 15 Then
            cobSyoriYM.ListIndex = 1
       Else
            cobSyoriYM.ListIndex = 0
       End If
       'cobSyoriYM.Enabled = False
       cobSyoriYM.Locked = True
            
        lblKyuuyo.Caption = cobSyoriYM.Text & "ìxããó^ï™"
    
        lblKIKAN.Caption = ""       '2005.05.06 Yasui@NBC çTèúçÏê¨ïsîıëŒâû
    
    'è‹ó^ÇÃèÍçá
    Else
        'cobSyoriYM.Enabled = True
        cobSyoriYM.Locked = False
        lblKyuuyo.Caption = cobSyoriYM.Text & "ìxè‹ó^ï™"
    
        '2005.05.06 Yasui@NBC çTèúçÏê¨ïsîıëŒâû ==>
        intIDX = IIf(cobSyoriYM.ListIndex <= 0, 0, cobSyoriYM.ListIndex)
        lblKIKAN.Caption = "íäèoä˙ä‘ÅF" & strKikan(intIDX) & "/26Å`" & _
                                strKikan(intIDX + 1) & "/25"
        '2005.05.06 Yasui@NBC çTèúçÏê¨ïsîıëŒâû <==
    
    End If
    
End Sub

'*********************************************************************************************
'*Å@Å@éËë±Ç´ñºÅFÅ@çTèúòAóçï\ÉfÅ[É^Å@çÏê¨ÅïéÊìæ
'*Å@Å@à¯Å@êîÅ@ÅFÅ@Ç»Çµ
'*Å@Å@åãÅ@â Å@ÅFÅ@TrueÅcäYìñÉfÅ[É^óL  FalseÅcäYìñÉfÅ[É^ñ≥Çµ
'*********************************************************************************************
Private Function blnGetKoujyo()

Dim strSQL               As String
Dim i                    As Long
Dim j                    As Long
Dim lngFirstCnt          As Long  '
Dim lngRecCount          As Long  '
Dim lngMax               As Long  '
   
Const cnsMaxRec As Long = 30


On Error GoTo errGetKoujyo
    
    blnGetKoujyo = False
    lngHigasiCount = 0      'çTèúòAóçï\         ìåÉfÅ[É^åèêî
    lngNisiCount = 0        'çTèúòAóçï\         êºÉfÅ[É^åèêî
    lngZanCount = 0         'ñ¢çTèúécçÇàÍóóï\     ÉfÅ[É^åèêî

    'çTèúòAóçï\çÏê¨ÅïéÊìæ ÇrÇo
    odbDatabase.Parameters.Add "InStrSyoriKbn", gstrSyoriKbn, ORAPARM_INPUT     'é–àıÉRÅ[ÉhÇP
    odbDatabase.Parameters.Add "InStrSyoriYM", gstrSyoriYM, ORAPARM_INPUT     'é–àıÉRÅ[ÉhÇQ
    
    'MaxRec
    odbDatabase.Parameters.Add "InNumMaxRec", cnsMaxRec, ORAPARM_INPUT
    odbDatabase.Parameters("InNumMaxRec").ServerType = ORATYPE_CHAR
    'èàóù∂≥›ƒ(IoNumFetchCount
    odbDatabase.Parameters.Add "IoNumFetchCount", 0, ORAPARM_BOTH
    odbDatabase.Parameters("IoNumFetchCount").ServerType = ORATYPE_NUMBER
    'ëçåüçıåèêî(IoNumRecCount
    odbDatabase.Parameters.Add "IoNumRecCount", 0, ORAPARM_BOTH
    odbDatabase.Parameters("IoNumRecCount").ServerType = ORATYPE_NUMBER
    'îzóÒäiî[åèêî
    odbDatabase.Parameters.Add "OtNumAryCount", 0, ORAPARM_OUTPUT
    odbDatabase.Parameters("OtNumAryCount").ServerType = ORATYPE_NUMBER
    'çTèúòAóçï\ÉfÅ[É^ îzóÒ
    odbDatabase.Parameters.AddTable "OtStrDataAry", ORAPARM_OUTPUT, ORATYPE_VARCHAR2, cnsMaxRec, 200
    
    'çTèúòAóçï\     ìåÉfÅ[É^åèêî
    odbDatabase.Parameters.Add "OtNumHigasiCount", 0, ORAPARM_OUTPUT
    odbDatabase.Parameters("OtNumHigasiCount").ServerType = ORATYPE_NUMBER
    'çTèúòAóçï\     êºÉfÅ[É^åèêî
    odbDatabase.Parameters.Add "OtNumNisiCount", 0, ORAPARM_OUTPUT
    odbDatabase.Parameters("OtNumNisiCount").ServerType = ORATYPE_NUMBER
    'ñ¢çTèúécçÇàÍóóï\ ÉfÅ[É^åèêî
    odbDatabase.Parameters.Add "OtNumZanCount", 0, ORAPARM_OUTPUT
    odbDatabase.Parameters("OtNumZanCount").ServerType = ORATYPE_NUMBER
    
    'íSìñé“ÉRÅ[Éh
    odbDatabase.Parameters.Add "InStrUserID", gstrCommandLine(1), ORAPARM_INPUT
    odbDatabase.Parameters("InStrUserID").ServerType = ORATYPE_VARCHAR2
    'ÉRÉìÉsÉÖÅ[É^ñº
    odbDatabase.Parameters.Add "InStrComputerNM", gstrCommandLine(5), ORAPARM_INPUT
    odbDatabase.Parameters("InStrComputerNM").ServerType = ORATYPE_VARCHAR2
    
    'åüçıèIóπÉtÉâÉO
    odbDatabase.Parameters.Add "OtstrEndFlg", "0", ORAPARM_OUTPUT
    odbDatabase.Parameters("OtstrEndFlg").ServerType = ORATYPE_VARCHAR2

    'ÇrÇpÇkï∂çÏê¨
    strSQL = "BEGIN QPAP_CEnt140PkG.QPAP_CEnt140GetKoujyo(" & _
    ":InStrSyoriKbn," & _
    ":InStrSyoriYM," & _
    ":InNumMaxRec," & _
    ":IoNumFetchCount," & _
    ":IoNumRecCount," & _
    ":OtNumAryCount," & _
    ":OtStrDataAry," & _
    ":OtNumHigasiCount," & _
    ":OtNumNisiCount," & _
    ":OtNumZanCount," & _
    ":InStrUserID," & _
    ":InStrComputerNM," & _
    ":OtstrEndFlg); END;"

    'íäèoÉåÉRÅ[ÉhÇÉäÉXÉgÇ…ï\é¶
    lngRecCount = 0               'ïœêîÇÃÉNÉäÉA
    lngFirstCnt = 1               'ïœêîÇÃÉNÉäÉA
    i = 1

    Do
        lngFirstCnt = (i - 1) * cnsMaxRec + 1        'ΩÃﬂ⁄ØƒﬁÇÃäJénçsÇÃê›íË
        
        'ÇrÇoÇÃé¿çs
        odbDatabase.DbexecuteSQL (strSQL)
        
        'íäèoåèêîÇï\é¶Ç∑ÇÈ
        If i = 1 Then
            '√∞ÃﬁŸåèêîóp
            Erase gDataAry
            glngTblCnt = 0

            'íäèoåèêîÇ™0åèÇÃèÍçá
            If odbDatabase.Parameters("IoNumRecCount") = 0 Then
                Call gsubParaRemove(odbDatabase)
                Exit Function
            End If
            'îzóÒÇÃçƒíËã`
            lngMax = odbDatabase.Parameters("IoNumRecCount")
            glngTblCnt = lngMax
            ReDim gDataAry(lngMax)
        End If
        
        'ç≈èIÇÃê›íË
'        lngRecCount = lngRecCount + odbDatabase.Parameters("OtNumAryCount")    'ÅyWin2000ëŒâûÅzDel by Yokoyama@NBC 2004/04/19
        lngRecCount = lngRecCount + CLng(odbDatabase.Parameters("OtNumAryCount"))     'ÅyWin2000ëŒâûÅzAdd by Yokoyama@NBC 2004/04/19
        
        For j = lngFirstCnt To lngRecCount
            'çTèúòAóçï\èWñÒÉfÅ[É^
            gDataAry(j) = odbDatabase.Parameters("OtStrDataAry").Get_Value(j - 1)
        Next j
        
        i = i + 1

    Loop Until odbDatabase.Parameters("OtstrEndFlg") = "1"  'èIóπÉtÉâÉOÅÅÇPÇ‹Ç≈

    lngHigasiCount = odbDatabase.Parameters("OtNumHigasiCount") 'çTèúòAóçï\         ìåÉfÅ[É^åèêî
    lngNisiCount = odbDatabase.Parameters("OtNumNisiCount")     'çTèúòAóçï\         êºÉfÅ[É^åèêî
    lngZanCount = odbDatabase.Parameters("OtNumZanCount")       'ñ¢çTèúécçÇàÍóóï\     ÉfÅ[É^åèêî
    
    If lngHigasiCount > 0 Or lngNisiCount > 0 Or lngZanCount > 0 Then
        blnGetKoujyo = True
    End If
    
    'ÉIÉuÉWÉFÉNÉgÇÃäJï˙
    Call gsubParaRemove(odbDatabase)

    Exit Function

errGetKoujyo:
'ÉGÉâÅ[èàóù
    'ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWï\é¶
    Call gsubDBErrorMessage(gstrCommandLine(8), gcstrPrjName, _
                           gstrCommandLine(3), gstrCommandLine(5), gstrGetErrDateFormat)
    'ÉIÉuÉWÉFÉNÉgÇÃäJï˙
    Call gsubParaRemove(odbDatabase)

End Function

'***********************************************************************************
'    àÍóóï\ï\é¶
'***********************************************************************************
Private Sub subDispList()
 Dim i             As Long   '
 Dim lngKensuu     As Long
 Dim strValue      As String 'çÄñ⁄ílï∂éöóÒ
 Dim StrDate       As String 'çÄñ⁄ílï∂éöóÒ

    'ëçåèêî
    lngKensuu = UBound(gDataAry())

    With sprList
        .ReDraw = False
                
        'ΩÃﬂ⁄Øƒﬁº∞ƒÇÃMaxRowÇê›íË(max20ÇÇ±Ç¶ÇΩÇÁê›íËÇ∑ÇÈ
'        If lngKensuu > 20 Then
            .MaxRows = lngKensuu
 '       Else
'            .MaxRows = 20
'        End If
        
        '1âÒÇÃåèêî
        For i = 1 To lngKensuu
                   
            'èÿèëñæç◊ÇPÉåÉRÅ[Éh
            StrDate = gDataAry(i)
        
            'à»â∫àÍóóï\é¶óp
            
            'ê¥éZìXÉRÅ[Éh
            strValue = Trim$(gfncstrDlm2(StrDate, 1))
            .SetText 1, i, strValue
            'ê¥éZìXñº
            strValue = Trim$(gfncstrDlm2(StrDate, 2))
            .SetText 2, i, strValue
            'åèêî
            strValue = Trim$(gfncstrDlm2(StrDate, 3))
            strValue = Format$(CDbl(strValue), "#,##0")
            .SetText 3, i, strValue
            
            'ã‡äzçáåv
            strValue = Trim$(gfncstrDlm2(StrDate, 4))
            strValue = Format$(CDbl(strValue), "#,##0")
            .SetText 4, i, strValue
            
            'å≥ã‡çáåv
            strValue = Trim$(gfncstrDlm2(StrDate, 5))
            strValue = Format$(CDbl(strValue), "#,##0")
            .SetText 5, i, strValue
            'óòëßçáåv
            strValue = Trim$(gfncstrDlm2(StrDate, 6))
            strValue = Format$(CDbl(strValue), "#,##0")
            .SetText 6, i, strValue
            'écçÇçáåv
            strValue = Trim$(gfncstrDlm2(StrDate, 7))
            strValue = Format$(CDbl(strValue), "#,##0")
            .SetText 7, i, strValue

            .RowHeight(i) = 9.55
            
        Next i
        
        .ReDraw = True
    
    End With

End Sub

'ÉNÉäÉXÉ^ÉãÉåÉ|Å[Ég
'MOD 20100809 1004091 IMZ SHIBUTANI START
'à¯êîÅFstrTozaiKBN As StringÅ@ÇçÌèú
'Private Sub subPrintReport1(intDestinationConstants As DestinationConstants, strTozaiKBN As String)
Private Sub subPrintReport1(intDestinationConstants As DestinationConstants)
'MOD 20100809 1004091 IMZ SHIBUTANI END

Dim strSelectionFormula As String
Dim strConectPoint      As String
Dim intRet              As Integer
Dim strWareki           As String
Dim strNen              As String
Dim strTuki             As String

    strWareki = Format$(cobSyoriYM & "/01", "gggeemmdd")
    strNen = Mid$(strWareki, 3, 2)
    strNen = StrConv(strNen, vbWide)
    strWareki = Left$(strWareki, 2)
    strTuki = StrConv(Format$(Val(Right$(cobSyoriYM, 2)), "##"), vbWide)
    
    'ÉAÉNÉZÉXÇ∑ÇÈÉfÅ[É^ÉxÅ[ÉXÇ»Ç«ÇãLèq
    strConectPoint = "DSN = " & gstrCommandLine(0) & _
                    ";UID = " & gstrCommandLine(3) & _
                    ";PWD = " & gstrCommandLine(4)

    With CrystalReport
        'ÉNÉäÉXÉ^ÉãÉåÉ|Å[ÉgÇÃÉtÉ@ÉCÉãÇ™Ç†ÇÈèÍèäÇãLèqÇ∑ÇÈ
        .ReportFileName = App.Path & "\QPAV_CEnt140.rpt"
        .DiscardSavedData = True

        'ãLèqÇ≥ÇÍÇΩÉAÉNÉZÉXÉ|ÉCÉìÉgÇ…ê⁄ë±
        .Connect = strConectPoint

        'ÉçÉPÅ[ÉVÉáÉìÇÃê›íË
        .DataFiles(0) = Format$(gstrCommandLine(3), ">") & ".QPAO_KOJOW"
        
        'ÉpÉâÉÅÅ[É^ÇãLèqÇ∑ÇÈ
        .Formulas(0) = "PARA01='" & strWareki & strNen & "'"
        .Formulas(1) = "PARA02='" & strTuki & "'"
        If gstrSyoriKbn = "1" Then
            .Formulas(2) = "PARA03='ããó^'"
        Else
            .Formulas(2) = "PARA03='è‹ó^'"
        End If
            
        'ADD 0811051 ÉOÉãÅ[Évé–àıèÿèëë›ïtí†ï[å©íºÇµ NBC ISHIDA START
        If gstrSyoriKbn = "1" Then
            
            If Mid(strSyoriMMDDHHMI, 3, 4) >= strDATE10 And Mid(strSyoriMMDDHHMI, 3, 2) <= strDATE3 Then
                'ããó^çTèúämíËì˙Ç©ÇÁããó^çTèúòAóçï\ÇÃêÿÇËë÷ÇÌÇËì˙Ç‹Ç≈(ñàåé5ì˙Å`15ì˙)
                .Formulas(3) = "PARA04='ÅyämíËå„Åz'"
            Else
                .Formulas(3) = "PARA04='ÅyämíËëOÅz'"
            End If
        
        Else
            'è‹ó^çTèúåéÇ™6åé
            If Right$(cobSyoriYM, 2) = strDATE4 Then
                
                'í†ï[èoóÕì˙Ç™è‹ó^çTèúämíËì˙Ç©ÇÁè‹ó^çTèúòAóçï\Ç™èoóÕÇ≈Ç´ÇÈç≈èIì˙(5åé20ì˙Å`6åé30ì˙)
                If Right(gstrSysDate, 4) >= strDATE5 And Right(gstrSysDate, 4) <= strDATE6 Then
                    .Formulas(3) = "PARA04='ÅyämíËå„Åz'"
                Else
                    .Formulas(3) = "PARA04='ÅyämíËëOÅz'"
                End If
            
            'èàóùîNåéÇ™12åé
            ElseIf Right$(cobSyoriYM, 2) = strDATE7 Then
                
                'í†ï[èoóÕì˙Ç™è‹ó^çTèúämíËì˙Ç©ÇÁè‹ó^çTèúòAóçï\Ç™èoóÕÇ≈Ç´ÇÈç≈èIì˙(11åé10ì˙Å`12åé31ì˙)
                If Right(gstrSysDate, 4) >= strDATE8 And Right(gstrSysDate, 4) <= strDATE9 Then
                    .Formulas(3) = "PARA04='ÅyämíËå„Åz'"
                Else
                    .Formulas(3) = "PARA04='ÅyämíËëOÅz'"
                End If
            
            'èàóùîNåéÇ™6åéÅE12åéà»äO
            Else
                .Formulas(3) = "PARA04='ÅyämíËëOÅz'"
            End If
        
        End If
        'ADD 0811051 ÉOÉãÅ[Évé–àıèÿèëë›ïtí†ï[å©íºÇµ NBC ISHIDA END

'****** 2001/10/11 ìåêºãÊï™Ç™ÇOÇÃêlÇ…ëŒâû ******
        
        'íäèoèåèÇãLèqÇ∑ÇÈ
'MOD 20100809 1004091 IMZ SHIBUTANI START
'        If strTozaiKBN = "1" Then
'            strSelectionFormula = "({QPAO_KOJOW.QPAO_TOZAIKBN} = '0' OR {QPAO_KOJOW.QPAO_TOZAIKBN} = '1')" & _
                             " AND ({QPAO_KOJOW.QPAO_USERID} = '" & gstrCommandLine(1) & "')" & _
                             " AND ({QPAO_KOJOW.QPAO_COMPUTERNM} = '" & gstrCommandLine(5) & "')"
'        Else
'            strSelectionFormula = "({QPAO_KOJOW.QPAO_TOZAIKBN} = '" & strTozaiKBN & "')" & _
                             " AND ({QPAO_KOJOW.QPAO_USERID} = '" & gstrCommandLine(1) & "')" & _
                             " AND ({QPAO_KOJOW.QPAO_COMPUTERNM} = '" & gstrCommandLine(5) & "')"
'        End If
'        'íäèoèåèÇãLèqÇ∑ÇÈ
'        strSelectionFormula = "({QPAO_KOJOW.QPAO_TOZAIKBN} = '" & strTozaiKBN & "')" & _
'                         " AND ({QPAO_KOJOW.QPAO_USERID} = '" & gstrCommandLine(1) & "')" & _
'                         " AND ({QPAO_KOJOW.QPAO_COMPUTERNM} = '" & gstrCommandLine(5) & "')"
        
        strSelectionFormula = "({QPAO_KOJOW.QPAO_USERID} = '" & gstrCommandLine(1) & "')" & _
                         " AND ({QPAO_KOJOW.QPAO_COMPUTERNM} = '" & gstrCommandLine(5) & "')"
'MOD 20100809 1004091 IMZ SHIBUTANI END
        
        'íäèoèåèÇãLèqÇ∑ÇÈ
        .SelectionFormula = strSelectionFormula

        'èoóÕêÊê›íË
        .Destination = intDestinationConstants

        'ÉvÉåÉrÉÖÅ[ÉEÉBÉìÉhÉEÇÃê›íË
        If intDestinationConstants = crptToWindow Then

            .WindowTitle = "çTèúòAóçï\ (" & gstrCommandLine(8) & ")"

            If Me.Top < 0 Then
                .WindowTop = 0
            Else
                .WindowTop = Me.Top / Screen.TwipsPerPixelY
            End If

            If Me.Left < 0 Then
                .WindowLeft = 0
            Else
                .WindowLeft = Me.Left / Screen.TwipsPerPixelX
            End If

            .WindowHeight = Me.Height / Screen.TwipsPerPixelY
            .WindowWidth = Me.Width / Screen.TwipsPerPixelX
        End If

        'ÉNÉäÉXÉ^ÉãÉåÉ|Å[ÉgÇé¿çsÇ∑ÇÈ
        intRet = .PrintReport

        Me.Enabled = True
        Me.MousePointer = vbDefault
        stbSystem.Panels.Item(1).Text = ""

        If intRet = 20545 Then
            Exit Sub
        ElseIf intRet <> 0 Then
            Call QSAV_SysErr.subSysErr(gcstrPrjName, gstrCommandLine(1) _
                                    , gstrCommandLine(5), gstrGetErrDateFormat() _
                                    , Me.Caption, CStr(.LastErrorNumber), .LastErrorString)
        End If
'DEL 20100809 1004091 IMZ SHIBUTANI START
'        .Reset
'DEL 20100809 1004091 IMZ SHIBUTANI END

'ADD 20100809 1004091 IMZ SHIBUTANI START
        '----------------------------------------------------------------------
        '   çTèúòAóççáåvï\ÇÃèoóÕ
        '----------------------------------------------------------------------
        'ÉNÉäÉXÉ^ÉãÉåÉ|Å[ÉgÇÃÉtÉ@ÉCÉãÇ™Ç†ÇÈèÍèäÇãLèqÇ∑ÇÈ
        .ReportFileName = App.Path & "\QPAV_CEnt143.rpt"
        .DiscardSavedData = True

        'ÉvÉåÉrÉÖÅ[ÉEÉBÉìÉhÉEÇÃê›íË
        If intDestinationConstants = crptToWindow Then

            .WindowTitle = "çTèúòAóççáåvï\ (" & gstrCommandLine(8) & ")"

            If Me.Top < 0 Then
                .WindowTop = 0
            Else
                .WindowTop = Me.Top / Screen.TwipsPerPixelY
            End If

            If Me.Left < 0 Then
                .WindowLeft = 0
            Else
                .WindowLeft = Me.Left / Screen.TwipsPerPixelX
            End If

            .WindowHeight = Me.Height / Screen.TwipsPerPixelY
            .WindowWidth = Me.Width / Screen.TwipsPerPixelX
        End If

        'ÉNÉäÉXÉ^ÉãÉåÉ|Å[ÉgÇé¿çsÇ∑ÇÈ
        intRet = .PrintReport

        Me.Enabled = True
        Me.MousePointer = vbDefault
        stbSystem.Panels.Item(1).Text = ""

        If intRet = 20545 Then
            Exit Sub
        ElseIf intRet <> 0 Then
            Call QSAV_SysErr.subSysErr(gcstrPrjName, gstrCommandLine(1) _
                                    , gstrCommandLine(5), gstrGetErrDateFormat() _
                                    , Me.Caption, CStr(.LastErrorNumber), .LastErrorString)
        End If
        .Reset
'ADD 20100809 1004091 IMZ SHIBUTANI END
    End With
    
End Sub

Private Sub subPrintReport2(intDestinationConstants As DestinationConstants)

Dim strSelectionFormula As String
Dim strConectPoint      As String
Dim intRet              As Integer
Dim strWareki           As String
Dim strNen              As String
Dim strTuki             As String
    
    'ÉAÉNÉZÉXÇ∑ÇÈÉfÅ[É^ÉxÅ[ÉXÇ»Ç«ÇãLèq
    strConectPoint = "DSN = " & gstrCommandLine(0) & _
                    ";UID = " & gstrCommandLine(3) & _
                    ";PWD = " & gstrCommandLine(4)

    With CrystalReport
        'ÉNÉäÉXÉ^ÉãÉåÉ|Å[ÉgÇÃÉtÉ@ÉCÉãÇ™Ç†ÇÈèÍèäÇãLèqÇ∑ÇÈ
        .ReportFileName = App.Path & "\QPAV_CEnt141.rpt"
        .DiscardSavedData = True

        'ãLèqÇ≥ÇÍÇΩÉAÉNÉZÉXÉ|ÉCÉìÉgÇ…ê⁄ë±
        .Connect = strConectPoint

        'ÉçÉPÅ[ÉVÉáÉìÇÃê›íË
        .DataFiles(0) = Format$(gstrCommandLine(3), ">") & ".QPAP_MIKOJOW"
        
        'íäèoèåèÇãLèqÇ∑ÇÈ
        strSelectionFormula = "    ({QPAP_MIKOJOW.QPAP_USERID} = '" & gstrCommandLine(1) & "')" & _
                              "AND ({QPAP_MIKOJOW.QPAP_COMPUTERNM} = '" & gstrCommandLine(5) & "')"
        'íäèoèåèÇãLèqÇ∑ÇÈ
        .SelectionFormula = strSelectionFormula
        
        'èoóÕêÊê›íË
        .Destination = intDestinationConstants

        'ÉvÉåÉrÉÖÅ[ÉEÉBÉìÉhÉEÇÃê›íË
        If intDestinationConstants = crptToWindow Then

            .WindowTitle = "ñ¢çTèúécçÇàÍóóï\ (" & gstrCommandLine(8) & ")"

            If Me.Top < 0 Then
                .WindowTop = 0
            Else
                .WindowTop = Me.Top / Screen.TwipsPerPixelY
            End If

            If Me.Left < 0 Then
                .WindowLeft = 0
            Else
                .WindowLeft = Me.Left / Screen.TwipsPerPixelX
            End If

            .WindowHeight = Me.Height / Screen.TwipsPerPixelY
            .WindowWidth = Me.Width / Screen.TwipsPerPixelX
        End If

        'ÉNÉäÉXÉ^ÉãÉåÉ|Å[ÉgÇé¿çsÇ∑ÇÈ
        intRet = .PrintReport

        Me.Enabled = True
        Me.MousePointer = vbDefault
        stbSystem.Panels.Item(1).Text = ""

        If intRet = 20545 Then
            Exit Sub
        ElseIf intRet <> 0 Then
            Call QSAV_SysErr.subSysErr(gcstrPrjName, gstrCommandLine(1) _
                                    , gstrCommandLine(5), gstrGetErrDateFormat() _
                                    , Me.Caption, CStr(.LastErrorNumber), .LastErrorString)
        End If
'DEL 20100809 1004091 IMZ SHIBUTANI START
'        .Reset
'DEL 20100809 1004091 IMZ SHIBUTANI END

'ADD 20100809 1004091 IMZ SHIBUTANI START
        '----------------------------------------------------------------------
        '   ñ¢çTèúécçÇàÍóóçáåvï\ÇÃèoóÕ
        '----------------------------------------------------------------------
        'ÉNÉäÉXÉ^ÉãÉåÉ|Å[ÉgÇÃÉtÉ@ÉCÉãÇ™Ç†ÇÈèÍèäÇãLèqÇ∑ÇÈ
        .ReportFileName = App.Path & "\QPAV_CEnt144.rpt"
        .DiscardSavedData = True

        'ÉvÉåÉrÉÖÅ[ÉEÉBÉìÉhÉEÇÃê›íË
        If intDestinationConstants = crptToWindow Then

            .WindowTitle = "ñ¢çTèúécçÇàÍóóçáåvï\ (" & gstrCommandLine(8) & ")"

            If Me.Top < 0 Then
                .WindowTop = 0
            Else
                .WindowTop = Me.Top / Screen.TwipsPerPixelY
            End If

            If Me.Left < 0 Then
                .WindowLeft = 0
            Else
                .WindowLeft = Me.Left / Screen.TwipsPerPixelX
            End If

            .WindowHeight = Me.Height / Screen.TwipsPerPixelY
            .WindowWidth = Me.Width / Screen.TwipsPerPixelX
        End If

        'ÉNÉäÉXÉ^ÉãÉåÉ|Å[ÉgÇé¿çsÇ∑ÇÈ
        intRet = .PrintReport

        Me.Enabled = True
        Me.MousePointer = vbDefault
        stbSystem.Panels.Item(1).Text = ""

        If intRet = 20545 Then
            Exit Sub
        ElseIf intRet <> 0 Then
            Call QSAV_SysErr.subSysErr(gcstrPrjName, gstrCommandLine(1) _
                                    , gstrCommandLine(5), gstrGetErrDateFormat() _
                                    , Me.Caption, CStr(.LastErrorNumber), .LastErrorString)
        End If
        .Reset
'ADD 20100809 1004091 IMZ SHIBUTANI END
    End With
    
End Sub

Private Sub subPrintReport3(intDestinationConstants As DestinationConstants)

Dim strSelectionFormula As String
Dim strConectPoint      As String
Dim intRet              As Integer
Dim strWareki           As String
Dim strNen              As String
Dim strTuki             As String
    
    'ÉAÉNÉZÉXÇ∑ÇÈÉfÅ[É^ÉxÅ[ÉXÇ»Ç«ÇãLèq
    strConectPoint = "DSN = " & gstrCommandLine(0) & _
                    ";UID = " & gstrCommandLine(3) & _
                    ";PWD = " & gstrCommandLine(4)

    With CrystalReport
        'ÉNÉäÉXÉ^ÉãÉåÉ|Å[ÉgÇÃÉtÉ@ÉCÉãÇ™Ç†ÇÈèÍèäÇãLèqÇ∑ÇÈ
        .ReportFileName = App.Path & "\QPAV_CEnt142.rpt"
        .DiscardSavedData = True

        'ãLèqÇ≥ÇÍÇΩÉAÉNÉZÉXÉ|ÉCÉìÉgÇ…ê⁄ë±
        .Connect = strConectPoint

        'ÉçÉPÅ[ÉVÉáÉìÇÃê›íË
'MOD 20100809 1004091 IMZ SHIBUTANI START
'        .DataFiles(0) = Format$(gstrCommandLine(3), ">") & ".QPAQ_ZANDAKAW"
        .DataFiles(0) = Format$(gstrCommandLine(3), ">") & ".QPB8_MIKOJORENW"
'MOD 20100809 1004091 IMZ SHIBUTANI END
        
        'íäèoèåèÇãLèqÇ∑ÇÈ
'MOD 20100809 1004091 IMZ SHIBUTANI START
'        strSelectionFormula = "    ({QPAQ_ZANDAKAW.QPAQ_USERID} = '" & gstrCommandLine(1) & "')" & _
                              "AND ({QPAQ_ZANDAKAW.QPAQ_COMPUTERNM} = '" & gstrCommandLine(5) & "')"

        strSelectionFormula = "    ({QPB8_MIKOJORENW.QPB8_USERID} = '" & gstrCommandLine(1) & "')" & _
                              "AND ({QPB8_MIKOJORENW.QPB8_COMPUTERNM} = '" & gstrCommandLine(5) & "')"
'MOD 20100809 1004091 IMZ SHIBUTANI END
        
        'íäèoèåèÇãLèqÇ∑ÇÈ
        .SelectionFormula = strSelectionFormula

        'èoóÕêÊê›íË
        .Destination = intDestinationConstants

        'ÉvÉåÉrÉÖÅ[ÉEÉBÉìÉhÉEÇÃê›íË
        If intDestinationConstants = crptToWindow Then

            .WindowTitle = "ñ¢çTèúòAóçàÍóóï\ (" & gstrCommandLine(8) & ")"

            If Me.Top < 0 Then
                .WindowTop = 0
            Else
                .WindowTop = Me.Top / Screen.TwipsPerPixelY
            End If

            If Me.Left < 0 Then
                .WindowLeft = 0
            Else
                .WindowLeft = Me.Left / Screen.TwipsPerPixelX
            End If

            .WindowHeight = Me.Height / Screen.TwipsPerPixelY
            .WindowWidth = Me.Width / Screen.TwipsPerPixelX
        End If

        'ÉNÉäÉXÉ^ÉãÉåÉ|Å[ÉgÇé¿çsÇ∑ÇÈ
        intRet = .PrintReport

        Me.Enabled = True
        Me.MousePointer = vbDefault
        stbSystem.Panels.Item(1).Text = ""

        If intRet = 20545 Then
            Exit Sub
        ElseIf intRet <> 0 Then
            Call QSAV_SysErr.subSysErr(gcstrPrjName, gstrCommandLine(1) _
                                    , gstrCommandLine(5), gstrGetErrDateFormat() _
                                    , Me.Caption, CStr(.LastErrorNumber), .LastErrorString)
        End If
'DEL 20100809 1004091 IMZ SHIBUTANI START
'        .Reset
'DEL 20100809 1004091 IMZ SHIBUTANI END

'ADD 20100809 1004091 IMZ SHIBUTANI START
        '----------------------------------------------------------------------
        '   ñ¢çTèúòAóçàÍóóçáåvï\ÇÃèoóÕ
        '----------------------------------------------------------------------
        'ÉNÉäÉXÉ^ÉãÉåÉ|Å[ÉgÇÃÉtÉ@ÉCÉãÇ™Ç†ÇÈèÍèäÇãLèqÇ∑ÇÈ
        .ReportFileName = App.Path & "\QPAV_CEnt145.rpt"
        .DiscardSavedData = True

        'ÉvÉåÉrÉÖÅ[ÉEÉBÉìÉhÉEÇÃê›íË
        If intDestinationConstants = crptToWindow Then

            .WindowTitle = "ñ¢çTèúòAóçàÍóóçáåvï\ (" & gstrCommandLine(8) & ")"

            If Me.Top < 0 Then
                .WindowTop = 0
            Else
                .WindowTop = Me.Top / Screen.TwipsPerPixelY
            End If

            If Me.Left < 0 Then
                .WindowLeft = 0
            Else
                .WindowLeft = Me.Left / Screen.TwipsPerPixelX
            End If

            .WindowHeight = Me.Height / Screen.TwipsPerPixelY
            .WindowWidth = Me.Width / Screen.TwipsPerPixelX
        End If

        'ÉNÉäÉXÉ^ÉãÉåÉ|Å[ÉgÇé¿çsÇ∑ÇÈ
        intRet = .PrintReport

        Me.Enabled = True
        Me.MousePointer = vbDefault
        stbSystem.Panels.Item(1).Text = ""

        If intRet = 20545 Then
            Exit Sub
        ElseIf intRet <> 0 Then
            Call QSAV_SysErr.subSysErr(gcstrPrjName, gstrCommandLine(1) _
                                    , gstrCommandLine(5), gstrGetErrDateFormat() _
                                    , Me.Caption, CStr(.LastErrorNumber), .LastErrorString)
        End If
        .Reset
'ADD 20100809 1004091 IMZ SHIBUTANI END
    End With
    
End Sub

'*********************************************************************************
'*   âÊñ êßå‰
'*Å@Å@à¯êîÅFblnEnabledFlg=True âÊñ égópïsâ¬      blnEnabledFlg=False âÊñ égópâ¬
'*********************************************************************************
Private Sub subGamenSeigyo(blnEnabledFlg As Boolean)
    If blnEnabledFlg = True Then
        Me.MousePointer = vbDefault   'É}ÉEÉXÉ|ÉCÉìÉ^Å[ÅiÉmÅ[É}ÉãÅj
        Me.Enabled = True             'âÊñ ëÄçÏâ¬
    Else
        Me.MousePointer = vbHourglass 'É}ÉEÉXÉ|ÉCÉìÉ^Å[ÅiçªéûåvÅj
        DoEvents
        Me.Enabled = False            'âÊñ ëÄçÏïsâ¬
    End If
End Sub

'***********************************************************************************
'    âÊñ èâä˙âª
'***********************************************************************************
Private Sub subInitScreen()
 Dim i As Long
 Dim strTmp As String
 Dim ymd    As Date

    blnNoChangeEvFlg = True
    
    'ComboBoxê›íË
    'èàóùîNåé
    ymd = CVDate(Mid$(gstrSysDate, 1, 4) & "/" & Mid$(gstrSysDate, 5, 2) & "/" & Mid$(gstrSysDate, 7, 2))
    With cobSyoriYM
        .Clear
        .AddItem (Mid$(gstrSysDate, 1, 4) & "/" & Mid$(gstrSysDate, 5, 2))
        .AddItem (Format(DateAdd("m", 1, ymd), "yyyy/mm"))
        If Day(ymd) > 15 Then
            .ListIndex = 1
        Else
            .ListIndex = 0
        End If
    End With

    '2005.05.06 Yasui@NBC çTèúçÏê¨ïsîıëŒâû ==>
    strKikan(0) = Format(DateAdd("m", -1, ymd), "yyyy/mm")
    strKikan(1) = Format(ymd, "yyyy/mm")
    strKikan(2) = Format(DateAdd("m", 1, ymd), "yyyy/mm")
    '2005.05.06 Yasui@NBC çTèúçÏê¨ïsîıëŒâû <==
    
    'ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWÉNÉäÉA
    lblMsg.Caption = ""

    'ããó^ÅAè‹ó^É{É^Éì
    optKbn(0).Value = True
    lblKyuuyo.Caption = cobSyoriYM.Text & "ìxããó^ï™"
    
    cobSyoriYM.Enabled = True
    optKbn(0).Enabled = True
    optKbn(1).Enabled = True
    cmdPFK(5).Enabled = True
    cmdPrint(0).Enabled = False
    cmdPrint(1).Enabled = False
'**** 11/02 è‹ó^ÉfÅ[É^çÏê¨í«â¡ ****
    cmdInst.Enabled = False

     'Spred SheetÇÃèâä˙âª
    Call gsubSpdClear(sprList)
    sprList.MaxRows = 0
    

    blnNoChangeEvFlg = False
    
End Sub

'****************************************************************************************
'* égópÉèÅ[ÉNÉeÅ[ÉuÉãëSçÌèú
'****************************************************************************************
Private Sub subDelWorkTbl()
 Dim strSQL As String
 
 On Error GoTo errDelWorkTbl
 
    'ÉÜÅ[ÉUÅ[ÇhÇc
    With odbDatabase.Parameters
        .Add "InStrUserID", gstrCommandLine(1), ORAPARM_INPUT
        .Item("InStrUserID").ServerType = ORATYPE_VARCHAR2
        'ÉRÉìÉsÉÖÅ[É^ñº
        .Add "InStrComputerNM", gstrCommandLine(5), ORAPARM_INPUT
        .Item("InStrComputerNM").ServerType = ORATYPE_VARCHAR2
    End With
    
    strSQL = "BEGIN QPAP_CEnt320PkG.QPAP_CEnt320DelWorkTbl(" & _
             ":InStrUserID," & ":InStrComputerNM); END;"

    'ÉXÉgÉAÉhÉvÉçÉVÅ[ÉWÉÉãNìÆ
    odbDatabase.DbexecuteSQL (strSQL)

    'ÉIÉuÉWÉFÉNÉgÇÃäJï˙
    Call gsubParaRemove(odbDatabase)
    
    Exit Sub
    
errDelWorkTbl:
'ÉGÉâÅ[èàóù
    'ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWï\é¶
    Call gsubDBErrorMessage(gstrCommandLine(8), gcstrPrjName, _
                           gstrCommandLine(3), gstrCommandLine(5), gstrGetErrDateFormat)
    'ÉIÉuÉWÉFÉNÉgÇÃäJï˙
    Call gsubParaRemove(odbDatabase)
End Sub
    
'****************************************************************************************
'* è‹ó^ÉfÅ[É^çÏê¨éwé¶
'****************************************************************************************
Private Function InstKoujo() As Boolean

    InstKoujo = False
    
    'ÉXÉeÅ[É^ÉXÉoÅ[ÉÅÉbÉZÅ[ÉW
    stbSystem.Panels.Item(1).Text = "èàóùíÜÅDÅDÅD"
    lblMsg.Caption = ""
    DoEvents
    
    'ÅüâÊñ êßå‰
    Call subGamenSeigyo(False)  'âÊñ ÉçÉbÉN
    
    'è‹ó^çTèúÉfÅ[É^çÏê¨
    If blnInstKoujyo = False Then
        GoTo Exit_InstKoujo
    End If
    
    InstKoujo = True
    
Exit_InstKoujo:
    'ÅüâÊñ êßå‰âèú
    Call subGamenSeigyo(True)   'égópâ¬
    stbSystem.Panels.Item(1).Text = ""

End Function

'****************************************************************************************
'* è‹ó^ÉfÅ[É^çÏê¨èàóù
'****************************************************************************************
Private Function blnInstKoujyo() As Boolean

    Dim strSQL               As String

On Error GoTo errInstKoujyo

    blnInstKoujyo = False
    
    'ÇrÇo
    odbDatabase.Parameters.Add "InStrSyoriYM", gstrSyoriYM, ORAPARM_INPUT               'èàóùîNåé
    odbDatabase.Parameters.Add "InStrUserID", gstrCommandLine(1), ORAPARM_INPUT         'íSìñé“ÉRÅ[Éh
    odbDatabase.Parameters.Add "InStrComputerNM", gstrCommandLine(5), ORAPARM_INPUT     'ÉRÉìÉsÉÖÅ[É^ñº

    'ÇrÇpÇkï™ÇÃçÏê¨
    strSQL = "BEGIN QPAP_CEnt140PkG.QPAP_CEnt140KojoTKousin (" & _
            ":InStrSyoriYM,:InStrUserID,:InStrComputerNM); END;"

    'ÇrÇoÇÃé¿çs
    odbDatabase.DbexecuteSQL (strSQL)
    
    If odbDatabase.LastServerErr <> 0 Then
        GoTo errInstKoujyo
    End If
    
    'ÉIÉuÉWÉFÉNÉgÇÃäJï˙
    Call gsubParaRemove(odbDatabase)

    blnInstKoujyo = True
    
    Exit Function
  
errInstKoujyo:
    'ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWï\é¶
    Call gsubDBErrorMessage(gstrCommandLine(8), gcstrPrjName, _
                           gstrCommandLine(3), gstrCommandLine(5), gstrGetErrDateFormat)
    'ÉIÉuÉWÉFÉNÉgÇÃäJï˙
    Call gsubParaRemove(odbDatabase)

End Function

'*********************************************************************************************
'*Å@Å@éËë±Ç´ñºÅFÅ@ñ¢çTèúòAóçï\ÉfÅ[É^Å@çÏê¨
'*Å@Å@à¯Å@êîÅ@ÅFÅ@Ç»Çµ
'*Å@Å@åãÅ@â Å@ÅFÅ@TrueÅcäYìñÉfÅ[É^óL  FalseÅcäYìñÉfÅ[É^ñ≥Çµ
'*********************************************************************************************
Private Function blnMakeMekoujyo() As Boolean

Dim strSQL               As String
Dim i                    As Long
Dim j                    As Long

On Error GoTo errblnMakeMekoujyo
    
    blnMakeMekoujyo = False

    'çTèúòAóçï\çÏê¨ÅïéÊìæ ÇrÇo

    With odbDatabase.Parameters
        .Add "InStrSyoriYM", gstrSyoriYM, ORAPARM_INPUT                 'èàóùîNåé(ÉRÉìÉ{É{ÉbÉNÉXÇÃíÜêg)
        
        .Add "InStrUserID", gstrCommandLine(1), ORAPARM_INPUT           'ÉÜÅ[ÉUÅ[ID
        .Item("InStrUserID").ServerType = ORATYPE_VARCHAR2
        
        .Add "InStrComputerNM", gstrCommandLine(5), ORAPARM_INPUT       'ÉRÉìÉsÉÖÅ[É^Å[ñº
        .Item("InStrComputerNM").ServerType = ORATYPE_VARCHAR2
        
        .Add "OtstrEndFlg", "0", ORAPARM_OUTPUT                         'èIóπÉtÉâÉO
        .Item("OtstrEndFlg").ServerType = ORATYPE_VARCHAR2
    End With

    'ÇrÇpÇkï∂çÏê¨
    strSQL = "BEGIN QPAP_CEnt320PkG.QPAP_CEnt320GetKoujyo(" & _
    ":InStrSyoriYM," & _
    ":InStrUserID," & _
    ":InStrComputerNM," & _
    ":OtstrEndFlg); END;"

    'ÇrÇoÇÃé¿çs
    Call odbDatabase.DbexecuteSQL(strSQL)

    If odbDatabase.Parameters("OtstrEndFlg") <> 1 Then
        'ÉIÉuÉWÉFÉNÉgÇÃäJï˙
        Call gsubParaRemove(odbDatabase)
        Exit Function
    End If
    'ÉIÉuÉWÉFÉNÉgÇÃäJï˙
    Call gsubParaRemove(odbDatabase)

    Exit Function

errblnMakeMekoujyo:
'ÉGÉâÅ[èàóù
    'ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWï\é¶
    Call gsubDBErrorMessage(gstrCommandLine(8), gcstrPrjName, _
                           gstrCommandLine(3), gstrCommandLine(5), gstrGetErrDateFormat)
    'ÉIÉuÉWÉFÉNÉgÇÃäJï˙
    Call gsubParaRemove(odbDatabase)
    Err.Clear
End Function
