Attribute VB_Name = "QSAV_CommonD"
Option Explicit

' ¡ ¡ ¡ ¡ ¡ ¡ ¡ ¡ ¡ ¡ ¡ ¡ ¡ ¡ ¡ ¡ ¡ ¡ ¡ ¡ ¡ ¡ ¡ ¡ ¡ ¡ ¡ ¡ ¡ ¡ ¡
'¡ 
' ¡                                    |||| ‹¤’ÊŠÖ”ˆê—— ||||
'¡ 
' ¡  @‚Pj gsubMaxCharSkipEX(txtTmp As TextBox, _
'¡    @                      lngMaxLength As Long)                                                    ƒtƒ‹Œ…’Eo
' ¡  PPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPP
'¡   @‚Qj gsubQSAV_ActX1001()                                                                      ƒn[ƒhƒRƒs[
' ¡  PPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPP
'¡   @‚Rj gsubInitStatusBar(objStb As StatusBar)@@@@@@                                 ƒXƒe[ƒ^ƒXƒo[‰Šú‰»
' ¡  PPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPP
'¡   @‚Sj gsubGetCommandLine(strCmdLine As String)                  ƒRƒ}ƒ“ƒhƒ‰ƒCƒ“ˆø”‚©‚çƒRƒ“ƒsƒ…[ƒ^–¼‚ğæ“¾‚·‚é
' ¡  PPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPP
'¡   @‚Tj gstrGetErrDateFormat() As String                                   ƒGƒ‰[ƒtƒH[ƒ€‚Ì“ú•tEŠÔ‚ğæ“¾‚·‚é
' ¡  PPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPP
'¡   @‚Uj gstrChange(vData As Variant) As String                                     ƒf[ƒ^‚ğ•¶š—ñ‚É•ÏŠ·‚·‚éŠÖ”
' ¡  PPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPP
'¡   @‚Vj gblnfncIsNumberStr(strNumber As String) As Boolean                             •¶š—ñ‚ª”š‚Ì‚İ‚©‚Ç‚¤‚©
' ¡  PPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPP
'¡   @‚Wj gstrCheckNull(vData As Variant, lngSpaceCount As Long) As String                      ‚m‚t‚k‚kƒ`ƒFƒbƒN
' ¡  PPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPP
'¡   @‚Xj gsubSelectText(objTxtbox As Textbox)                                       @@@         ƒeƒLƒXƒg‘I‘ğ
' ¡  PPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPP
'¡   ‚P‚Oj gIntFilterKey(IntKeyAscii As Integer, StrEnaChr As String) As Integer                   @“ü—Í•¶š§Œä
' ¡  PPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPP
'¡   ‚P‚Pj gblnCreateOracleSession() As Boolean @@@@@@@@@@ @@              µ×¸Ù¾¯¼®İµÌŞ¼Şª¸Ä‚ğì¬‚·‚é
' ¡  PPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPP
'¡   ‚P‚Qj gblnConnectOracleDatabase(strConnectUserID As String _
' ¡                          , strConnectPassword As String _
'¡                           , strConnectString As String) As Boolean                  ƒf[ƒ^ƒx[ƒX‚ÆÚ‘±‚·‚éŠÖ”
' ¡  PPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPP
'¡   ‚P‚Rj gsubTermOracleDB()                                                                ‚c‚a‚ÌƒNƒŠ[ƒ“ƒAƒbƒv
' ¡  PPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPP
'¡   ‚P‚Sj gblnOpenOracleTable(objTable As Object, strSQL As String) As Boolean                      ÀŞ²Å¾¯Äì¬
' ¡  PPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPP
'¡   ‚P‚Tj gsubDBErrorMessage(strProgramID As String _
' ¡     @, strFormName As String, strUserID As String _
'¡     @ , strTanmatuID As String, strTime As String)                            ORACLEƒGƒ‰[ƒƒbƒZ[ƒW‚ğæ“¾‚·‚é
' ¡  PPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPP
'¡   ‚P‚Uj gsubParaRemove(objDatabase As Object)                                       ½Ä±°ÄŞÌßÛ¼°¼Ş¬‚ÌÊß×Ò°ÀŠJ•ú
' ¡  PPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPP
'¡   ‚P‚Vj gstrGetCodeMeisyo(odbDatabase As Object, vCodeNo As Variant
' ¡                      , strCodeKbn As String) As String                         ƒR[ƒhƒe[ƒuƒ‹‚©‚ç–¼Ì‚ğæ“¾‚·‚é
'¡   PPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPP
' ¡  ‚P‚Wj gstrGetCodeTableSQL(strCodeNo As String, _
'¡                         strCodeKbn As String) As String                        ƒR[ƒhƒe[ƒuƒ‹–|–ó’l‚ğæ“¾‚·‚éSQL
' ¡  PPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPP
'¡   ‚P‚Xj gsubSetComboCode(strCode As String, strText() As String)             ”z—ñ‚ÉƒR[ƒh‚s‚Ì–|–ó’l‚ğƒZƒbƒg‚·‚é
' ¡  PPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPP
'¡   ‚Q‚Oj gfncstrDlm(strDlmData As String) As String               @@@@@@ @@@@ ‹æØ‚è•¶š“ü‚èƒf[ƒ^•ª‰ğ
' ¡  PPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPP
' ¡----SpreadŠÖ˜A
' ¡
'¡   ‡@ gsubSpdClear(spd As vaSpread)@@@@@@@@@@@@@@@@@@@@@@@                   ½ÌßÚ¯ÄŞ¸Ø±ˆ—
' ¡  PPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPP
'¡   ‡A gsubSetCellText(ByVal ObjNm As Object,  intCol As Integer,
' ¡                     ByVal intRow As Integer, varVal As Variant,
'¡                     Optional strDefault As String = "")                          ƒXƒvƒŒƒbƒh‚Éƒf[ƒ^‚ğƒZƒbƒg‚·‚é
' ¡  PPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPP
'¡   ‡B gVarSpdGetText(spd As vaSpread, lCol As Long, lRow As Long) As Variant@@@        @w’èƒZƒ‹ƒeƒLƒXƒgæ“¾@@@@@@@@@@@@@@@@@@@      w’èƒZƒ‹ƒeƒLƒXƒgæ“¾
' ¡  PPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPP
'¡ 
' ¡ ¡ ¡ ¡ ¡ ¡ ¡ ¡ ¡ ¡ ¡ ¡ ¡ ¡ ¡ ¡ ¡ ¡ ¡ ¡ ¡ ¡ ¡ ¡ ¡ ¡ ¡ ¡ ¡ ¡ ¡


'‹¤’ÊƒRƒ}ƒ“ƒhƒ‰ƒCƒ“
Public CentCommandLine As String

Public objSession      As Object       '¾¯¼®İµÌŞ¼Şª¸Ä
Public odbDatabase     As Object       'ÃŞ°ÀÍŞ°½µÌŞ¼Şª¸Ä
Public oSQLStmt        As Object
Public odnsTable       As Object       'µ×¸ÙÃŞ°ÀÍŞ°½ÀŞ²Å¾¯Ä

Public gstrCommandLine() As String     '‹¤’ÊºÏİÄŞ×²İ‚ğ•ªŠ„‚µ‚½“à—e‚ğŠi”[‚µ‚½”z—ñ

'ºİ½ÀİÄ‹Lq
Global Const gcnsstrKugiri = "|"

'*********************************************************************************************
'*@@è‘±‚«–¼F@ƒtƒ‹Œ…’Eo
'*@@ˆø@”@F@ˆø”‚PiÃ·½ÄÎŞ¯¸½µÌŞ¼Şª¸Äj
'*@@@@@@@@ˆø”‚Qiˆø”‚P‚ÌMAX Lengthj
'*@@‹@”\ŠT—vF@ˆø”‚P‚Åw’è‚³‚ê‚½Ã·½ÄÎŞ¯¸½µÌŞ¼Şª¸Ä‚Ì“ü—Í’l‚ªˆø”‚Q‚É’B‚µ‚½ê‡
'*@@@@@@@@Ÿ‚Ì“ü—Í€–Ú‚ÖÌ«°¶½‚ğˆÚ“®‚·‚é
'*********************************************************************************************
Public Sub gsubMaxCharSkipEX(txtTmp As TextBox, lngMaxLength As Long)
Dim strText    As String

    strText = StrConv(txtTmp.Text, vbFromUnicode)
    
    If LenB(strText) = lngMaxLength Then
        SendKeys Chr$(9), True
    End If
    
End Sub

'*********************************************************************************************
'*@@è‘±‚«–¼F@ƒn[ƒhƒRƒs[
'*@@ˆø@”@F@‚È‚µ
'*@@‹@”\ŠT—vF@‰æ–Ê‚Ìƒn[ƒhƒRƒs[‚ğo—Í‚·‚é
'*********************************************************************************************
Public Sub gsubQSAV_ActX1001()
Dim clsApp As Object
    
    Set clsApp = CreateObject("QSAV_ActX1001.ActX1001C")
    
    Call clsApp.subQSAV_ActX1001
    
    Set clsApp = Nothing
    
End Sub

'*********************************************************************************************
'*@@è‘±‚«–¼F@ƒXƒe[ƒ^ƒXƒo[‚ğ‰Šú‰»
'*@@ˆø@”@F@ˆø”‚P@ƒXƒe[ƒ^ƒXƒo[ƒIƒuƒWƒFƒNƒg
'*@@‹@”\ŠT—vF@ƒIƒyƒŒ[ƒ^–¼AƒRƒ“ƒsƒ…[ƒ^–¼‚ğ•\¦
'*********************************************************************************************
Public Sub gsubInitStatusBar(objStb As StatusBar)
    
    '‘æ‚Qƒpƒlƒ‹FƒIƒyƒŒ[ƒ^–¼‚ğ•\¦
    objStb.Panels.Item(2).Text = gstrCommandLine(2)
    
    '‘æ‚Rƒpƒlƒ‹FƒRƒ“ƒsƒ…[ƒ^–¼‚ğ•\¦
    objStb.Panels.Item(3).Text = gstrCommandLine(5)
    
End Sub

'*********************************************************************************************
'*@@è‘±‚«–¼F@ƒRƒ}ƒ“ƒhƒ‰ƒCƒ“‚Ì€–Úæ“¾
'*@@ˆø@”@F@ˆø”‚PiºÏİÄŞ×²İ‚É‚Äæ“¾‚µ‚½“à—ej
'*@@‹@”\ŠT—vF@ˆø”‚P‚Åw’è‚³‚ê‚½“à—e‚ğ€–Ú’PˆÊ‚É”z—ñ‚ÉŠi”[‚·‚é
'*********************************************************************************************
Public Sub gsubGetCommandLine(strCmdLine As String)
Dim lngCount    As Long
Dim lngStart    As Long
Dim lngLen      As Long
Dim lngStrLen   As Long
    
    lngCount = -1
    
    Do
        lngCount = lngCount + 1
        
        '”z—ñÄİ’è
        ReDim Preserve gstrCommandLine(lngCount)
        
        lngStart = lngLen
        
        '•¶š—ñ”äŠr
        lngLen = InStr(lngStart + 1, strCmdLine, ",")
        
        'ÅI€–Ú‚Ìê‡
        If lngLen = 0 Then
            gstrCommandLine(lngCount) = Mid$(strCmdLine, (lngStart + 1))
            Exit Do
        Else
            lngStrLen = (lngLen - (lngStart + 1))
            gstrCommandLine(lngCount) = Mid$(strCmdLine, (lngStart + 1), lngStrLen)
        End If
    Loop
    
End Sub

'*********************************************************************************************
'*@@ŠÖ”–¼@F@ƒGƒ‰[ƒtƒH[ƒ€‚Ì“ú•tEŠÔ‚ğæ“¾‚·‚é
'*@@ˆø@”@F@‚È‚µ
'*@@Œ‹@‰Ê@F@æ“¾‚µ‚½“ú•tEŠÔ
'*@@‹@”\ŠT—vF@ƒGƒ‰[‚ª”­¶‚µ‚½ê‡Aê—p‚ÌÌ«°Ñ‚É“ú•tEŠÔ‚ğ•\¦‚·‚é
'*********************************************************************************************
Public Function gstrGetErrDateFormat() As String
    
    gstrGetErrDateFormat = Format$(Date, "yyyy-mm-dd") & " " & Format$(Time, "hh-nn-ss")
    
End Function

'*********************************************************************************************
'*@@ŠÖ”–¼@F@ÃŞ°À•¶š—ñ•ÏŠ·
'*@@ˆø@”@F@ˆø”‚PiÃŞ°À“à—ej
'*@@Œ‹@‰Ê@F@ˆø”‚ğ•¶š—ñ•ÏŠ·‚µ‚½Œ‹‰Ê
'*@@‹@”\ŠT—vF@ˆø”‚ğ•¶š—ñ‚É•ÏŠ·‚·‚éB
'*********************************************************************************************
Public Function gstrChange(vData As Variant) As String
    
    gstrChange = ""
    
    If Not IsNull(vData) Then
        gstrChange = Trim$(CStr(vData))
    End If
    
End Function

'*********************************************************************************************
'*@@ŠÖ”–¼@F@•¶š—ñ‚`‚k‚k”’lÁª¯¸
'*@@ˆø@”@F@ˆø”‚Pi•¶š—ñj
'*@@Œ‹@‰Ê@F@booleanifalse¨´×°@true¨‘S‚Ä”’lj
'*@@‹@”\ŠT—vF@ˆø”‚Ì•¶š—ñ‚ª‘S‚Ä”’l‚©‚Ç‚¤‚©Áª¯¸‚·‚éB
'*********************************************************************************************
Public Function gblnfncIsNumberStr(strNumber As String) As Boolean
    Dim i As Integer, j As Integer
    Dim flg As Boolean
    
    gblnfncIsNumberStr = False
    
    If Len(strNumber) <= 0 Then
        Exit Function
    End If
    
    For i = 1 To Len(strNumber)
        flg = False
        
        For j = 0 To 9
            If Trim$(CStr(Mid$(strNumber, i, 1))) = Trim$(CStr(j)) Then
                flg = True
                Exit For
            End If
        Next j
        
        If Not flg Then
            Exit Function
        End If
        
    Next i
    
    gblnfncIsNumberStr = True
    
End Function

'*********************************************************************************************
'*@@ŠÖ”–¼@F@NullÁª¯¸
'*@@ˆø@”@F@ˆø”‚PiÊŞØ±İÄŒ^j
'*@@@@@@@@ˆø”‚Qiˆø”‚P‚ªNULL‚Ìê‡‚Ì½Íß°½”j
'*@@Œ‹@‰Ê@F@ˆø”‚P‚ªNULL‚ÌA½Íß°½‚ğ•Ô‚µA‚»‚êˆÈŠO‚ÍAˆø”‚P‚ğ•Ô‚·
'*@@‹@”\ŠT—vF@ˆø”‚P‚ªNULL‚©‚Ç‚¤‚©Áª¯¸‚µANULL‚Ìê‡Aˆø”‚Q‚Ì”‚Ì½Íß°½‚ğŒ‹‰Ê‚Æ‚µ‚Ä•Ô‚µA
'*@@@@@@@@ˆø”‚P‚ªNULLˆÈŠO‚Íˆø”‚P‚ğ•Ô‚·BA
'*********************************************************************************************
Public Function gstrCheckNull(vData As Variant, lngSpaceCount As Long) As String
    
    If IsNull(vData) Then
        gstrCheckNull = Space(lngSpaceCount)
    Else
        gstrCheckNull = Trim$(CStr(vData))
    End If
    
End Function

'*********************************************************************************************
'*@@ŠÖ”–¼@F@ƒeƒLƒXƒg‘I‘ğ
'*@@ˆø@”@F@objTxtBox As TextBox
'*@@Œ‹@‰Ê@F
'*@@‹@”\ŠT—vF@ƒeƒLƒXƒgƒ{ƒbƒNƒX“à‚ÌƒeƒLƒXƒg‚ğ‘I‘ğ‚µ‚½ó‘Ô‚É‚·‚é
'*@@”õl    : ŒÄ‚Ño‚µ—á) GotFocus ²ÍŞİÄÌßÛ¼°¼Ş¬‚É‚Ä
'*                   Call gsubSelectText(txtSyoriYY)
'*********************************************************************************************
Public Sub gsubSelectText(objTxtBox As TextBox)
    With objTxtBox
        .SelStart = 0
        .SelLength = Len(.Text)
    End With
End Sub

'*********************************************************************************************
'*@@ŠÖ”–¼@F@“ü—Í•¶š§Œä
'*@@ˆø@”@F@IntKeyAscii As Integer
'*@@@@@@@@StrEnaChr   As String  -- “ü—Í‰Â”\‚È•¶š
'*@@Œ‹@‰Ê@F@Ì¨ÙÀØİ¸ŞŒ‹‰Ê(Integer)
'*@@‹@”\ŠT—vF@“ü—Í•¶š§Œä‚ğs‚¤
'*@@”õl    : ŒÄ‚Ño‚µ—á) KeyPress ²ÍŞİÄÌßÛ¼°¼Ş¬‚É‚Ä
'*                   KeyAscii=gIntFilterKey(KeyAscii,"1234567890")
'*********************************************************************************************
Function gIntFilterKey(IntKeyAscii As Integer, StrEnaChr As String) As Integer
    
    IntKeyAscii = Asc(UCase(Chr(IntKeyAscii)))
    Select Case IntKeyAscii
        Case vbKeyBack ',vbKeyTab,  vbKeyDelete
        Case Asc("C") - 64, Asc("V") - 64, Asc("X") - 64
        Case Else
            If InStr(StrEnaChr, Chr(IntKeyAscii)) = 0 Then
                IntKeyAscii = 0
            End If
    End Select
    gIntFilterKey = IntKeyAscii
    
End Function

'*********************************************************************************************
'*@@ŠÖ”–¼@F@µ×¸Ù¾¯¼®İ‚Ìì¬
'*@@ˆø@”@F@‚È‚µ
'*@@Œ‹@‰Ê@F@boolean (false¨´×°@ , true¨³íj
'*@@‹@”\ŠT—vF@µ×¸Ù‚Ì¾¯¼®İµÌŞ¼Şª¸Ä‚ğì¬‚·‚é
'*********************************************************************************************
Public Function gblnCreateOracleSession() As Boolean
    
    On Error GoTo ErrExec
    
    'ƒZƒbƒVƒ‡ƒ“Šm—§
    Set objSession = CreateObject("OracleInprocServer.XOraSession")
    
    '³í
    gblnCreateOracleSession = True
    
Exit Function
ErrExec:
    
    'ƒGƒ‰[”­¶
    gblnCreateOracleSession = False
    
End Function

'*********************************************************************************************
'*@@ŠÖ”–¼@F@ÃŞ°ÀÍŞ°½‚ÌÚ‘±
'*@@ˆø@”@F@ˆø”‚PiÕ°»Ş°IDj
'*@@@@@@@@ˆø”‚QiÊß½Ü°ÄŞj
'*@@Œ‹@‰Ê@F@boolean (false¨´×°@ , true¨³íj
'*@@‹@”\ŠT—vF@µ×¸Ù‚Öˆø”‚ÌÕ°»Ş°AÊß½Ü°ÄŞ‚ÅÚ‘±‚·‚é
'*********************************************************************************************
Public Function gblnConnectOracleDatabase(strConnectUserID As String _
    , strConnectPassword As String, strConnectString As String) As Boolean
    
    On Error GoTo ErrExec
    
    'ƒf[ƒ^ƒx[ƒX‚Ö‚ÌÚ‘±
    Set odbDatabase = objSession.OpenDatabase(strConnectString _
                    , (strConnectUserID & "/" & strConnectPassword), ORADB_DEFAULT)
    
    '³í
    gblnConnectOracleDatabase = True
    
Exit Function
ErrExec:
    
    'ƒGƒ‰[”­¶
    gblnConnectOracleDatabase = False
    
End Function

'*********************************************************************************************
'*@@è‘±‚«–¼F@µ×¸Ù¾¯¼®İ‚ÌØ’f
'*@@ˆø@”@F@‚È‚µ
'*@@‹@”\ŠT—vF@µ×¸Ù¾¯¼®İ‚ğŠJ•ú‚·‚é
'*********************************************************************************************
Public Sub gsubTermOracleDB()
    
    'ƒZƒbƒVƒ‡ƒ“‰ğ•ú
    Set odbDatabase = Nothing
    
    Set objSession = Nothing

End Sub

'*********************************************************************************************
'*@@ŠÖ”–¼@F@ÀŞ²Å¾¯Äì¬
'*@@ˆø@”@F@ˆø”‚PiµÌŞ¼Şª¸Äj
'*@@@@@@@@ˆø”‚QiSQL•¶Şj
'*@@Œ‹@‰Ê@F@boolean (false¨´×°@ , true¨³íj
'*@@‹@”\ŠT—vF@ˆø”‚P‚ÌµÌŞ¼Şª¸Ä‚Éˆø”‚Q‚ÌSQL•¶‚ğÀs‚µÀŞ²Å¾¯Ä‚ğì¬‚·‚é
'*********************************************************************************************
Public Function gblnOpenOracleTable(objTable As Object, strSQL As String) As Boolean
    
    On Error GoTo ErrExec
    
    'ƒe[ƒuƒ‹‚Ìæ“¾
    Set objTable = odbDatabase.CreateDynaset(strSQL, ORADYN_DEFAULT)
    
    '³í
    gblnOpenOracleTable = True
    
Exit Function
ErrExec:
    
    'ƒGƒ‰[”­¶
    gblnOpenOracleTable = False
    
End Function

'*********************************************************************************************
'*@@è‘±‚«–¼F@ƒIƒ‰ƒNƒ‹ƒGƒ‰[ƒƒbƒZ[ƒW•\¦
'*@@ˆø@”@F@ˆø”‚PiÌßÛ¸Ş×ÑIDj
'*@@@@@@@@ˆø”‚QiÌ«°Ñ–¼j
'*@@@@@@@@ˆø”‚RiÕ°»Ş°IDj
'*@@@@@@@@ˆø”‚Si’[––IDj
'*@@@@@@@@ˆø”‚TiŠÔj
'*@@‹@”\ŠT—vF@ˆø”‚P`‚T‚Ì“à—e‚Æ´×°“à—e‚ğ´×°Ò¯¾°¼ŞÌ«°Ñ‚ğ•\¦‚·‚é
'*********************************************************************************************
Public Sub gsubDBErrorMessage(strProgramID As String _
              , strFormName As String, strUserID As String _
              , strTanmatuID As String, strTime As String)
 Dim lngErrCode          As Long     '´×°º°ÄŞ
 Dim strErrDescription   As String   '´×°Ò¯¾°¼Ş

    'ƒGƒ‰[ˆ—
    If objSession.LastServerErr = 0 Then
        Select Case odbDatabase.LastServerErr
        Case 0  'VBƒGƒ‰[
            lngErrCode = Err.Number
            strErrDescription = Err.Description
        Case Is >= 20000
            'ƒ†[ƒUƒGƒ‰[ˆ—
            lngErrCode = odbDatabase.LastServerErr              '´×°º°ÄŞ
            strErrDescription = odbDatabase.LastServerErrText   '´×°Ò¯¾°¼Ş
            odbDatabase.LastServerErrReset                      '´×°Ø¾¯Ä
'            Exit Sub
        Case Else
            lngErrCode = odbDatabase.LastServerErr              '´×°º°ÄŞ
            strErrDescription = odbDatabase.LastServerErrText   '´×°Ò¯¾°¼Ş
            odbDatabase.LastServerErrReset                      '´×°Ø¾¯Ä
        End Select
    Else
        lngErrCode = objSession.LastServerErr               '´×°º°ÄŞ
        strErrDescription = objSession.LastServerErrText    '´×°Ò¯¾°¼Ş
        objSession.LastServerErrReset                       '´×°Ø¾¯Ä
    End If

    'ƒVƒXƒeƒ€ƒGƒ‰[
    Call QSAV_SysErr.subSysErr(strProgramID, strUserID, strTanmatuID, strTime _
                            , strFormName, CStr(lngErrCode), strErrDescription)

End Sub

'*********************************************************************************************
'*@@è‘±‚«–¼F@½Ä±°ÄŞÌßÛ¼°¼Ş¬‚ÌÊß×Ò°ÀŠJ•ú
'*@@ˆø@”@F@ˆø”‚PiÃŞ°ÀÍŞ°½µÌŞ¼Şª¸Äj
'*@@‹@”\ŠT—vF@½Ä±°ÄŞÌßÛ¼°¼Ş¬‚ÌÊß×Ò°À‚ğ‘S‚ÄŠJ•ú‚·‚é
'*********************************************************************************************
Public Sub gsubParaRemove(objDatabase As Object)
    
    With objDatabase
        Do While .Parameters.Count > 0
            .Parameters.Remove (0)
        Loop
    End With
    
End Sub

'*********************************************************************************************
'*@@ŠÖ”–¼@F@ƒR[ƒhƒe[ƒuƒ‹–¼Ìæ“¾
'*@@ˆø@”@F@ˆø”‚PiµÌŞ¼Şª¸Äj
'*@@@@@@@@ˆø”‚Qiº°ÄŞ‡‚j
'*@@@@@@@@ˆø”‚Riº°ÄŞ‹æ•ªj
'*@@Œ‹@‰Ê@F@º°ÄŞÃ°ÌŞÙiËŞ­°j‚Ì–¼Ì‚ğ•Ô‚·B‰Šú’l‚Íhh
'*@@‹@”\ŠT—vF@º°ÄŞÃ°ÌŞÙiËŞ­°j‚Ì–¼Ì‚ğæ“¾‚·‚éB
'*********************************************************************************************
Public Function gstrGetCodeMeisyo(odbDatabase As Object, vCodeNo As Variant, _
                                 strCodeKbn As String) As String
Dim strCodeNo   As String
Dim objTable    As Object
Dim lngRet      As Long
Dim strSQL      As String
    
    On Error GoTo GetCode_Error
    
    gstrGetCodeMeisyo = ""
    
    '•¶š—ñ•ÏŠ·
    strCodeNo = gstrCheckNull(vCodeNo, 0)
    
    '”»’è
    If strCodeNo = "" Then
        Exit Function
    End If
    
    'SQL•¶‚Ìì¬
    strSQL = gstrGetCodeTableSQL(strCodeNo, strCodeKbn)
    
    Set objTable = odbDatabase.CreateDynaset(strSQL, ORADYN_DEFAULT)
    
    'ƒe[ƒuƒ‹ƒI[ƒvƒ“
    If objTable Is Nothing Then
        Exit Function
    End If
    
    'ƒf[ƒ^æ“¾
    If Not objTable.EOF Then
        gstrGetCodeMeisyo = gstrCheckNull(objTable.Fields("QSA3_Mei").Value, 0)
    End If
    
    '‰ğ•ú
    Set objTable = Nothing
    
    Exit Function

GetCode_Error:

    
End Function

'*********************************************************************************************
'*@@ŠÖ”–¼@F@ƒR[ƒhƒe[ƒuƒ‹‚ÌSQL•¶ì¬
'*@@ˆø@”@F@ˆø”‚Piº°ÄŞ‡‚j
'*@@@@@@@@ˆø”‚Qiº°ÄŞ‹æ•ªj
'*@@Œ‹@‰Ê@F@ˆø”‚É‚Äì¬‚µ‚½SQL•¶
'*@@‹@”\ŠT—vF@ˆø”‚É‚Äº°ÄŞÃ°ÌŞÙQÆ‚ÌSQL•¶‚ğì¬‚·‚éB
'*********************************************************************************************
Public Function gstrGetCodeTableSQL(strCodeNo As String, strCodeKbn As String) As String
Dim strSQL As String
    
    'SQL•¶‚Ìì¬
    strSQL = "SELECT" _
        & " QSA3_Mei" _
        & " FROM" _
        & " QSA3_CodeV" _
        & " WHERE" _
        & " QSA3_PRMCodeKbn = '" & Trim$(strCodeKbn) & "'" _
        & " AND" _
        & " QSA3_PRMCodeNo = '" & Trim$(strCodeNo) & "'"
    
    gstrGetCodeTableSQL = strSQL
    
End Function

'*********************************************************************************************
'*@@è‘±‚«–¼F@º°ÄŞÃ°ÌŞÙ‚Ì–|–ó’l‚ğ”z—ñ‚ÉŠi”[
'*@@ˆø@”@F@ˆø”‚Piº°ÄŞ‹æ•ªj
'*@@‹@”\ŠT—vF@º°ÄŞÃ°ÌŞÙ‚Ì–|–ó’l‚ğ”z—ñ‚ÉŠi”[‚·‚éB
'*********************************************************************************************
Public Function gsubSetComboCode(strCode As String, strText() As String)
Dim objTable    As Object
Dim strSQL      As String
Dim lngIndex    As Long
    
    'SQL•¶‚Ìì¬
    strSQL = "SELECT" _
        & " QSA3_Mei" _
        & " FROM" _
        & " QSA3_CodeV" _
        & " WHERE" _
        & " QSA3_PRMCodeKbn = '" & Trim$(strCode) & "'"
    
    If Not gblnOpenOracleTable(objTable, strSQL) Then
        Exit Function
    End If
    
    If objTable.EOF And objTable.BOF Then
        Exit Function
    End If
    
    ReDim strText(objTable.RecordCount - 1)
    
    objTable.MoveFirst
    
    lngIndex = -1
    
    Do Until objTable.EOF
        lngIndex = lngIndex + 1
        
        strText(lngIndex) = objTable.Fields("QSA3_Mei").Value
        
        objTable.MoveNext
    Loop
    
    Set objTable = Nothing
    
End Function

'*********************************************************************************************
'*@@ŠÖ”–¼@F  ‹æØ‚è•¶š“ü‚èƒf[ƒ^•ª‰ğ
'*@@ˆø@”@F@strDlmData EEE ‹æØ‚è•¶š“ü‚èƒf[ƒ^
'*@@Œ‹@‰Ê@F@Ø‚èæ‚ç‚ê‚½æ“ª‚Ìƒf[ƒ^@^@c‚Á‚½ÃŞ°À(strDlmData‚ÉŠi”[)
'*@@‹@”\ŠT—vF@‹æØ‚è•¶š“ü‚è‚Ìƒf[ƒ^‚ğ•ª‰ğ‚·‚é@•ª‰ğ‚µ‚½ƒf[ƒ^‚ÍØ‚èÌ‚Ä‚é
'*********************************************************************************************
Public Function gfncstrDlm(strDlmData As String) As String
    
    If Right$(strDlmData, 1) <> "|" Then
        strDlmData = strDlmData & "|"
    End If
    
    gfncstrDlm = Mid$(strDlmData, 1, InStr(strDlmData, gcnsstrKugiri) - 1)
    strDlmData = Mid$(strDlmData, InStr(strDlmData, gcnsstrKugiri) + 1, Len(strDlmData))
    
End Function

'*********************************************************************************************
'*@@ŠÖ”–¼@F  ‹æØ‚è•¶š“ü‚èƒf[ƒ^•ª‰ğ(ˆÊ’uw’è—L‚è)
'*@@ˆø@”@F@strDlmData EEE ‹æØ‚è•¶š“ü‚èƒf[ƒ^
'*@@        @ lngPosEEEEEE Ø‚èæ‚èˆÊ’u
'*@@Œ‹@‰Ê@F@Ø‚èæ‚ç‚ê‚½ƒf[ƒ^
'*@@‹@”\ŠT—vF@‹æØ‚è•¶š“ü‚è‚Ìƒf[ƒ^‚æ‚èw’èˆÊ’u‚Ìƒf[ƒ^‚ğæ“¾‚·‚é
'*********************************************************************************************
Public Function gfncstrDlm2(ByVal strDlmData As String, lngPos As Long) As String
 Dim i As Long

    gfncstrDlm2 = ""

    For i = 1 To lngPos
        gfncstrDlm2 = gfncstrDlm(strDlmData)
    Next i
    
End Function

'*********************************************************************************************
'*@@è‘±‚«–¼F@½ÌßÚ¯ÄŞ¸Ø±ˆ—
'*@@ˆø‚«”@F@spd As vaSpread  -->  SpreadSheet
'*@@‹@”\ŠT—vF@w’è‚µ‚½½ÌßÚ¯ÄŞ¼°Ä‚Ì“à—e‚ğ¸Ø±‚·‚é
'*********************************************************************************************
Public Sub gsubSpdClear(spd As vaSpread)
Dim i   As Long
    
    With spd
        .ReDraw = False
        .Row = -1
'        .Row2 = .MaxRows
        .Col = -1
'        .Col2 = .MaxCols
        .BlockMode = True
        .Action = SS_ACTION_CLEAR_TEXT
        .BlockMode = False
        
        For i = 1 To .MaxRows
            .SelModeSelected = False
        Next
        
        .ReDraw = True
        
    End With
    
End Sub

'*********************************************************************************************
'*@@ŠÖ”–¼@F@ƒXƒvƒŒƒbƒh‚Éƒf[ƒ^‚ğƒZƒbƒg‚·‚é
'*@@ˆø‚«”@F ObjNm      As vaSpread -- SpreadSheet
'*              intCol     As Long     -- —ñ
'*              intRow     As Long     -- s
'*              varVal     As Variant
'*              strDefault As String
'*@@Œ‹@‰Ê@F@w’è‚µ‚½¾Ù‚Ì’l(Variant)
'*@@‹@”\ŠT—vF@SetTextÒ¿¯ÄŞ‚ğCall‚µAŒ‹‰ÊƒeƒLƒXƒg‚ğ•Ô‚·
'*********************************************************************************************
Public Sub gsubSetCellText(ByVal ObjNm As Object, intCol As Integer, ByVal intRow As Integer, varVal As Variant, Optional strDefault As String = "")
    
    With ObjNm
        If IsNull(varVal) Then
            .SetText intCol, intRow, strDefault
        Else
            .SetText intCol, intRow, CStr(varVal)
        End If
    End With
    
End Sub

'*********************************************************************************************
'*@@ŠÖ”–¼@F@w’è¾ÙÃ·½Äæ“¾
'*@@ˆø‚«”@F spd  As vaSpread -- SpreadSheet
'*              lCol As Long     -- —ñ
'*              lRow As Long     -- s
'*@@Œ‹@‰Ê@F@w’è‚µ‚½¾Ù‚Ì’l(Variant)
'*@@‹@”\ŠT—vF@GetTextÒ¿¯ÄŞ‚ğCall‚µAŒ‹‰ÊƒeƒLƒXƒg‚ğ•Ô‚·
'*********************************************************************************************
Public Function gVarSpdGetText(spd As vaSpread, lCol As Long, lRow As Long) As Variant
    Dim VarValue    As Variant
    
    gVarSpdGetText = ""

    If spd.GetText(lCol, lRow, VarValue) Then
        gVarSpdGetText = VarValue
    End If
    
End Function

