VERSION 5.00
Object = "{00025600-0000-0000-C000-000000000046}#5.2#0"; "Crystl32.OCX"
Object = "{831FDD16-0C5C-11D2-A9FC-0000F8754DA1}#2.0#0"; "MSCOMCTL.OCX"
Begin VB.Form frmQPAV_CEnt530 
   BorderStyle     =   1  'å≈íË(é¿ê¸)
   Caption         =   "ë›ïtã‡écçÇï\"
   ClientHeight    =   8580
   ClientLeft      =   495
   ClientTop       =   1515
   ClientWidth     =   14385
   BeginProperty Font 
      Name            =   "ÇlÇr ÉSÉVÉbÉN"
      Size            =   9.75
      Charset         =   128
      Weight          =   400
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   KeyPreview      =   -1  'True
   LinkTopic       =   "Form13"
   MaxButton       =   0   'False
   PaletteMode     =   1  'Z µ∞¿ﬁ∞
   ScaleHeight     =   8580
   ScaleWidth      =   14385
   Begin VB.OptionButton optKbn 
      Caption         =   "é–àıÉçÅ[ÉìécçÇï\"
      BeginProperty Font 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   360
      Index           =   0
      Left            =   6120
      TabIndex        =   25
      Top             =   2520
      Width           =   2775
   End
   Begin VB.OptionButton optKbn 
      Caption         =   "é–àıÉçÅ[ÉìécçÇàŸìÆÉäÉXÉg"
      BeginProperty Font 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   360
      Index           =   1
      Left            =   6120
      TabIndex        =   24
      Top             =   3105
      Width           =   2865
   End
   Begin VB.CommandButton cmdPrint 
      Caption         =   "àÍóóàÛç¸"
      BeginProperty Font 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   465
      Index           =   1
      Left            =   12960
      TabIndex        =   3
      Top             =   6630
      Width           =   1065
   End
   Begin VB.CommandButton cmdPrint 
      Caption         =   "ÉvÉåÉrÉÖÅ["
      BeginProperty Font 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   465
      Index           =   0
      Left            =   11790
      TabIndex        =   2
      Top             =   6630
      Width           =   1065
   End
   Begin VB.Frame Frame3 
      Appearance      =   0  'Ã◊Øƒ
      ForeColor       =   &H80000008&
      Height          =   945
      Left            =   90
      TabIndex        =   20
      Top             =   30
      Width           =   14250
      Begin Crystal.CrystalReport CrystalReport 
         Left            =   13650
         Top             =   270
         _ExtentX        =   741
         _ExtentY        =   741
         _Version        =   348160
         PrintFileLinesPerPage=   60
      End
      Begin VB.TextBox txtSyuturyokuM 
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   9
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   270
         Left            =   7717
         MaxLength       =   2
         TabIndex        =   1
         Top             =   360
         Width           =   330
      End
      Begin VB.TextBox txtSyuturyokuY 
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   9
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   270
         Left            =   6907
         MaxLength       =   4
         TabIndex        =   0
         Top             =   360
         Width           =   525
      End
      Begin VB.Label Label4 
         Alignment       =   1  'âEëµÇ¶
         AutoSize        =   -1  'True
         BackColor       =   &H00C00000&
         BackStyle       =   0  'ìßñæ
         Caption         =   "îN"
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   9
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   180
         Left            =   7462
         TabIndex        =   23
         Top             =   435
         Width           =   180
      End
      Begin VB.Label Label3 
         Alignment       =   1  'âEëµÇ¶
         AutoSize        =   -1  'True
         BackColor       =   &H00C00000&
         BackStyle       =   0  'ìßñæ
         Caption         =   "åé"
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   9
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   180
         Left            =   8092
         TabIndex        =   22
         Top             =   435
         Width           =   180
      End
      Begin VB.Label Label2 
         Alignment       =   1  'âEëµÇ¶
         AutoSize        =   -1  'True
         BackColor       =   &H00C00000&
         BackStyle       =   0  'ìßñæ
         Caption         =   "èoóÕîNåé"
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   9
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   180
         Left            =   5265
         TabIndex        =   21
         Top             =   435
         Width           =   1560
      End
   End
   Begin VB.PictureBox picPfMenu 
      Align           =   2  'â∫ëµÇ¶
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   8.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   585
      Left            =   0
      ScaleHeight     =   525
      ScaleWidth      =   14325
      TabIndex        =   19
      TabStop         =   0   'False
      Top             =   7620
      Width           =   14385
      Begin VB.CommandButton cmdPFK 
         Caption         =   "F1:“∆≠-"
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   9
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   1
         Left            =   60
         TabIndex        =   4
         Top             =   90
         Width           =   1155
      End
      Begin VB.CommandButton cmdPFK 
         Caption         =   "F2: ∞ƒﬁ∫Àﬂ∞"
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   9
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   2
         Left            =   1245
         TabIndex        =   5
         Top             =   90
         Width           =   1155
      End
      Begin VB.CommandButton cmdPFK 
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   3
         Left            =   2430
         TabIndex        =   9
         TabStop         =   0   'False
         Top             =   90
         Width           =   1155
      End
      Begin VB.CommandButton cmdPFK 
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   4
         Left            =   3615
         TabIndex        =   10
         TabStop         =   0   'False
         Top             =   90
         Width           =   1155
      End
      Begin VB.CommandButton cmdPFK 
         Caption         =   "F5:é¿çs"
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   9
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   5
         Left            =   4830
         TabIndex        =   6
         Top             =   90
         Width           =   1155
      End
      Begin VB.CommandButton cmdPFK 
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   6
         Left            =   6045
         TabIndex        =   11
         TabStop         =   0   'False
         Top             =   90
         Width           =   1155
      End
      Begin VB.CommandButton cmdPFK 
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   7
         Left            =   7200
         TabIndex        =   12
         TabStop         =   0   'False
         Top             =   90
         Width           =   1155
      End
      Begin VB.CommandButton cmdPFK 
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   8
         Left            =   8385
         TabIndex        =   13
         TabStop         =   0   'False
         Top             =   90
         Width           =   1155
      End
      Begin VB.CommandButton cmdPFK 
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   9
         Left            =   9570
         TabIndex        =   14
         TabStop         =   0   'False
         Top             =   90
         Width           =   1155
      End
      Begin VB.CommandButton cmdPFK 
         Caption         =   "F10:ëOâÊñ "
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   9
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   10
         Left            =   10755
         TabIndex        =   7
         Top             =   90
         Width           =   1155
      End
      Begin VB.CommandButton cmdPFK 
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   11
         Left            =   11955
         TabIndex        =   15
         TabStop         =   0   'False
         Top             =   90
         Width           =   1155
      End
      Begin VB.CommandButton cmdPFK 
         Caption         =   "F12:éÊè¡"
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   9
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   12
         Left            =   13140
         TabIndex        =   8
         Top             =   90
         Width           =   1155
      End
   End
   Begin VB.PictureBox picMsg 
      BackColor       =   &H00FFFFFF&
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   8.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   405
      Left            =   60
      ScaleHeight     =   345
      ScaleWidth      =   14220
      TabIndex        =   17
      TabStop         =   0   'False
      Top             =   7170
      Width           =   14280
      Begin VB.Label lblMsg 
         BackStyle       =   0  'ìßñæ
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H000000FF&
         Height          =   285
         Left            =   60
         TabIndex        =   18
         Top             =   60
         Width           =   12405
      End
   End
   Begin MSComctlLib.StatusBar stbSystem 
      Align           =   2  'â∫ëµÇ¶
      Height          =   375
      Left            =   0
      TabIndex        =   16
      Top             =   8205
      Width           =   14385
      _ExtentX        =   25374
      _ExtentY        =   661
      _Version        =   393216
      BeginProperty Panels {8E3867A5-8586-11D1-B16A-00C0F0283628} 
         NumPanels       =   5
         BeginProperty Panel1 {8E3867AB-8586-11D1-B16A-00C0F0283628} 
            AutoSize        =   1
            Object.Width           =   12894
            MinWidth        =   3528
         EndProperty
         BeginProperty Panel2 {8E3867AB-8586-11D1-B16A-00C0F0283628} 
            Object.Width           =   3351
            MinWidth        =   3351
            Text            =   "ïxémí Å@ëæòY"
            TextSave        =   "ïxémí Å@ëæòY"
         EndProperty
         BeginProperty Panel3 {8E3867AB-8586-11D1-B16A-00C0F0283628} 
            Object.Width           =   3881
            MinWidth        =   3881
            Text            =   "9999999999999999"
            TextSave        =   "9999999999999999"
         EndProperty
         BeginProperty Panel4 {8E3867AB-8586-11D1-B16A-00C0F0283628} 
            Style           =   6
            Alignment       =   1
            TextSave        =   "2021/03/30"
         EndProperty
         BeginProperty Panel5 {8E3867AB-8586-11D1-B16A-00C0F0283628} 
            Style           =   5
            Alignment       =   1
            TextSave        =   "15:07"
         EndProperty
      EndProperty
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
End
Attribute VB_Name = "frmQPAV_CEnt530"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit
'----------------------------------------------------------------------------------------------
'çXêVì˙ït  àƒåè/è·äQî‘çÜ      èCê≥óùóR
'20100225  0908047          ÉOÉãÅ[Évé–àıèÿèëë›ïtí†ï[å©íºÇµ2éü
'                           êVãKçÏê¨
'20100716  1004091          ÉOÉãÅ[Évé–àıë›ïtÇÃç¬å†è˜ìnÇ…î∫Ç§ÉVÉXÉeÉÄëŒâû
'                            ÅEé–àıÉçÅ[ÉìécçÇçáåvï\èoóÕí«â¡
'                            ÅEé–àıÉçÅ[ÉìécçÇàŸìÆÉäÉXÉgèoóÕí«â¡
'----------------------------------------------------------------------------------------------

'*****************************************************************************************
'äeÉtÉ@ÉìÉNÉVÉáÉìÉLÅ[ã@î\
'*****************************************************************************************
Private Sub cmdPFK_Click(Index As Integer)
    
    Select Case Index
        Case 1  'ÉÅÉjÉÖÅ[
            Unload Me
            Exit Sub
        Case 2  'ÉnÅ[ÉhÉRÉsÅ[
            Call gsubQSAV_ActX1001

        Case 5  'é¿çs
            blnRptToWindow = False
            Call subJikkou
        Case 10 'ëOâÊñ 
            Unload Me
            Exit Sub
        Case 12 'éÊè¡
            Call subFormInitialize
    End Select
    
End Sub

'*****************************************************************************************
'  àÛç¸Å^ÉvÉåÉrÉÖÅ[É{É^Éì
'*****************************************************************************************
Private Sub cmdPrint_Click(Index As Integer)
    
    If Index = 0 Then
        blnRptToWindow = True
    Else
        blnRptToWindow = False
    End If
    
    Call subJikkou

End Sub

'*****************************************************************************************
'  í†ï[èoóÕ
'*****************************************************************************************
Private Sub subJikkou()
    'ì¸óÕÉ`ÉFÉbÉN
    If funcChk = False Then
        Exit Sub
    End If
    'ÉfÅ[É^åüçıSP
    If funcSearch = False Then
        Exit Sub
    End If
    
    'ämîF
    If blnRptToWindow = True Then
        If MsgBox("ÉvÉåÉrÉÖÅ[ÇäJénÇµÇ‹Ç∑ÅBÇÊÇÎÇµÇ¢Ç≈Ç∑Ç©ÅH", vbQuestion + vbOKCancel, "êVÉOÉãÅ[Évé–àıë›ïtécçÇï\") = vbCancel Then
            Exit Sub
        End If
    Else
        If MsgBox("àÛç¸ÇäJénÇµÇ‹Ç∑ÅBÇÊÇÎÇµÇ¢Ç≈Ç∑Ç©ÅH", vbQuestion + vbOKCancel, "êVÉOÉãÅ[Évé–àıë›ïtécçÇï\") = vbCancel Then
            Exit Sub
        End If
    End If
    
    'èoóÕSP
    If funcSetWorkTable = False Then
        Exit Sub
    End If
    
    'ÉNÉäÉåÉ|
    If blnRptToWindow = True Then
    
        'MOD 20100716 1004091 IMZ NISHIKADO Start
        'Call subPrintReport1(crptToWindow)
        If optKbn(0).Value = True Then
            Call subPrintReport1(crptToWindow)          'é–àıÉçÅ[ÉìécçÇï\
            Call subPrintReport2(crptToWindow)          'é–àıÉçÅ[ÉìécçÇçáåvï\
        Else
            Call subPrintReport3(crptToWindow, "1")     'é–àıÉçÅ[ÉìécçÇàŸìÆÉäÉXÉgÅiì]ì¸Åj
            Call subPrintReport3(crptToWindow, "2")     'é–àıÉçÅ[ÉìécçÇàŸìÆÉäÉXÉgÅiì]èoÅj
        End If
        'MOD 20100716 1004091 IMZ NISHIKADO End
        
    Else
        
        'MOD 20100716 1004091 IMZ NISHIKADO Start
        'Call subPrintReport1(crptToPrinter)
        If optKbn(0).Value = True Then
            Call subPrintReport1(crptToPrinter)          'é–àıÉçÅ[ÉìécçÇï\
            Call subPrintReport2(crptToPrinter)          'é–àıÉçÅ[ÉìécçÇçáåvï\
        Else
            Call subPrintReport3(crptToPrinter, "1")     'é–àıÉçÅ[ÉìécçÇàŸìÆÉäÉXÉgÅiì]ì¸Åj
            Call subPrintReport3(crptToPrinter, "2")     'é–àıÉçÅ[ÉìécçÇàŸìÆÉäÉXÉgÅiì]èoÅj
        End If
        'MOD 20100716 1004091 IMZ NISHIKADO End
   
   End If
   
   'ADD 20100716 1004091 IMZ NISHIKADO Start
   'ÉGÉâÅ[ì‡óeÉNÉäÉA
   lblMsg.Caption = ""
   'ADD 20100716 1004091 IMZ NISHIKADO End

End Sub

'*************************************************************************************************
'*  ì¸óÕÉ`ÉFÉbÉN
'*************************************************************************************************
Private Function funcChk() As Boolean

    funcChk = False
    
    'èoóÕîNì¸óÕÉ`ÉFÉbÉN
    If Trim$(txtSyuturyokuY.Text) = "" Then
        'Msg = Ç™ì¸óÕÇ≥ÇÍÇƒÇ¢Ç‹ÇπÇÒÅB
        lblMsg.Caption = "WPOE01 èoóÕîNåé" & gstrGetCodeMeisyo(odbDatabase, "E01", "WPO")
        txtSyuturyokuY.BackColor = vbRed
        txtSyuturyokuY.Enabled = True
        txtSyuturyokuY.SetFocus
        Exit Function
    End If
    txtSyuturyokuY.Text = Format(txtSyuturyokuY.Text, "0000")
    
    'èoóÕåéì¸óÕÉ`ÉFÉbÉN
    If Trim$(txtSyuturyokuM.Text) = "" Then
        'Msg = Ç™ì¸óÕÇ≥ÇÍÇƒÇ¢Ç‹ÇπÇÒÅB
        lblMsg.Caption = "WPOE01 èoóÕîNåé" & gstrGetCodeMeisyo(odbDatabase, "E01", "WPO")
        txtSyuturyokuM.BackColor = vbRed
        txtSyuturyokuM.Enabled = True
        txtSyuturyokuM.SetFocus
        Exit Function
    End If
    txtSyuturyokuM.Text = Format(txtSyuturyokuM.Text, "00")
            
    If Not IsDate(txtSyuturyokuY.Text & "," & txtSyuturyokuM.Text & ",01") Then
        'Msg = ÇÕì˙ïtÇ≈ì¸óÕÇµÇƒâ∫Ç≥Ç¢ÅB
        lblMsg.Caption = "WPOE03 èoóÕîNåé" & gstrGetCodeMeisyo(odbDatabase, "E03", "WPO")
        txtSyuturyokuY.BackColor = vbRed
        txtSyuturyokuM.BackColor = vbRed
        txtSyuturyokuY.SetFocus
        Exit Function
    End If
    
    'ìñåéà»ç~ÇÕNG
    If Format(txtSyuturyokuY.Text & "/" & txtSyuturyokuM.Text, "YYYY/MM") >= Format(gdatSysDate, "YYYY/MM") Then
        'Msg = ìñåéà»ç~ÇÃì˙ïtÇÕì¸óÕÇ≈Ç´Ç‹ÇπÇÒÅB
        lblMsg.Caption = "WPOE48 " & gstrGetCodeMeisyo(odbDatabase, "E48", "WPO")
        txtSyuturyokuY.BackColor = vbRed
        txtSyuturyokuM.BackColor = vbRed
        txtSyuturyokuY.SetFocus
        Exit Function
    End If
        
    funcChk = True

End Function

'*************************************************************************************************
'*  ÉfÅ[É^åüçıSPåƒÇ—èoÇµ
'*************************************************************************************************
'*  ñﬂÇËíl  TrueÅFê¨å˜
'*          FalseÅFé∏îs/0åè
'*************************************************************************************************
Private Function funcSearch() As Boolean
    Dim strSQL               As String
    Dim strYMD               As String
    
    'ADD 20100716 1004091 IMZ NISHIKADO Start
    Dim strYMDZen            As String
    'ADD 20100716 1004091 IMZ NISHIKADO End

On Error GoTo errSPSet
    
    strYMD = Format(DateAdd("D", -1, DateSerial(txtSyuturyokuY.Text, txtSyuturyokuM.Text + 1, 1)), "YYYYMMDD")

    'ADD 20100716 1004091 IMZ NISHIKADO Start
    strYMDZen = Format(DateAdd("D", -1, DateSerial(txtSyuturyokuY.Text, txtSyuturyokuM.Text, 1)), "YYYYMMDD")
    'ADD 20100716 1004091 IMZ NISHIKADO End
    
    'ÇrÇo
    With odbDatabase.Parameters
        'èàóùì˙ït
        .Add "InStrYMD", strYMD, ORAPARM_INPUT
        .Item("InStrYMD").ServerType = ORATYPE_CHAR
        
        'ADD 20100716 1004091 IMZ NISHIKADO Start
        'èàóùì˙ïtÇÃëOåéññì˙
        odbDatabase.Parameters.Add "InStrYMDZen", strYMDZen, ORAPARM_INPUT
        odbDatabase.Parameters("InStrYMDZen").ServerType = ORATYPE_CHAR
        'ADD 20100716 1004091 IMZ NISHIKADO End
        
        'ëçåüçıåèêî
        .Add "OtNumRecCount", 0, ORAPARM_OUTPUT
        .Item("OtNumRecCount").ServerType = ORATYPE_NUMBER
    End With

    'ADD 20100716 1004091 IMZ NISHIKADO Start
    If optKbn(0).Value = True Then
    'ADD 20100716 1004091 IMZ NISHIKADO End
    
        'ÇrÇpÇkï™ÇÃçÏê¨
        strSQL = "BEGIN QPAP_CEnt530PkG.QPAP_CEnt530Search ("
        strSQL = strSQL & ":InStrYMD,"
        strSQL = strSQL & ":OtNumRecCount"
        strSQL = strSQL & "); END;"

    'ADD 20100716 1004091 IMZ NISHIKADO Start
    Else    'écçÇàŸìÆÉäÉXÉg
        'ëOåéññì˙
        'ÇrÇpÇkï™ÇÃçÏê¨
        strSQL = "BEGIN QPAP_CEnt530PkG.QPAP_CEnt530SearchIdou ("
        strSQL = strSQL & ":InStrYMD,"
        strSQL = strSQL & ":InStrYMDZen,"
        strSQL = strSQL & ":OtNumRecCount"
        strSQL = strSQL & "); END;"
    End If
    'ADD 20100716 1004091 IMZ NISHIKADO End
    
    'ÇrÇoÇÃé¿çs
    Call odbDatabase.DbexecuteSQL(strSQL)

    'ëçÉfÅ[É^åèêîÇ™ZEROÇÃÇ∆Ç´ÇÕÉGÉâÅ[
    If odbDatabase.Parameters("OtNumRecCount") = 0 Then
        'Msg = äYìñÉfÅ[É^Ç™ë∂ç›ÇµÇ‹ÇπÇÒÅB
        frmQPAV_CEnt530.lblMsg.Caption = "WPOE10 " & gstrGetCodeMeisyo(odbDatabase, "E10", "WPO")
        frmQPAV_CEnt530.txtSyuturyokuY.SetFocus
        Call gsubParaRemove(odbDatabase)
        Exit Function
    End If
    
    'ÉIÉuÉWÉFÉNÉgÇÃäJï˙
    Call gsubParaRemove(odbDatabase)

    funcSearch = True
       
    Exit Function

errSPSet:
'ÉGÉâÅ[èàóù

    'ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWï\é¶
    Call gsubDBErrorMessage(gstrCommandLine(8), gcstrPrjName, _
                           gstrCommandLine(3), gstrCommandLine(5), gstrGetErrDateFormat)
    'ÉIÉuÉWÉFÉNÉgÇÃäJï˙
    Call gsubParaRemove(odbDatabase)
    
End Function

'*************************************************************************************************
'*  ÉèÅ[ÉNÉeÅ[ÉuÉãÇ…ÉfÅ[É^ìoò^SPåƒÇ—èoÇµ
'*************************************************************************************************
'*  ñﬂÇËíl  TrueÅFê¨å˜
'*          FalseÅFé∏îs
'*************************************************************************************************
Private Function funcSetWorkTable() As Boolean
    Dim strSQL               As String
    Dim strYMD               As String
    
    'ADD 20100716 1004091 IMZ NISHIKADO Start
    Dim strYMDZen            As String
    'ADD 20100716 1004091 IMZ NISHIKADO End

    funcSetWorkTable = False
On Error GoTo errSPSet

    strYMD = Format(DateAdd("D", -1, DateSerial(txtSyuturyokuY.Text, txtSyuturyokuM.Text + 1, 1)), "YYYYMMDD")
    
    'ADD 20100716 1004091 IMZ NISHIKADO Start
    strYMDZen = Format(DateAdd("D", -1, DateSerial(txtSyuturyokuY.Text, txtSyuturyokuM.Text, 1)), "YYYYMMDD")
    'ADD 20100716 1004091 IMZ NISHIKADO End

    'ÇrÇo
    'èàóùì˙ït
    odbDatabase.Parameters.Add "InStrYMD", strYMD, ORAPARM_INPUT
    odbDatabase.Parameters("InStrYMD").ServerType = ORATYPE_CHAR
    
    'ADD 20100716 1004091 IMZ NISHIKADO Start
    'èàóùì˙ïtÇÃëOåéññì˙
    odbDatabase.Parameters.Add "InStrYMDZen", strYMDZen, ORAPARM_INPUT
    odbDatabase.Parameters("InStrYMDZen").ServerType = ORATYPE_CHAR
    'ADD 20100716 1004091 IMZ NISHIKADO End
    
    'ÉÜÅ[ÉUÅ[ÇhÇc
    odbDatabase.Parameters.Add "InStrUserID", gstrCommandLine(1), ORAPARM_INPUT
    odbDatabase.Parameters("InStrUserID").ServerType = ORATYPE_VARCHAR2
    'ÉRÉìÉsÉÖÅ[É^ñº
    odbDatabase.Parameters.Add "InStrComputerNM", gstrCommandLine(5), ORAPARM_INPUT
    odbDatabase.Parameters("InStrComputerNM").ServerType = ORATYPE_VARCHAR2

    'ADD 20100716 1004091 IMZ NISHIKADO Start
    If optKbn(0).Value = True Then
    'ADD 20100716 1004091 IMZ NISHIKADO End
        
        'ÇrÇpÇkï™ÇÃçÏê¨
        strSQL = "BEGIN QPAP_CEnt530PkG.QPAP_CEnt530SetWorkTable ("
        strSQL = strSQL & ":InStrYMD,:InStrUserID,:InStrComputerNM"
        strSQL = strSQL & "); END;"
        
    'ADD 20100716 1004091 IMZ NISHIKADO Start
    Else    'écçÇàŸìÆÉäÉXÉg
        'ëOåéññì˙
        strYMDZen = Format(DateAdd("D", -1, DateSerial(txtSyuturyokuY.Text, txtSyuturyokuM.Text, 1)), "YYYYMMDD")
        'ÇrÇpÇkï™ÇÃçÏê¨
        strSQL = "BEGIN QPAP_CEnt530PkG.QPAP_CEnt530SetWorkTableIdou ("
        strSQL = strSQL & ":InStrYMD,:InStrYMDZen,:InStrUserID,:InStrComputerNM"
        strSQL = strSQL & "); END;"
    End If
    'ADD 20100716 1004091 IMZ NISHIKADO End

    'ÇrÇoÇÃé¿çs
    Call odbDatabase.DbexecuteSQL(strSQL)

    'ÉIÉuÉWÉFÉNÉgÇÃäJï˙
    Call gsubParaRemove(odbDatabase)

    funcSetWorkTable = True
       
    Exit Function

errSPSet:
'ÉGÉâÅ[èàóù

    'ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWï\é¶
    Call gsubDBErrorMessage(gstrCommandLine(8), gcstrPrjName, _
                           gstrCommandLine(3), gstrCommandLine(5), gstrGetErrDateFormat)
    'ÉIÉuÉWÉFÉNÉgÇÃäJï˙
    Call gsubParaRemove(odbDatabase)
    
End Function

'**************************************************************************************************
'   Form_ActivateÉCÉxÉìÉg:ÉZÉbÉVÉáÉìÇÃämóß
'                        :ÉfÅ[É^ÉxÅ[ÉXämóß
'**************************************************************************************************
Private Sub Form_Activate()

    If blnLoadFlg Then

        DoEvents
        
        MousePointer = vbHourglass
        Me.Enabled = False
        
        'ÉIÉâÉNÉãÉZÉbÉVÉáÉìÇÃämóß
        If Not gblnCreateOracleSession() Then
            'ÉVÉXÉeÉÄÉGÉâÅ[
            Call QSAV_SysErr.subSysErr(gcstrPrjName, gstrCommandLine(1) _
                                    , gstrCommandLine(5), gstrGetErrDateFormat _
                                    , "êVë›ïtã‡écçÇï\ (" & gstrCommandLine(8) & ") " _
                                    , CStr(Err.Number), Err.Description)
            'èIóπ
            Unload Me
        End If
        
        'ÉIÉâÉNÉãÉfÅ[É^ÉxÅ[ÉXÇÃämóß
        If Not gblnConnectOracleDatabase(gstrCommandLine(3), gstrCommandLine(4) _
                                    , gstrCommandLine(0)) Then
            'ÉVÉXÉeÉÄÉGÉâÅ[
            Call QSAV_SysErr.subSysErr(gcstrPrjName, gstrCommandLine(1) _
                                    , gstrCommandLine(5), gstrGetErrDateFormat _
                                    , "êVë›ïtã‡écçÇï\ (" & gstrCommandLine(8) & ") " _
                                    , CStr(Err.Number), Err.Description)
            'èIóπ
            Unload Me
        End If
        
        'ÉTÅ[ÉoÅ[ì˙ïtéÊìæ
        Call gsubGetSysDate
        
        'âÊñ èâä˙âª
        Call subFormInitialize

    End If
    
    Me.Enabled = True
    MousePointer = vbDefault
    blnLoadFlg = False

End Sub

'**************************************************************************************************
'*FORM_KEYDOWN ÉtÉ@ÉìÉNÉVÉáÉìÉLÅ[ê›íË
'**************************************************************************************************
Private Sub Form_KeyDown(KeyCode As Integer, Shift As Integer)
    
    Select Case KeyCode
        Case vbKeyReturn   'Enter
            SendKeys "{TAB}"
        Case vbKeyF1   'F1
            Call cmdPFK_Click(1)
        Case vbKeyF2   'F2
            Call cmdPFK_Click(2)
        Case vbKeyF5   'F5
            If cmdPFK(5).Enabled = True Then
                Call cmdPFK_Click(5)
            End If
        Case vbKeyF10   'F10
            Call cmdPFK_Click(10)
        Case vbKeyF12   'F12
            Call cmdPFK_Click(12)
        Case vbKeyDelete    'DELÉLÅ[ÇâüÇµÇΩéû
            Call Form_KeyPress(46)
    End Select

End Sub

'**************************************
'*FORM_KEYPRESS
'**************************************
Private Sub Form_KeyPress(KeyAscii As Integer)
    'ENTER Beepâπè¡ãé
    Call subErrKaijo
        
    If KeyAscii = vbKeyReturn Then
        KeyAscii = 0
    End If

End Sub

'**************************************************************************************************
'*FormÉçÅ[Éh
'**************************************************************************************************
Private Sub Form_Load()
    
    Me.Caption = "êVë›ïtã‡écçÇï\ (" & gstrCommandLine(8) & ")"
    
    'ÉXÉeÅ[É^ÉXÉoÅ[ê›íË
    Call gsubInitStatusBar(stbSystem)
    
    'âÊñ èâä˙âª
    blnLoadFlg = True

End Sub

'**************************************************************************************************
'*Form Unload
'**************************************************************************************************
Private Sub Form_Unload(Cancel As Integer)

    'égópÉèÅ[ÉNÉeÅ[ÉuÉãëSçÌèú
    Call subDelWorkTbl
    
    'ADD 20100716 1004091 IMZ NISHIKADO Start
    'é–àıÉçÅ[ÉìécçÇàŸìÆÉäÉXÉgégópÉèÅ[ÉNÉeÅ[ÉuÉãçÌèú
    Call subDelWorkTblIdou
    'ADD 20100716 1004091 IMZ NISHIKADO End
  
    'µ◊∏ŸæØºÆ›ÇÃêÿíf
    Call gsubTermOracleDB
    
    Set frmQPAV_CEnt530 = Nothing
    
End Sub

'******************************************
'* ÉtÉHÅ[ÉJÉXéÊìæéûëSÉeÉLÉXÉgëIë
'******************************************
Private Sub txtSyuturyokum_GotFocus()
    Call gsubSelectText(txtSyuturyokuM)
End Sub

'******************************************
'*ì¸óÕï∂éöêßå‰ÅiêîéöÇÃÇ›Åj
'******************************************
Private Sub txtSyuturyokum_KeyPress(KeyAscii As Integer)
    KeyAscii = gIntFilterKey(KeyAscii, "1234567890")
End Sub

'******************************************
'* ÉtÉHÅ[ÉJÉXéÊìæéûëSÉeÉLÉXÉgëIë
'******************************************
Private Sub txtSyuturyokuY_GotFocus()
    Call gsubSelectText(txtSyuturyokuY)
End Sub

'******************************************
'*ì¸óÕï∂éöêßå‰ÅiêîéöÇÃÇ›Åj
'******************************************
Private Sub txtSyuturyokuY_KeyPress(KeyAscii As Integer)
    KeyAscii = gIntFilterKey(KeyAscii, "1234567890")
End Sub

'******************************************
'*ÉtÉãåÖíEèo
'******************************************
Private Sub txtSyuturyokuY_Change()
    Call gsubMaxCharSkipEX(txtSyuturyokuY, 4)
End Sub

'****************************************
'*ÉGÉâÅ[âèúèàóù
'****************************************
Private Sub subErrKaijo()

    lblMsg.Caption = ""
    stbSystem.Panels.Item(1).Text = ""
    txtSyuturyokuY.BackColor = vbWhite
    txtSyuturyokuM.BackColor = vbWhite

End Sub

'*************************************************************************************************
'* âÊñ èâä˙âª
'*************************************************************************************************
Private Sub subFormInitialize()

    txtSyuturyokuY.Text = ""
    txtSyuturyokuM.Text = ""

    'ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWóìÉNÉäÉA
    lblMsg.Caption = ""
    
    txtSyuturyokuY.Enabled = True
    txtSyuturyokuM.Enabled = True
    txtSyuturyokuY.BackColor = vbWhite
    txtSyuturyokuM.BackColor = vbWhite
    'ÉVÉXÉeÉÄåéÇÃëOåéÇ…ê›íË
    txtSyuturyokuY.Text = Format(DateAdd("m", -1, gdatSysDate), "yyyy")
    txtSyuturyokuM.Text = Format(DateAdd("m", -1, gdatSysDate), "MM")
    
    'ADD 20100716 1004091 IMZ NISHIKADO Start
    optKbn(0).Value = True
    'ADD 20100716 1004091 IMZ NISHIKADO End

    
End Sub

'ÉNÉäÉXÉ^ÉãÉåÉ|Å[Ég
Private Sub subPrintReport1(intDestinationConstants As DestinationConstants)

Dim strSelectionFormula As String
Dim strConectPoint      As String
Dim intRet              As Integer

Dim strMm              As String


    
    'ÉAÉNÉZÉXÇ∑ÇÈÉfÅ[É^ÉxÅ[ÉXÇ»Ç«ÇãLèq
    strConectPoint = "DSN = " & gstrCommandLine(0) & _
                    ";UID = " & gstrCommandLine(3) & _
                    ";PWD = " & gstrCommandLine(4)

    With CrystalReport
        'ÉNÉäÉXÉ^ÉãÉåÉ|Å[ÉgÇÃÉtÉ@ÉCÉãÇ™Ç†ÇÈèÍèäÇãLèqÇ∑ÇÈ
        .ReportFileName = App.Path & "\QPAV_CEnt530.rpt"
        .DiscardSavedData = True

        'ãLèqÇ≥ÇÍÇΩÉAÉNÉZÉXÉ|ÉCÉìÉgÇ…ê⁄ë±
        .Connect = strConectPoint

        'ÉçÉPÅ[ÉVÉáÉìÇÃê›íË
        .DataFiles(0) = Format$(gstrCommandLine(3), ">") & ".QPB4_NEWZANDAKAW"
        
        'ÉpÉâÉÅÅ[É^ÇãLèqÇ∑ÇÈ
'2021030013_é–àıÉçÅ[ÉìécçÇï\ MOD START 20210330
'        .Formulas(0) = "îNåé='" & Format$(txtSyuturyokuY.Text & "/" & txtSyuturyokuM.Text, "gggeeîNmmåéìx") & "'"
        .Formulas(0) = "îNåé='" & Format$(txtSyuturyokuY.Text & "/" & txtSyuturyokuM.Text, "yyyyîNmmåéìx") & "'"
'2021030013_é–àıÉçÅ[ÉìécçÇï\ MOD END 20210330
        
        'íäèoèåèÇãLèqÇ∑ÇÈ
        strSelectionFormula = "{QPB4_NEWZANDAKAW.QPB4_USERID} = '" & gstrCommandLine(1) & "'" _
                       & " AND {QPB4_NEWZANDAKAW.QPB4_COMPUTERNM} = '" & gstrCommandLine(5) & "'"
        'íäèoèåèÇãLèqÇ∑ÇÈ
        .SelectionFormula = strSelectionFormula
        
        'èoóÕêÊê›íË
        .Destination = intDestinationConstants

        'ÉvÉåÉrÉÖÅ[ÉEÉBÉìÉhÉEÇÃê›íË
        If intDestinationConstants = crptToWindow Then

            .WindowTitle = "êVë›ïtã‡écçÇï\ (" & gstrCommandLine(8) & ")"

            If Me.Top < 0 Then
                .WindowTop = 0
            Else
                .WindowTop = Me.Top / Screen.TwipsPerPixelY
            End If

            If Me.Left < 0 Then
                .WindowLeft = 0
            Else
                .WindowLeft = Me.Left / Screen.TwipsPerPixelX
            End If

            .WindowHeight = Me.Height / Screen.TwipsPerPixelY
            .WindowWidth = Me.Width / Screen.TwipsPerPixelX
        End If

        'ÉNÉäÉXÉ^ÉãÉåÉ|Å[ÉgÇé¿çsÇ∑ÇÈ
        intRet = .PrintReport

        Me.Enabled = True
        Me.MousePointer = vbDefault
        stbSystem.Panels.Item(1).Text = ""

        If intRet = 20545 Then
            Exit Sub
        ElseIf intRet <> 0 Then
            Call QSAV_SysErr.subSysErr(gcstrPrjName, gstrCommandLine(1) _
                                    , gstrCommandLine(5), gstrGetErrDateFormat() _
                                    , Me.Caption, CStr(.LastErrorNumber), .LastErrorString)
        End If
        .Reset
    End With
    
End Sub

'****************************************************************************************
'* égópÉèÅ[ÉNÉeÅ[ÉuÉãëSçÌèú
'****************************************************************************************
Private Sub subDelWorkTbl()
 Dim strSQL As String
 
 On Error GoTo errDelWorkTbl
 
    'ÉÜÅ[ÉUÅ[ÇhÇc
    odbDatabase.Parameters.Add "InStrUserID", gstrCommandLine(1), ORAPARM_INPUT
    odbDatabase.Parameters("InStrUserID").ServerType = ORATYPE_VARCHAR2
    'ÉRÉìÉsÉÖÅ[É^ñº
    odbDatabase.Parameters.Add "InStrComputerNM", gstrCommandLine(5), ORAPARM_INPUT
    odbDatabase.Parameters("InStrComputerNM").ServerType = ORATYPE_VARCHAR2

    strSQL = "BEGIN QPAP_CEnt530PkG.QPAP_CEnt530DelWorkTbl(" & _
             ":InStrUserID," & ":InStrComputerNM); END;"

    'ÉXÉgÉAÉhÉvÉçÉVÅ[ÉWÉÉãNìÆ
    odbDatabase.DbexecuteSQL (strSQL)

    If odbDatabase.LastServerErr <> 0 Then
        GoTo errDelWorkTbl
    End If
    
    'ÉIÉuÉWÉFÉNÉgÇÃäJï˙
    Call gsubParaRemove(odbDatabase)
    
    Exit Sub
    
errDelWorkTbl:
'ÉGÉâÅ[èàóù
    'ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWï\é¶
    Call gsubDBErrorMessage(gstrCommandLine(8), gcstrPrjName, _
                           gstrCommandLine(3), gstrCommandLine(5), gstrGetErrDateFormat)
    'ÉIÉuÉWÉFÉNÉgÇÃäJï˙
    Call gsubParaRemove(odbDatabase)
End Sub

'ADD 20100716 1004091 IMZ NISHIKADO Start
'ÉNÉäÉXÉ^ÉãÉåÉ|Å[ÉgÅié–àıÉçÅ[ÉìécçÇçáåvï\èoóÕèàóùÅj
Private Sub subPrintReport2(intDestinationConstants As DestinationConstants)

Dim strSelectionFormula As String       'íäèoèåè
Dim strConectPoint      As String       'ÉAÉNÉZÉXÉ|ÉCÉìÉg
Dim intRet              As Integer      'ÉäÉ^Å[Éìíl

Dim strMm              As String        'îNåé
  
    'ÉAÉNÉZÉXÇ∑ÇÈÉfÅ[É^ÉxÅ[ÉXÇ»Ç«ÇãLèq
    strConectPoint = "DSN = " & gstrCommandLine(0) & _
                    ";UID = " & gstrCommandLine(3) & _
                    ";PWD = " & gstrCommandLine(4)

    With CrystalReport
        'ÉNÉäÉXÉ^ÉãÉåÉ|Å[ÉgÇÃÉtÉ@ÉCÉãÇ™Ç†ÇÈèÍèäÇãLèqÇ∑ÇÈ
        .ReportFileName = App.Path & "\QPAV_CEnt531.rpt"
        .DiscardSavedData = True

        'ãLèqÇ≥ÇÍÇΩÉAÉNÉZÉXÉ|ÉCÉìÉgÇ…ê⁄ë±
        .Connect = strConectPoint

        'ÉçÉPÅ[ÉVÉáÉìÇÃê›íË
        .DataFiles(0) = Format$(gstrCommandLine(3), ">") & ".QPB4_NEWZANDAKAW"
        
        'ÉpÉâÉÅÅ[É^ÇãLèqÇ∑ÇÈ
'2021030013_é–àıÉçÅ[ÉìécçÇï\ MOD START 20210330
'        .Formulas(0) = "îNåé='" & Format$(txtSyuturyokuY.Text & "/" & txtSyuturyokuM.Text, "gggeeîNmmåéìx") & "'"
        .Formulas(0) = "îNåé='" & Format$(txtSyuturyokuY.Text & "/" & txtSyuturyokuM.Text, "yyyyîNmmåéìx") & "'"
'2021030013_é–àıÉçÅ[ÉìécçÇï\ MOD END 20210330
        
        'íäèoèåèÇãLèqÇ∑ÇÈ
        strSelectionFormula = "{QPB4_NEWZANDAKAW.QPB4_USERID} = '" & gstrCommandLine(1) & "'" _
                       & " AND {QPB4_NEWZANDAKAW.QPB4_COMPUTERNM} = '" & gstrCommandLine(5) & "'"
        'íäèoèåèÇãLèqÇ∑ÇÈ
        .SelectionFormula = strSelectionFormula
        
        'èoóÕêÊê›íË
        .Destination = intDestinationConstants

        'ÉvÉåÉrÉÖÅ[ÉEÉBÉìÉhÉEÇÃê›íË
        If intDestinationConstants = crptToWindow Then

            .WindowTitle = "êVë›ïtã‡écçÇï\ (" & gstrCommandLine(8) & ")"

            If Me.Top < 0 Then
                .WindowTop = 0
            Else
                .WindowTop = Me.Top / Screen.TwipsPerPixelY
            End If

            If Me.Left < 0 Then
                .WindowLeft = 0
            Else
                .WindowLeft = Me.Left / Screen.TwipsPerPixelX
            End If

            .WindowHeight = Me.Height / Screen.TwipsPerPixelY
            .WindowWidth = Me.Width / Screen.TwipsPerPixelX
        End If

        'ÉNÉäÉXÉ^ÉãÉåÉ|Å[ÉgÇé¿çsÇ∑ÇÈ
        intRet = .PrintReport

        Me.Enabled = True
        Me.MousePointer = vbDefault
        stbSystem.Panels.Item(1).Text = ""

        If intRet = 20545 Then
            Exit Sub
        ElseIf intRet <> 0 Then
            Call QSAV_SysErr.subSysErr(gcstrPrjName, gstrCommandLine(1) _
                                    , gstrCommandLine(5), gstrGetErrDateFormat() _
                                    , Me.Caption, CStr(.LastErrorNumber), .LastErrorString)
        End If
        .Reset
    End With
    
End Sub

'ÉNÉäÉXÉ^ÉãÉåÉ|Å[ÉgÅié–àıÉçÅ[ÉìécçÇàŸìÆÉäÉXÉgèoóÕèàóùÅj
Private Sub subPrintReport3(intDestinationConstants As DestinationConstants, strIdouKBN As String)

Dim strSelectionFormula As String       'íäèoèåè
Dim strConectPoint      As String       'ÉAÉNÉZÉXÉ|ÉCÉìÉg
Dim intRet              As Integer      'ÉäÉ^Å[Éìíl

Dim strMm              As String        'îNåé
   
    'ÉAÉNÉZÉXÇ∑ÇÈÉfÅ[É^ÉxÅ[ÉXÇ»Ç«ÇãLèq
    strConectPoint = "DSN = " & gstrCommandLine(0) & _
                    ";UID = " & gstrCommandLine(3) & _
                    ";PWD = " & gstrCommandLine(4)

    With CrystalReport
        'ÉNÉäÉXÉ^ÉãÉåÉ|Å[ÉgÇÃÉtÉ@ÉCÉãÇ™Ç†ÇÈèÍèäÇãLèqÇ∑ÇÈ
        .ReportFileName = App.Path & "\QPAV_CEnt532.rpt"
        .DiscardSavedData = True

        'ãLèqÇ≥ÇÍÇΩÉAÉNÉZÉXÉ|ÉCÉìÉgÇ…ê⁄ë±
        .Connect = strConectPoint

        'ÉçÉPÅ[ÉVÉáÉìÇÃê›íË
        .DataFiles(0) = Format$(gstrCommandLine(3), ">") & ".QPB7_ZNDKIDOUW"
        
        'ÉpÉâÉÅÅ[É^ÇãLèqÇ∑ÇÈ
'2021030013_é–àıÉçÅ[ÉìécçÇï\ MOD START 20210330
'        .Formulas(0) = "îNåé='" & Format$(txtSyuturyokuY.Text & "/" & txtSyuturyokuM.Text, "gggeeîNmmåéìx") & "'"
        .Formulas(0) = "îNåé='" & Format$(txtSyuturyokuY.Text & "/" & txtSyuturyokuM.Text, "yyyyîNmmåéìx") & "'"
'2021030013_é–àıÉçÅ[ÉìécçÇï\ MOD END 20210330
        .Formulas(1) = "àŸìÆãÊï™='" & strIdouKBN & "'"
        
        'íäèoèåèÇãLèqÇ∑ÇÈ
        strSelectionFormula = "{QPB7_ZNDKIDOUW.QPB7_IDOUKBN} = '" & strIdouKBN & "'" _
                       & " AND {QPB7_ZNDKIDOUW.QPB7_USERID} = '" & gstrCommandLine(1) & "'" _
                       & " AND {QPB7_ZNDKIDOUW.QPB7_COMPUTERNM} = '" & gstrCommandLine(5) & "'"
        'íäèoèåèÇãLèqÇ∑ÇÈ
        .SelectionFormula = strSelectionFormula
        
        'èoóÕêÊê›íË
        .Destination = intDestinationConstants

        'ÉvÉåÉrÉÖÅ[ÉEÉBÉìÉhÉEÇÃê›íË
        If intDestinationConstants = crptToWindow Then

            .WindowTitle = "êVë›ïtã‡écçÇï\ (" & gstrCommandLine(8) & ")"

            If Me.Top < 0 Then
                .WindowTop = 0
            Else
                .WindowTop = Me.Top / Screen.TwipsPerPixelY
            End If

            If Me.Left < 0 Then
                .WindowLeft = 0
            Else
                .WindowLeft = Me.Left / Screen.TwipsPerPixelX
            End If

            .WindowHeight = Me.Height / Screen.TwipsPerPixelY
            .WindowWidth = Me.Width / Screen.TwipsPerPixelX
        End If

        'ÉNÉäÉXÉ^ÉãÉåÉ|Å[ÉgÇé¿çsÇ∑ÇÈ
        intRet = .PrintReport

        Me.Enabled = True
        Me.MousePointer = vbDefault
        stbSystem.Panels.Item(1).Text = ""

        If intRet = 20545 Then
            Exit Sub
        ElseIf intRet <> 0 Then
            Call QSAV_SysErr.subSysErr(gcstrPrjName, gstrCommandLine(1) _
                                    , gstrCommandLine(5), gstrGetErrDateFormat() _
                                    , Me.Caption, CStr(.LastErrorNumber), .LastErrorString)
        End If
        .Reset
    End With
    
End Sub

'****************************************************************************************
'* é–àıÉçÅ[ÉìécçÇàŸìÆÉäÉXÉgégópÉèÅ[ÉNÉeÅ[ÉuÉãçÌèú
'****************************************************************************************
Private Sub subDelWorkTblIdou()
 Dim strSQL As String
 
 On Error GoTo errDelWorkTbl
 
    'ÉÜÅ[ÉUÅ[ÇhÇc
    odbDatabase.Parameters.Add "InStrUserID", gstrCommandLine(1), ORAPARM_INPUT
    odbDatabase.Parameters("InStrUserID").ServerType = ORATYPE_VARCHAR2
    'ÉRÉìÉsÉÖÅ[É^ñº
    odbDatabase.Parameters.Add "InStrComputerNM", gstrCommandLine(5), ORAPARM_INPUT
    odbDatabase.Parameters("InStrComputerNM").ServerType = ORATYPE_VARCHAR2

    strSQL = "BEGIN QPAP_CEnt530PkG.QPAP_CEnt530DelWorkTblIdou(" & _
             ":InStrUserID," & ":InStrComputerNM); END;"

    'ÉXÉgÉAÉhÉvÉçÉVÅ[ÉWÉÉãNìÆ
    odbDatabase.DbexecuteSQL (strSQL)

    If odbDatabase.LastServerErr <> 0 Then
        GoTo errDelWorkTbl
    End If
    
    'ÉIÉuÉWÉFÉNÉgÇÃäJï˙
    Call gsubParaRemove(odbDatabase)
    
    Exit Sub
    
errDelWorkTbl:
'ÉGÉâÅ[èàóù
    'ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWï\é¶
    Call gsubDBErrorMessage(gstrCommandLine(8), gcstrPrjName, _
                           gstrCommandLine(3), gstrCommandLine(5), gstrGetErrDateFormat)
    'ÉIÉuÉWÉFÉNÉgÇÃäJï˙
    Call gsubParaRemove(odbDatabase)
End Sub

'ADD 20100716 1004091 IMZ NISHIKADO End


