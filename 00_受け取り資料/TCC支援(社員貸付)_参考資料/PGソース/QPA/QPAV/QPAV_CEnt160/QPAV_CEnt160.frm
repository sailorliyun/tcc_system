VERSION 5.00
Object = "{B02F3647-766B-11CE-AF28-C3A2FBE76A13}#3.0#0"; "SPR32X30.ocx"
Object = "{831FDD16-0C5C-11D2-A9FC-0000F8754DA1}#2.0#0"; "MSCOMCTL.OCX"
Begin VB.Form frmQPAV_CEnt160 
   BorderStyle     =   1  'å≈íË(é¿ê¸)
   Caption         =   "çTèúíÜé~èàóù"
   ClientHeight    =   9435
   ClientLeft      =   180
   ClientTop       =   1095
   ClientWidth     =   14385
   BeginProperty Font 
      Name            =   "ÇlÇr ÉSÉVÉbÉN"
      Size            =   9.75
      Charset         =   128
      Weight          =   400
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   KeyPreview      =   -1  'True
   LinkTopic       =   "Form13"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   PaletteMode     =   1  'Z µ∞¿ﬁ∞
   ScaleHeight     =   9435
   ScaleWidth      =   14385
   StartUpPosition =   2  'âÊñ ÇÃíÜâõ
   Begin VB.OptionButton optKoujo 
      Caption         =   "çTèúÇµÇ»Ç¢"
      Height          =   825
      Index           =   0
      Left            =   5400
      Style           =   1  '∏ﬁ◊Ã®Ø∏Ω
      TabIndex        =   4
      Top             =   6360
      Width           =   1545
   End
   Begin VB.OptionButton optKoujo 
      Caption         =   "çTèúÇ∑ÇÈ"
      Height          =   825
      Index           =   1
      Left            =   7140
      Style           =   1  '∏ﬁ◊Ã®Ø∏Ω
      TabIndex        =   5
      Top             =   6360
      Value           =   -1  'True
      Width           =   1545
   End
   Begin VB.CommandButton cmdExec 
      Caption         =   "çXêV"
      Height          =   495
      Left            =   150
      TabIndex        =   6
      Top             =   7440
      Width           =   1065
   End
   Begin VB.Frame Frame1 
      Appearance      =   0  'Ã◊Øƒ
      ForeColor       =   &H80000008&
      Height          =   1365
      Left            =   120
      TabIndex        =   23
      Top             =   30
      Width           =   14190
      Begin VB.TextBox txtSyainCD1 
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   9
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   270
         IMEMode         =   3  'µÃå≈íË
         Left            =   1950
         MaxLength       =   1
         TabIndex        =   0
         Top             =   300
         Width           =   285
      End
      Begin VB.CommandButton cmdNayose 
         Caption         =   "ñºäÒÇπ"
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   9
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   345
         Left            =   3390
         TabIndex        =   2
         Top             =   270
         Width           =   1455
      End
      Begin VB.TextBox txtSyainCD2 
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   9
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   270
         IMEMode         =   3  'µÃå≈íË
         Left            =   2280
         MaxLength       =   7
         TabIndex        =   1
         Top             =   300
         Width           =   1005
      End
      Begin VB.Label Label1 
         Alignment       =   1  'âEëµÇ¶
         AutoSize        =   -1  'True
         BackColor       =   &H00C00000&
         BackStyle       =   0  'ìßñæ
         Caption         =   "éëäi"
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   9
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   180
         Index           =   1
         Left            =   10650
         TabIndex        =   42
         Top             =   300
         Width           =   360
      End
      Begin VB.Label Label1 
         Alignment       =   1  'âEëµÇ¶
         AutoSize        =   -1  'True
         BackColor       =   &H00C00000&
         BackStyle       =   0  'ìßñæ
         Caption         =   "ãâ"
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   9
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   180
         Index           =   2
         Left            =   10800
         TabIndex        =   41
         Top             =   630
         Width           =   180
      End
      Begin VB.Label Label1 
         Alignment       =   1  'âEëµÇ¶
         AutoSize        =   -1  'True
         BackColor       =   &H00C00000&
         BackStyle       =   0  'ìßñæ
         Caption         =   "ê∂îNåéì˙"
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   9
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   180
         Index           =   3
         Left            =   10320
         TabIndex        =   40
         Top             =   990
         Width           =   720
      End
      Begin VB.Label lblShikaku 
         Caption         =   "010"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   9
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   195
         Left            =   11250
         TabIndex        =   39
         Top             =   300
         Width           =   795
      End
      Begin VB.Label lblKyu 
         Caption         =   "010"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   9
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   195
         Left            =   11250
         TabIndex        =   38
         Top             =   630
         Width           =   795
      End
      Begin VB.Label lblSeinengappi 
         Caption         =   "010"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   9
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   195
         Left            =   11250
         TabIndex        =   37
         Top             =   960
         Width           =   2775
      End
      Begin VB.Label lblBumon 
         Caption         =   "±±±±±±±±±±±±±±±±±±±±±±±±"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   9
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   165
         Index           =   1
         Left            =   7350
         TabIndex        =   36
         Top             =   990
         Width           =   2385
      End
      Begin VB.Label lblBumon 
         Caption         =   "999999"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   9
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   165
         Index           =   0
         Left            =   6660
         TabIndex        =   35
         Top             =   990
         Width           =   585
      End
      Begin VB.Label Label15 
         Alignment       =   1  'âEëµÇ¶
         AutoSize        =   -1  'True
         BackColor       =   &H00C00000&
         BackStyle       =   0  'ìßñæ
         Caption         =   "èäëÆïîñÂ"
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   9
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   180
         Left            =   5670
         TabIndex        =   34
         Top             =   1020
         Width           =   720
      End
      Begin VB.Label lblTozai 
         Caption         =   "9"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   9
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   165
         Left            =   6660
         TabIndex        =   33
         Top             =   660
         Width           =   405
      End
      Begin VB.Label Label13 
         Alignment       =   1  'âEëµÇ¶
         AutoSize        =   -1  'True
         BackColor       =   &H00C00000&
         BackStyle       =   0  'ìßñæ
         Caption         =   "ìåêºãÊï™"
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   9
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   180
         Left            =   5670
         TabIndex        =   32
         Top             =   660
         Width           =   720
      End
      Begin VB.Label lblShozoku 
         Caption         =   "±±±±±±±±±±±±±±±±±±±±±±±±"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   9
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   195
         Index           =   1
         Left            =   7380
         TabIndex        =   31
         Top             =   300
         Width           =   2775
      End
      Begin VB.Label lblShozoku 
         Caption         =   "010"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   9
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   195
         Index           =   0
         Left            =   6660
         TabIndex        =   30
         Top             =   300
         Width           =   315
      End
      Begin VB.Label Label4 
         Alignment       =   1  'âEëµÇ¶
         AutoSize        =   -1  'True
         BackColor       =   &H00C00000&
         BackStyle       =   0  'ìßñæ
         Caption         =   "èäëÆìX"
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   9
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   180
         Index           =   1
         Left            =   5820
         TabIndex        =   29
         Top             =   300
         Width           =   540
      End
      Begin VB.Label lblShimei 
         Caption         =   "Ç†Ç†Ç†Ç†Ç†Å@Ç†Ç†Ç†Ç†Ç†"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   9
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   165
         Left            =   1950
         TabIndex        =   28
         Top             =   990
         Width           =   2235
      End
      Begin VB.Label lblKana 
         Caption         =   "±±±±±±±±±±±±±±±±±±±±"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   9
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   165
         Left            =   1980
         TabIndex        =   27
         Top             =   720
         Width           =   2235
      End
      Begin VB.Label Label1 
         Alignment       =   1  'âEëµÇ¶
         AutoSize        =   -1  'True
         BackColor       =   &H00C00000&
         BackStyle       =   0  'ìßñæ
         Caption         =   "é–àıéÅñº"
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   9
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   180
         Index           =   4
         Left            =   1080
         TabIndex        =   26
         Top             =   870
         Width           =   720
      End
      Begin VB.Label Label1 
         Alignment       =   1  'âEëµÇ¶
         AutoSize        =   -1  'True
         BackColor       =   &H00C00000&
         BackStyle       =   0  'ìßñæ
         Caption         =   "é–àıÉRÅ[Éh"
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   9
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   180
         Index           =   0
         Left            =   1050
         TabIndex        =   24
         Top             =   360
         Width           =   810
      End
   End
   Begin VB.PictureBox picPfMenu 
      Align           =   2  'â∫ëµÇ¶
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   8.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   585
      Left            =   0
      ScaleHeight     =   525
      ScaleWidth      =   14325
      TabIndex        =   22
      TabStop         =   0   'False
      Top             =   8475
      Width           =   14385
      Begin VB.CommandButton cmdPFK 
         Caption         =   "F1:“∆≠-"
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   9
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   1
         Left            =   60
         TabIndex        =   7
         Top             =   90
         Width           =   1155
      End
      Begin VB.CommandButton cmdPFK 
         Caption         =   "F2: ∞ƒﬁ∫Àﬂ∞"
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   9
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   2
         Left            =   1245
         TabIndex        =   8
         Top             =   90
         Width           =   1155
      End
      Begin VB.CommandButton cmdPFK 
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   3
         Left            =   2430
         TabIndex        =   12
         TabStop         =   0   'False
         Top             =   90
         Width           =   1155
      End
      Begin VB.CommandButton cmdPFK 
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   4
         Left            =   3615
         TabIndex        =   13
         TabStop         =   0   'False
         Top             =   90
         Width           =   1155
      End
      Begin VB.CommandButton cmdPFK 
         Caption         =   "F5:é¿çs"
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   9
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   5
         Left            =   4830
         TabIndex        =   9
         Top             =   90
         Width           =   1155
      End
      Begin VB.CommandButton cmdPFK 
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   6
         Left            =   6015
         TabIndex        =   14
         TabStop         =   0   'False
         Top             =   90
         Width           =   1155
      End
      Begin VB.CommandButton cmdPFK 
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   7
         Left            =   7200
         TabIndex        =   15
         TabStop         =   0   'False
         Top             =   90
         Width           =   1155
      End
      Begin VB.CommandButton cmdPFK 
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   8
         Left            =   8385
         TabIndex        =   16
         TabStop         =   0   'False
         Top             =   90
         Width           =   1155
      End
      Begin VB.CommandButton cmdPFK 
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   9
         Left            =   9570
         TabIndex        =   17
         TabStop         =   0   'False
         Top             =   90
         Width           =   1155
      End
      Begin VB.CommandButton cmdPFK 
         Caption         =   "F10:ëOâÊñ "
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   9
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   10
         Left            =   10755
         TabIndex        =   10
         Top             =   90
         Width           =   1155
      End
      Begin VB.CommandButton cmdPFK 
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   11
         Left            =   11955
         TabIndex        =   18
         TabStop         =   0   'False
         Top             =   90
         Width           =   1155
      End
      Begin VB.CommandButton cmdPFK 
         Caption         =   "F12:éÊè¡"
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   9
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   12
         Left            =   13140
         TabIndex        =   11
         Top             =   90
         Width           =   1155
      End
   End
   Begin VB.PictureBox picMsg 
      BackColor       =   &H00FFFFFF&
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   8.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   405
      Left            =   45
      ScaleHeight     =   345
      ScaleWidth      =   14220
      TabIndex        =   20
      TabStop         =   0   'False
      Top             =   7995
      Width           =   14280
      Begin VB.Label lblMsg 
         BackStyle       =   0  'ìßñæ
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H000000FF&
         Height          =   285
         Left            =   60
         TabIndex        =   21
         Top             =   60
         Width           =   12405
      End
   End
   Begin MSComctlLib.StatusBar stbSystem 
      Align           =   2  'â∫ëµÇ¶
      Height          =   375
      Left            =   0
      TabIndex        =   19
      Top             =   9060
      Width           =   14385
      _ExtentX        =   25374
      _ExtentY        =   661
      _Version        =   393216
      BeginProperty Panels {8E3867A5-8586-11D1-B16A-00C0F0283628} 
         NumPanels       =   5
         BeginProperty Panel1 {8E3867AB-8586-11D1-B16A-00C0F0283628} 
            AutoSize        =   1
            Object.Width           =   12894
            MinWidth        =   3528
         EndProperty
         BeginProperty Panel2 {8E3867AB-8586-11D1-B16A-00C0F0283628} 
            Object.Width           =   3351
            MinWidth        =   3351
            Text            =   "ïxémí Å@ëæòY"
            TextSave        =   "ïxémí Å@ëæòY"
         EndProperty
         BeginProperty Panel3 {8E3867AB-8586-11D1-B16A-00C0F0283628} 
            Object.Width           =   3881
            MinWidth        =   3881
            Text            =   "9999999999999999"
            TextSave        =   "9999999999999999"
         EndProperty
         BeginProperty Panel4 {8E3867AB-8586-11D1-B16A-00C0F0283628} 
            Style           =   6
            Alignment       =   1
            TextSave        =   "2005/06/16"
         EndProperty
         BeginProperty Panel5 {8E3867AB-8586-11D1-B16A-00C0F0283628} 
            Style           =   5
            Alignment       =   1
            TextSave        =   "14:06"
         EndProperty
      EndProperty
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin VB.Frame Frame2 
      Appearance      =   0  'Ã◊Øƒ
      BeginProperty Font 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FF0000&
      Height          =   4770
      Left            =   120
      TabIndex        =   25
      Top             =   1380
      Width           =   14190
      Begin FPSpread.vaSpread sprList 
         Height          =   3615
         Left            =   1980
         TabIndex        =   3
         Top             =   420
         Width           =   10725
         _Version        =   196608
         _ExtentX        =   18918
         _ExtentY        =   6376
         _StockProps     =   64
         MaxCols         =   9
         MaxRows         =   30
         OperationMode   =   2
         ScrollBars      =   2
         SelectBlockOptions=   0
         SpreadDesigner  =   "QPAV_CEnt160.frx":0000
         UserResize      =   0
         VisibleCols     =   500
         VisibleRows     =   500
      End
   End
   Begin VB.Frame Frame3 
      Appearance      =   0  'Ã◊Øƒ
      BackColor       =   &H80000004&
      ForeColor       =   &H80000008&
      Height          =   1215
      Left            =   120
      TabIndex        =   43
      Top             =   6120
      Width           =   14175
   End
End
Attribute VB_Name = "frmQPAV_CEnt160"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit
Private blnInit_Flg         As Boolean           'èâä˙ÉtÉâÉO

Private mlngKensuu           As Long     'ñæç◊åèêî

'ÉÇÉWÉÖÅ[ÉãïœêîÇ…ê›íË
Private mlngKyuyoHensai     As Long
Private mlngSyoyoHensai     As Long
Private mlngZanHensai       As Long
Private mStrKojoCyushiFlg   As String

Private mlngTyushiFlg       As Long     'Added by imz.Yoshida 2005/06/16 çTèúíÜé~ëŒâû


Private Sub cmdExec_Click()
    
    If MsgBox("çTèúíÜé~èÓïÒÇçXêVÇµÇ‹Ç∑ÅBÇÊÇÎÇµÇ¢Ç≈Ç∑Ç©ÅH", vbQuestion + vbOKCancel, "çTèúíÜé~èàóù") = vbCancel Then
        Exit Sub
    End If
    
    'çTèúíÜé~óLñ≥çXêV
    If blnUpdKoujyo = False Then
        Exit Sub
    End If

    'âÊñ èâä˙âª
    Call subFormInitialize
    
    txtSyainCD1.SetFocus

End Sub

Private Sub cmdNayose_Click()
    gstrDat = ""
    QPAV_Nayose.Show 1
    If gstrDat <> "" Then
        txtSyainCD1 = Left(gstrDat, 1)
        txtSyainCD2 = Right(gstrDat, 7)
        Call cmdPFK_Click(5)
    End If
End Sub

'**************************************************************************************************
'*FormÉçÅ[Éh
'**************************************************************************************************
Private Sub Form_Load()
    blnInit_Flg = True             'èâä˙ÉtÉâÉO
    
    Me.Caption = "çTèúíÜé~èàóù (" & gstrCommandLine(8) & ")"
    
    'âÊñ èâä˙âª
    Call subFormInitialize

End Sub

'**************************************************************************************************
'*Form Unload
'**************************************************************************************************
Private Sub Form_Unload(Cancel As Integer)
    
    'îrëºâèú
    Call gblnHaita_Unlock
    
    'µ◊∏ŸæØºÆ›ÇÃêÿíf
    Call gsubTermOracleDB
    
    Set frmQPAV_CEnt160 = Nothing

End Sub

'**************************************************************************************************
'   Form_ActivateÉCÉxÉìÉg:ÉZÉbÉVÉáÉìÇÃämóß
'                        :ÉfÅ[É^ÉxÅ[ÉXämóß
'**************************************************************************************************
Private Sub Form_Activate()
    Dim i As Integer

    If blnInit_Flg = True Then 'èâä˙ÉtÉâÉO=ÉIÉìÇÃèÍçá
        'ÉXÉeÅ[É^ÉXÉoÅ[ÉÅÉbÉZÅ[ÉW
        stbSystem.Panels.Item(1).Text = "èàóùíÜÅDÅDÅD"
        Screen.MousePointer = vbHourglass
        Me.Enabled = False
        
        DoEvents

        'ÉZÉbÉVÉáÉìÇÃämóß
        If Not gblnCreateOracleSession() Then
            'ÉVÉXÉeÉÄÉGÉâÅ[
            Call QSAV_SysErr.subSysErr(gcstrPrjName, gstrCommandLine(1) _
                                    , gstrCommandLine(5), gstrGetErrDateFormat _
                                    , "çTèúíÜé~èàóù (" & gstrCommandLine(8) & ")" _
                                    , CStr(Err.Number), Err.Description)
            'èIóπ
            Unload Me
        End If

        'ÉfÅ[É^ÉxÅ[ÉXÇÃämóß
        If Not gblnConnectOracleDatabase(gstrCommandLine(3), gstrCommandLine(4) _
                                    , gstrCommandLine(0)) Then
            'ÉVÉXÉeÉÄÉGÉâÅ[
            Call QSAV_SysErr.subSysErr(gcstrPrjName, gstrCommandLine(1) _
                                    , gstrCommandLine(5), gstrGetErrDateFormat _
                                    , "çTèúíÜé~èàóù (" & gstrCommandLine(8) & ")" _
                                    , objSession.LastServerErr, objSession.LastServerErrText)
            'èIóπ
            Unload Me
        End If

        Me.Enabled = True
        Screen.MousePointer = vbDefault

        'ÉXÉeÅ[É^ÉXÉoÅ[ÉÅÉbÉZÅ[ÉWè¡ãé
        stbSystem.Panels.Item(1).Text = ""

        blnInit_Flg = False   'èâä˙ÉtÉâÉO=ÉIÉt
        
    End If
    
End Sub

'**************************************************************************************************
'*FORM_KEYDOWN ÉtÉ@ÉìÉNÉVÉáÉìÉLÅ[ê›íË
'**************************************************************************************************
Private Sub Form_KeyDown(KeyCode As Integer, Shift As Integer)
    
    Select Case KeyCode
        Case vbKeyReturn   'Enter
            SendKeys "{TAB}"
        Case vbKeyF1   'F1
            Call cmdPFK_Click(1)
        Case vbKeyF2   'F2
            Call cmdPFK_Click(2)
        Case vbKeyF5   'F5
            If cmdPFK(5).Enabled = True Then
                Call cmdPFK_Click(5)
            End If
        Case vbKeyF10   'F10
            Call cmdPFK_Click(10)
        Case vbKeyF12   'F12
            Call cmdPFK_Click(12)
        Case vbKeyDelete    'DELÉLÅ[ÇâüÇµÇΩéû
            Call Form_KeyPress(46)
    End Select

End Sub
'**************************************
'*FORM_KEYPRESS
'**************************************
Private Sub Form_KeyPress(KeyAscii As Integer)
    'ENTER Beepâπè¡ãé
    Call subErrKaijo
        
    If KeyAscii = vbKeyReturn Then
        KeyAscii = 0
    End If

End Sub

'*****************************************************************************************
'äeÉtÉ@ÉìÉNÉVÉáÉìÉLÅ[ã@î\
'*****************************************************************************************
Private Sub cmdPFK_Click(Index As Integer)
    
    Select Case Index
        Case 1  'ÉÅÉjÉÖÅ[
            Unload Me
        Case 2  'ÉnÅ[ÉhÉRÉsÅ[
            Call gsubQSAV_ActX1001
        Case 5  'é¿çs
            Call subCmdJikkou
        Case 10 'ëOâÊñ 
            Unload Me
        Case 12 'éÊè¡
            'îrëºâèú
            Call gblnHaita_Unlock
            Call subFormInitialize
            txtSyainCD1.SetFocus
    End Select
    
End Sub

'***********************************************************************************************************
'*âÊñ èâä˙âª
'***********************************************************************************************************
Private Sub subFormInitialize()
 Dim intX As Integer
 
    Call subErrKaijo
    
    'äeï\é¶çÄñ⁄ÉNÉäÉA
    txtSyainCD1.Text = ""
    txtSyainCD2.Text = ""
    lblKana.Caption = ""
    lblShimei.Caption = ""
    lblShozoku(0).Caption = ""
    lblShozoku(1).Caption = ""
    lblTozai.Caption = ""
    lblBumon(0).Caption = ""
    lblBumon(1).Caption = ""
    lblShikaku.Caption = ""
    lblKyu.Caption = ""
    lblSeinengappi.Caption = ""
    
    Call gsubSpdClear(sprList)
    sprList.MaxRows = 0
    
    optKoujo(1).Value = True
    cmdNayose.Enabled = True
    'ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWóìÉNÉäÉA
    lblMsg.Caption = ""
    
    'ÉXÉeÅ[É^ÉXÉoÅ[èâä˙âª
    Call gsubInitStatusBar(stbSystem)
    
    'äeÉRÉìÉgÉçÅ[Éãêßå‰
    cmdPFK(5).Enabled = True
    optKoujo(0).Enabled = False
    optKoujo(1).Enabled = False
    cmdExec.Enabled = False
    txtSyainCD1.Enabled = True
    txtSyainCD2.Enabled = True

    mlngTyushiFlg = 0   'Added by imz.Yoshida 2005/06/16 çTèúíÜé~ëŒâû
    
End Sub

'*************************************************************************************************
'*      é¿çsÉ{É^Éìèàóù
'*************************************************************************************************
Private Sub subCmdJikkou()
    Dim strErrMsg As String 'ÉGÉâÅ[ÉÅÉbÉZÅ[ÉW
    Dim strWrk    As String

    'îrëºâèú
    Call gblnHaita_Unlock
    
    Call subErrKaijo
    
    'æØƒÃ´∞∂ΩÇµÇƒã≠êßìIÇ…äe∫›ƒ€∞ŸÇLost_FocusÇ≥ÇπÇÈ
    cmdPFK(5).SetFocus
    
    'àÍóóÇ™ï\é¶Ç≥ÇÍÇÈÇ‹Ç≈é¿çsŒﬁ¿›,ñºäÒÇπÇégópïsâ¬ÅEÉ}ÉEÉXÉ|ÉCÉìÉ^Å[(çªéûåv)
    cmdPFK(5).Enabled = False
    cmdNayose.Enabled = False
    Screen.MousePointer = vbHourglass
''    Call subFormInitialize
    
    mlngKyuyoHensai = 0
    mlngSyoyoHensai = 0
    mlngZanHensai = 0
    mStrKojoCyushiFlg = ""
    
    'ÉXÉeÅ[É^ÉXÉoÅ[ÉÅÉbÉZÅ[ÉW
    stbSystem.Panels.Item(1).Text = "èàóùíÜÅDÅDÅD"
    DoEvents

    If Trim(txtSyainCD1.Text) = "" Then
        gstrSyainCD1 = Space(1)
    Else
        gstrSyainCD1 = Trim$(txtSyainCD1)
    End If
    gstrSyainCD2 = Trim$(txtSyainCD2)

    'Åüì¸óÕÇ≥ÇÍÇΩé–àıÉRÅ[ÉhÉ`ÉFÉbÉNÅiñ¢ì¸óÕÅAì¸óÕåÖêîÉ`ÉFÉbÉNÅj
    If blnJoukenH = False Then
        cmdPFK(5).Enabled = True
        txtSyainCD2.SetFocus
        cmdNayose.Enabled = True
        Screen.MousePointer = vbDefault
        'ÉXÉeÅ[É^ÉXÉoÅ[ÉÅÉbÉZÅ[ÉWè¡ãé
        stbSystem.Panels.Item(1).Text = ""
        Exit Sub
    End If
    
    'îrëºêßå‰
    If gblnHaita_Lock = False Then
        cmdPFK(5).Enabled = True
        txtSyainCD2.SetFocus
        cmdNayose.Enabled = True
        Screen.MousePointer = vbDefault
        'ÉXÉeÅ[É^ÉXÉoÅ[ÉÅÉbÉZÅ[ÉWè¡ãé
        stbSystem.Panels.Item(1).Text = ""
        Exit Sub
    End If
    
    'ÇrÇoópïœêîÇ…äiî[
    
    'ÅüÅüÅüÅ†Å°Å†é–àıëÆê´Å@íäèo Åï ï\é¶
    ''é–àıÇlÇ©ÇÁíäèo
    If blnSeachSyain = False Then
        'Msg = é–àıëÆê´Ç™ë∂ç›ÇµÇ‹ÇπÇÒÅB
        lblMsg.Caption = "WPOE13 " & gstrGetCodeMeisyo(odbDatabase, "E13", "WPO")
        Call gsubParaRemove(odbDatabase) 'ÉpÉâÉÅÅ[É^âï˙
        Me.Enabled = True
        cmdPFK(5).Enabled = True
        cmdNayose.Enabled = True
        txtSyainCD1.SetFocus
        txtSyainCD1.BackColor = vbRed
        txtSyainCD2.BackColor = vbRed
        Screen.MousePointer = vbDefault
        'ÉXÉeÅ[É^ÉXÉoÅ[ÉÅÉbÉZÅ[ÉWè¡ãé
        stbSystem.Panels.Item(1).Text = ""
        
        'îrëºâèú
        Call gblnHaita_Unlock
        
        Exit Sub
    End If
    
    Call gsubSpdClear(sprList)
    
    'ëçåèêî
    mlngKensuu = 0
    
    sprList.ReDraw = False
    
    ''è¨å˚óZéëë‰í†ÉeÅ[ÉuÉãÇ©ÇÁíäèo
    If blnGetKogutiInf Then
        Call subSprKoguti
    End If
    
    ''é–àıóZéëë‰í†ÉeÅ[ÉuÉãÇ©ÇÁíäèo
    If blnGetSyainYuInf Then
        Call subSprSyainYu
    End If
    sprList.ReDraw = True
    
    'äeÉRÉìÉgÉçÅ[Éãêßå‰
    Me.Enabled = True
    
    'äYìñåèêîÉ`ÉFÉbÉN
    If mlngKensuu = 0 Then
        cmdPFK(5).Enabled = True
        cmdNayose.Enabled = True
    Else
        optKoujo(0).Enabled = True
        optKoujo(1).Enabled = True
        'Modified by imz.Yoshida 2005/06/16 çTèúíÜé~ëŒâû ==>
        'If mStrKojoCyushiFlg = "1" Then
        If mStrKojoCyushiFlg = "1" Or mlngTyushiFlg <> 0 Then
        'Modified by imz.Yoshida 2005/06/16 çTèúíÜé~ëŒâû <==
            optKoujo(0).Value = True
        Else
            optKoujo(1).Value = True
        End If
        txtSyainCD1.Enabled = False
        txtSyainCD2.Enabled = False
        cmdExec.Enabled = True
        sprList.SetFocus
    End If
    
    
'Åü ''ç°ÇÕéEÇµÇƒÇ®Ç≠    cmdOsori.Enabled = True
    Screen.MousePointer = vbDefault
    stbSystem.Panels.Item(1).Text = ""

End Sub

'*******************************************************************************
'   ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWÉ{ÉbÉNÉXÇï\é¶Ç∑ÇÈÅB
'*******************************************************************************
Public Sub subShowErrorMsgBox(strErrCode As String, strErrMsg As String)

    Load QSAV_SysErr
    Call QSAV_SysErr.subSysErr("çTèúíÜé~èàóù", _
              gstrCommandLine(1), _
              gstrCommandLine(5), _
              Format(Now, "yyyy-mm-dd hh:nn:ss"), _
              frmQPAV_CEnt160.Name, _
              strErrCode, _
              strErrMsg)

End Sub

'****************************************
'*ÉGÉâÅ[âèúèàóù
'****************************************
Private Sub subErrKaijo()
    lblMsg.Caption = ""
    stbSystem.Panels.Item(1).Text = ""
    txtSyainCD1.BackColor = vbWhite
    txtSyainCD2.BackColor = vbWhite
End Sub

'********************************************************************************
'   ì¸óÕÇ≥ÇÍÇΩé–àıÉRÅ[ÉhÇ™ìKêÿÇ©Ç«Ç§Ç©îªífÇ∑ÇÈ
'********************************************************************************
Private Function blnJoukenH() As Boolean

    blnJoukenH = False
        
    '*****é–àıÉRÅ[Éh*****
    'ì¸óÕåÖ Check
    If Len(gstrSyainCD2) = 0 Then
        Enabled = True
        'Msg = Ç™ì¸óÕÇ≥ÇÍÇƒÇ¢Ç‹ÇπÇÒÅB
        lblMsg.Caption = "WPOE01 é–àıÉRÅ[Éh" & gstrGetCodeMeisyo(odbDatabase, "E01", "WPO")
        txtSyainCD2.BackColor = vbRed
        txtSyainCD2.SetFocus
        Exit Function
    End If
 
    blnJoukenH = True
    
End Function

'*********************************************************************************************
'*Å@Å@éËë±Ç´ñºÅFÅ@é–àıëÆê´éÊìæ
'*Å@Å@à¯Å@êîÅ@ÅFÅ@Ç»Çµ
'*Å@Å@åãÅ@â Å@ÅFÅ@TrueÅcäYìñÉfÅ[É^óL  FalseÅcäYìñÉfÅ[É^ñ≥Çµ
'*Å@Å@ã@î\äTóvÅFÅ@é–àıëÆê´éÊìæÇrÇoÇégópÇµÅAé–àıëÆê´èÓïÒÇéÊìæÇ∑ÇÈ
'*********************************************************************************************
Private Function blnSeachSyain() As Boolean
    
    Dim strSQL      As String
    Dim strEdit     As String
    
On Error GoTo errSeachSyain

    blnSeachSyain = False
    
    'é–àıëÆê´éÊìæ ÇrÇo
    odbDatabase.Parameters.Add "InStrPRMSyainCD1", gstrSyainCD1, ORAPARM_INPUT    'é–àıÉRÅ[ÉhÇP
    odbDatabase.Parameters.Add "InStrPRMSyainCD2", gstrSyainCD2, ORAPARM_INPUT    'é–àıÉRÅ[ÉhÇQ
                
        'éÅñºÉJÉi
    odbDatabase.Parameters.Add "OtStrSimeiKana", Space(15), ORAPARM_OUTPUT
    odbDatabase.Parameters("OtStrSimeiKana").ServerType = ORATYPE_CHAR
        'éÅñºäøéö
    odbDatabase.Parameters.Add "OtStrSimeiKanji", Space(20), ORAPARM_OUTPUT
    odbDatabase.Parameters("OtStrSimeiKanji").ServerType = ORATYPE_CHAR
        'èäëÆìXÉRÅ[Éh
    odbDatabase.Parameters.Add "OtStrMiseCD", Space(3), ORAPARM_OUTPUT
    odbDatabase.Parameters("OtStrMiseCD").ServerType = ORATYPE_CHAR
        'èäëÆìXñº
    odbDatabase.Parameters.Add "OtStrMiseName", Space(30), ORAPARM_OUTPUT
    odbDatabase.Parameters("OtStrMiseName").ServerType = ORATYPE_CHAR
        'ìåêºãÊï™
    odbDatabase.Parameters.Add "OtStrTozaiKBN", Space(1), ORAPARM_OUTPUT
    odbDatabase.Parameters("OtStrTozaiKBN").ServerType = ORATYPE_CHAR
        'èäëÆïîñÂÉRÅ[Éh
    odbDatabase.Parameters.Add "OtStrBumonCD", Space(6), ORAPARM_OUTPUT
    odbDatabase.Parameters("OtStrBumonCD").ServerType = ORATYPE_CHAR
        'èäëÆïîñÂñº
    odbDatabase.Parameters.Add "OtStrBumonName", Space(30), ORAPARM_OUTPUT
    odbDatabase.Parameters("OtStrBumonName").ServerType = ORATYPE_CHAR
        'éëäiÉRÅ[Éh
    odbDatabase.Parameters.Add "OtStrSikakuCD", Space(2), ORAPARM_OUTPUT
    odbDatabase.Parameters("OtStrSikakuCD").ServerType = ORATYPE_CHAR
        'ìôãâÉRÅ[Éh
    odbDatabase.Parameters.Add "OtStrTokyuCD", Space(2), ORAPARM_OUTPUT
    odbDatabase.Parameters("OtStrTokyuCD").ServerType = ORATYPE_CHAR
        'ê∂îNåéì˙
    odbDatabase.Parameters.Add "OtStrBornYMD", Space(8), ORAPARM_OUTPUT
    odbDatabase.Parameters("OtStrBornYMD").ServerType = ORATYPE_VARCHAR2
    
    'ë∂ç›Flg
    odbDatabase.Parameters.Add "OtStrSonzaiFlg", "0", ORAPARM_OUTPUT
    odbDatabase.Parameters("OtStrSonzaiFlg").ServerType = ORATYPE_VARCHAR2

    strSQL = "BEGIN QPAP_CEnt160PkG.QPAP_CEnt160SelSyainZoku(" & _
             ":InStrPRMSyainCD1, " & _
             ":InStrPRMSyainCD2, " & _
             ":OtStrSimeiKana, " & _
             ":OtStrSimeiKanji, " & _
             ":OtStrMiseCD, " & _
             ":OtStrMiseName, " & _
             ":OtStrTozaiKBN, " & _
             ":OtStrBumonCD, " & _
             ":OtStrBumonName, " & _
             ":OtStrSikakuCD, " & _
             ":OtStrTokyuCD, " & _
             ":OtStrBornYMD, " & _
             ":OtstrSonzaiFlg); END;"

     'SPÇÃé¿çs
     odbDatabase.DbexecuteSQL (strSQL)
     
    'äYìñÉfÅ[É^Ç»Çµ
    If odbDatabase.Parameters("OtStrSonzaiFlg") = "0" Then
        Call gsubParaRemove(odbDatabase)  'ÉIÉuÉWÉFÉNÉgÇÃäJï˙
        Exit Function
    End If

    'âÊñ Ç…ï\é¶
    lblKana.Caption = Trim$(odbDatabase.Parameters("OtStrSimeiKana").Value)         'éÅñºÉJÉi
    lblShimei.Caption = Trim$(odbDatabase.Parameters("OtStrSimeiKanji").Value)      'éÅñºäøéö
    lblShozoku(0).Caption = Trim$(odbDatabase.Parameters("OtStrMiseCD").Value)      'èäëÆìXÉRÅ[Éh
    lblShozoku(1).Caption = Trim$(odbDatabase.Parameters("OtStrMiseName").Value)    'èäëÆìXñº
    lblTozai.Caption = Trim$(odbDatabase.Parameters("OtStrTozaiKBN").Value)         'ìåêºãÊï™
    lblBumon(0).Caption = Trim$(odbDatabase.Parameters("OtStrBumonCD").Value)       'èäëÆïîñÂÉRÅ[Éh
    lblBumon(1).Caption = Trim$(odbDatabase.Parameters("OtStrBumonName").Value)     'èäëÆïîñÂñº
    lblShikaku.Caption = Trim$(odbDatabase.Parameters("OtStrSikakuCD").Value)       'éëäiÉRÅ[Éh
    lblKyu.Caption = Trim$(odbDatabase.Parameters("OtStrTokyuCD").Value)            'ìôãâÉRÅ[Éh
    'ê∂îNåéì˙ï“èW
    strEdit = Trim$(odbDatabase.Parameters("OtStrBornYMD").Value)                   'ê∂îNåéì˙
    If IsNull(strEdit) Or Trim$(strEdit) = "" Or Trim$(strEdit) = "0" Or Trim$(strEdit) = "00000000" Then
        lblSeinengappi.Caption = ""
    Else
        lblSeinengappi.Caption = Mid$(strEdit, 1, 4) & "/" & Mid$(strEdit, 5, 2) & "/" & Mid$(strEdit, 7, 2)
    End If

    'ÉIÉuÉWÉFÉNÉgÇÃäJï˙
    Call gsubParaRemove(odbDatabase)

    blnSeachSyain = True

    Exit Function
    
errSeachSyain:
'ÉGÉâÅ[èàóù

    'ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWï\é¶
    Call gsubDBErrorMessage(gstrCommandLine(8), gcstrPrjName, _
                           gstrCommandLine(3), gstrCommandLine(5), gstrGetErrDateFormat)
    'ÉIÉuÉWÉFÉNÉgÇÃäJï˙
    Call gsubParaRemove(odbDatabase)

End Function

'*********************************************************************************************
'*Å@Å@éËë±Ç´ñºÅFÅ@è¨å˚ï‘çœäzèÓïÒéÊìæ
'*Å@Å@à¯Å@êîÅ@ÅFÅ@Ç»Çµ
'*Å@Å@åãÅ@â Å@ÅFÅ@TrueÅcäYìñÉfÅ[É^óL  FalseÅcäYìñÉfÅ[É^ñ≥Çµ
'*Å@Å@ã@î\äTóvÅFÅ@è¨å˚ï‘çœäzèÓïÒéÊìæÇrÇoÇégópÇµÅAè¨å˚ï‘çœäzèÓïÒÇéÊìæÇ∑ÇÈ
'*********************************************************************************************
Private Function blnGetKogutiInf() As Boolean
    
    Dim strSQL      As String
    Dim strEdit     As String
    
On Error GoTo errGetKogutiInf

    blnGetKogutiInf = False
    
    'è¨å˚ï‘çœäzèÓïÒ éÊìæ ÇrÇo
    odbDatabase.Parameters.Add "InStrPRMSyainCD1", gstrSyainCD1, ORAPARM_INPUT     'é–àıÉRÅ[ÉhÇP
    odbDatabase.Parameters.Add "InStrPRMSyainCD2", gstrSyainCD2, ORAPARM_INPUT     'é–àıÉRÅ[ÉhÇQ
                
    'ããó^ï‘çœäz
    odbDatabase.Parameters.Add "OtNumKyuyoHensai", 0, ORAPARM_OUTPUT
    odbDatabase.Parameters("OtNumKyuyoHensai").ServerType = ORATYPE_NUMBER
    'è‹ó^ï‘çœäz
    odbDatabase.Parameters.Add "OtNumSyoyoHensai", 0, ORAPARM_OUTPUT
    odbDatabase.Parameters("OtNumSyoyoHensai").ServerType = ORATYPE_NUMBER
    'ï‘çœécçÇäz
    odbDatabase.Parameters.Add "OtNumZanHensai", 0, ORAPARM_OUTPUT
    odbDatabase.Parameters("OtNumZanHensai").ServerType = ORATYPE_NUMBER
    'çTèúíÜé~Flg
    odbDatabase.Parameters.Add "OtStrKojoCyushiFlg", "0", ORAPARM_OUTPUT
    odbDatabase.Parameters("OtStrKojoCyushiFlg").ServerType = ORATYPE_VARCHAR2
    
    'ë∂ç›Flg
    odbDatabase.Parameters.Add "OtStrSonzaiFlg", "0", ORAPARM_OUTPUT
    odbDatabase.Parameters("OtStrSonzaiFlg").ServerType = ORATYPE_VARCHAR2

    strSQL = "BEGIN QPAP_CEnt160PkG.QPAP_CEnt160GetKogutiInf(" & _
             ":InStrPRMSyainCD1, " & _
             ":InStrPRMSyainCD2, " & _
             ":OtNumKyuyoHensai, " & _
             ":OtNumSyoyoHensai, " & _
             ":OtNumZanHensai, " & _
             ":OtStrKojoCyushiFlg, " & _
             ":OtstrSonzaiFlg); END;"

     'SPÇÃé¿çs
     odbDatabase.DbexecuteSQL (strSQL)
     
    'äYìñÉfÅ[É^Ç»Çµ
    If odbDatabase.Parameters("OtStrSonzaiFlg") = "0" Then
        Call gsubParaRemove(odbDatabase)  'ÉIÉuÉWÉFÉNÉgÇÃäJï˙
        Exit Function
    End If

    'ÉÇÉWÉÖÅ[ÉãïœêîÇ…ê›íË
    mlngKyuyoHensai = odbDatabase.Parameters("OtNumKyuyoHensai").Value
    mlngSyoyoHensai = odbDatabase.Parameters("OtNumSyoyoHensai").Value
    mlngZanHensai = odbDatabase.Parameters("OtNumZanHensai").Value
    mStrKojoCyushiFlg = Trim(odbDatabase.Parameters("OtStrKojoCyushiFlg").Value)

    'ÉIÉuÉWÉFÉNÉgÇÃäJï˙
    Call gsubParaRemove(odbDatabase)

    blnGetKogutiInf = True

    Exit Function
    
errGetKogutiInf:
'ÉGÉâÅ[èàóù
    'ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWï\é¶
    Call gsubDBErrorMessage(gstrCommandLine(8), gcstrPrjName, _
                           gstrCommandLine(3), gstrCommandLine(5), gstrGetErrDateFormat)
    'ÉIÉuÉWÉFÉNÉgÇÃäJï˙
    Call gsubParaRemove(odbDatabase)

End Function

'***********************************************************************************
'    è¨å˚óZéëë‰í†TBLéÊìæèÓïÒÇÉXÉvÉåÉbÉgÇ…ê›íË
'***********************************************************************************
Private Sub subSprKoguti()
 Dim StrValue      As String 'çÄñ⁄ílï∂éöóÒ

    'ëçåèêî
    mlngKensuu = 1

    With sprList
        
        .MaxRows = 1
        
        'éÌï 
        .SetText 1, 1, "è¨å˚"
        'óZéëì˙
        'ï‘çœåéêî
        'óZéëäz
        'ããó^ï‘çœäz
        StrValue = Format$(CDbl(mlngKyuyoHensai), "#,##0")
        .SetText 5, 1, StrValue
        'è‹ó^ï‘çœäz
        StrValue = Format$(CDbl(mlngSyoyoHensai), "#,##0")
        .SetText 6, 1, StrValue
        'écçÇ
        StrValue = Format$(CDbl(mlngZanHensai), "#,##0")
        .SetText 7, 1, StrValue
    End With

End Sub
'*********************************************************************************************
'*Å@Å@éËë±Ç´ñºÅFÅ@é–àıóZéëèÓïÒéÊìæ
'*Å@Å@à¯Å@êîÅ@ÅFÅ@Ç»Çµ
'*Å@Å@åãÅ@â Å@ÅFÅ@TrueÅcäYìñÉfÅ[É^óL  FalseÅcäYìñÉfÅ[É^ñ≥Çµ
'*Å@Å@ã@î\äTóvÅFÅ@é–àıóZéëë‰í†TBLÇÊÇËÅAèÿèëñæç◊èÓïÒÇéÊìæÇ∑ÇÈ
'*********************************************************************************************
Private Function blnGetSyainYuInf()

Dim strSQL               As String
Dim i                    As Long
Dim j                    As Long
Dim lngFirstCnt          As Long  '
Dim lngRecCount          As Long  '
Dim lngMax               As Long  '
   
Const cnsMaxRec As Long = 30


On Error GoTo errGetSyainYuInf
    
    blnGetSyainYuInf = False

    'é–àıëÆê´éÊìæ ÇrÇo
    odbDatabase.Parameters.Add "InStrPRMSyainCD1", gstrSyainCD1, ORAPARM_INPUT     'é–àıÉRÅ[ÉhÇP
    odbDatabase.Parameters.Add "InStrPRMSyainCD2", gstrSyainCD2, ORAPARM_INPUT     'é–àıÉRÅ[ÉhÇQ
    
    'MaxRec
    odbDatabase.Parameters.Add "InNumMaxRec", cnsMaxRec, ORAPARM_INPUT
    odbDatabase.Parameters("InNumMaxRec").ServerType = ORATYPE_CHAR
    'èàóù∂≥›ƒ(IoNumFetchCount
    odbDatabase.Parameters.Add "IoNumFetchCount", 0, ORAPARM_BOTH
    odbDatabase.Parameters("IoNumFetchCount").ServerType = ORATYPE_NUMBER
    'ëçåüçıåèêî(IoNumRecCount
    odbDatabase.Parameters.Add "IoNumRecCount", 0, ORAPARM_BOTH
    odbDatabase.Parameters("IoNumRecCount").ServerType = ORATYPE_NUMBER
    'îzóÒäiî[åèêî
    odbDatabase.Parameters.Add "OtNumAryCount", 0, ORAPARM_OUTPUT
    odbDatabase.Parameters("OtNumAryCount").ServerType = ORATYPE_NUMBER
    
    'èÿèëñæç◊ îzóÒ
    odbDatabase.Parameters.AddTable "OtStrDataAry", ORAPARM_OUTPUT, ORATYPE_VARCHAR2, cnsMaxRec, 200
    
    'åüçıèIóπÉtÉâÉO
    odbDatabase.Parameters.Add "OtstrEndFlg", "0", ORAPARM_OUTPUT
    odbDatabase.Parameters("OtstrEndFlg").ServerType = ORATYPE_VARCHAR2

    'ÇrÇpÇkï∂çÏê¨
    strSQL = "BEGIN QPAP_CEnt160PkG.QPAP_CEnt160GetSyouMeisaiInf(" & _
    ":InStrPRMSyainCD1," & _
    ":InStrPRMSyainCD2," & _
    ":InNumMaxRec," & _
    ":IoNumFetchCount," & _
    ":IoNumRecCount," & _
    ":OtNumAryCount," & _
    ":OtStrDataAry," & _
    ":OtstrEndFlg); END;"

    'íäèoÉåÉRÅ[ÉhÇÉäÉXÉgÇ…ï\é¶
    lngRecCount = 0               'ïœêîÇÃÉNÉäÉA
    lngFirstCnt = 1               'ïœêîÇÃÉNÉäÉA
    i = 1

    Do
        lngFirstCnt = (i - 1) * cnsMaxRec + 1        'ΩÃﬂ⁄ØƒﬁÇÃäJénçsÇÃê›íË
        
        'ÇrÇoÇÃé¿çs
        odbDatabase.DbexecuteSQL (strSQL)
        
        'íäèoåèêîÇï\é¶Ç∑ÇÈ
        If i = 1 Then
            '√∞ÃﬁŸåèêîóp
            Erase gDataAry
            glngTblCnt = 0

            'íäèoåèêîÇ™0åèÇÃèÍçáÇÕÉ{É^Éìégópïsâ¬
            If odbDatabase.Parameters("IoNumRecCount") = 0 Then
                Call gsubParaRemove(odbDatabase)
                Exit Function
            End If
            'îzóÒÇÃçƒíËã`
            lngMax = odbDatabase.Parameters("IoNumRecCount")
            glngTblCnt = lngMax
            ReDim gDataAry(lngMax)
        End If
        
        'ç≈èIÇÃê›íË
'        lngRecCount = lngRecCount + odbDatabase.Parameters("OtNumAryCount")        'ÅyWin2000ëŒâûÅzDel by Yokoyama@NBC 2004/04/23
        lngRecCount = lngRecCount + CLng(odbDatabase.Parameters("OtNumAryCount"))   'ÅyWin2000ëŒâûÅzAdd by Yokoyama@NBC 2004/04/23
        
        For j = lngFirstCnt To lngRecCount
            'èÿèëñæç◊ÉfÅ[É^
            gDataAry(j) = odbDatabase.Parameters("OtStrDataAry").Get_Value(j - 1)
        Next j
        
        i = i + 1

    Loop Until odbDatabase.Parameters("OtstrEndFlg") = "1"  'èIóπÉtÉâÉOÅÅÇPÇ‹Ç≈
    
    'ÉIÉuÉWÉFÉNÉgÇÃäJï˙
    Call gsubParaRemove(odbDatabase)
    
    blnGetSyainYuInf = True

    Exit Function

errGetSyainYuInf:
'ÉGÉâÅ[èàóù
    'ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWï\é¶
    Call gsubDBErrorMessage(gstrCommandLine(8), gcstrPrjName, _
                           gstrCommandLine(3), gstrCommandLine(5), gstrGetErrDateFormat)
    'ÉIÉuÉWÉFÉNÉgÇÃäJï˙
    Call gsubParaRemove(odbDatabase)

End Function

'***********************************************************************************
'    é–àıóZéëë‰í†TBLéÊìæèÓïÒÇÉXÉvÉåÉbÉgÇ…ê›íË
'***********************************************************************************
Private Sub subSprSyainYu()
 Dim i, j          As Long   '
 Dim StrValue      As String 'çÄñ⁄ílï∂éöóÒ
 Dim StrDate       As String 'çÄñ⁄ílï∂éöóÒ
 Dim lngKogKensuu  As Long   'è¨å˚óZéëë‰í†åèêî
 Dim lngSyaKensuu  As Long   'é–àıóZéëë‰í†åèêî
 
 Dim dblKyuZan      As Double
 Dim dblSyoZan      As Double

    'ëçåèêî
    lngKogKensuu = mlngKensuu
    lngSyaKensuu = UBound(gDataAry())
    mlngKensuu = lngKogKensuu + lngSyaKensuu

    With sprList
        'ΩÃﬂ⁄Øƒﬁº∞ƒÇÃMaxRowÇê›íË(max17ÇÇ±Ç¶ÇΩÇÁê›íËÇ∑ÇÈ)
'        If mlngKensuu > 17 Then
            .MaxRows = mlngKensuu
'        End If
        
        '1âÒÇÃåèêî
        For i = 1 To lngSyaKensuu
                   
            'èÿèëñæç◊ÇPÉåÉRÅ[Éh
            StrDate = gDataAry(i)
            
            j = i + lngKogKensuu
        
            'à»â∫àÍóóï\é¶óp
            'éÌï 
            .SetText 1, j, "èÿèë"
            'óZéëì˙
            StrValue = Trim$(gfncstrDlm2(StrDate, 1))
            StrValue = Mid$(StrValue, 1, 4) & "/" & Mid$(StrValue, 5, 2) & "/" & Mid$(StrValue, 7, 2)
            .SetText 2, j, StrValue
            'ï‘çœåéêî
            StrValue = Trim$(gfncstrDlm2(StrDate, 5))
            StrValue = Format$(CDbl(StrValue), "#0") + "Éñåé"
            .SetText 3, j, StrValue
            'óZéëäz
            StrValue = Trim$(gfncstrDlm2(StrDate, 2))
            StrValue = Format$(CDbl(Trim$(gfncstrDlm2(StrDate, 6))) _
                             + CDbl(Trim$(gfncstrDlm2(StrDate, 8))), "#,##0")
            .SetText 4, j, StrValue
            'ããó^ï‘çœäz
            StrValue = Trim$(gfncstrDlm2(StrDate, 6))
            StrValue = Format$(CDbl(StrValue), "#,##0")
            .SetText 5, j, StrValue
            'è‹ó^ï‘çœäz
            StrValue = Trim$(gfncstrDlm2(StrDate, 8))
            StrValue = Format$(CDbl(StrValue), "#,##0")
            .SetText 6, j, StrValue
            
            If IsNull(gfncstrDlm2(StrDate, 13)) Or Trim(gfncstrDlm2(StrDate, 13)) = "" Then
                'ããó^écçÇ
                StrValue = Trim$(gfncstrDlm2(StrDate, 10))
                dblKyuZan = CDbl(StrValue)
                StrValue = Format$(dblKyuZan, "#,##0")
                .SetText 8, j, StrValue
                'è‹ó^écçÇ
                StrValue = Trim$(gfncstrDlm2(StrDate, 11))
                dblSyoZan = CDbl(StrValue)
                StrValue = Format$(dblSyoZan, "#,##0")
                .SetText 9, j, StrValue
                'écçÇ
                StrValue = Format$(dblKyuZan + dblSyoZan, "#,##0")
                .SetText 7, j, StrValue
            Else
                'écçÇ
                .SetText 7, j, "0"
                'ããó^écçÇ
                .SetText 8, j, "0"
                'è‹ó^écçÇ
                .SetText 9, j, "0"
            End If
            
            'Added by imz.Yoshida 2005/06/16 çTèúíÜé~ëŒâû ==>
            If Trim$(gfncstrDlm2(StrDate, 12)) = "1" Then
                mlngTyushiFlg = mlngTyushiFlg + Trim$(gfncstrDlm2(StrDate, 12))
            End If
            'Added by imz.Yoshida 2005/06/16 çTèúíÜé~ëŒâû <==
            .RowHeight(j) = 9.55
            
        Next i
        
    End With

End Sub

'*********************************************************************************************
'*Å@Å@éËë±Ç´ñºÅFÅ@çTèúíÜé~ÉtÉâÉOçXêV
'*Å@Å@à¯Å@êîÅ@ÅFÅ@Ç»Çµ
'*Å@Å@åãÅ@â Å@ÅFÅ@TrueÅcê¨å˜  FalseÅcé∏îs
'*Å@Å@ã@î\äTóvÅFÅ@è¨å˚óZéëë‰í†ÅAé–àıóZéëë‰í†TBLÇÃçTèúíÜé~ÉtÉâÉOÇçXêVÇ∑ÇÈ
'*********************************************************************************************
Private Function blnUpdKoujyo() As Boolean
    Dim strSQL      As String
    Dim strEdit     As String
    Dim strKoujyoFlg     As String
    
    
On Error GoTo errUpdKoujyo

    blnUpdKoujyo = False
    
    If optKoujo(0).Value = True Then
        strKoujyoFlg = "1"
    Else
        strKoujyoFlg = ""
    End If
    
    'çXêV ÇrÇo
    odbDatabase.Parameters.Add "InStrPRMSyainCD1", gstrSyainCD1, ORAPARM_INPUT     'é–àıÉRÅ[ÉhÇP
    odbDatabase.Parameters.Add "InStrPRMSyainCD2", gstrSyainCD2, ORAPARM_INPUT     'é–àıÉRÅ[ÉhÇQ
    'çTèúíÜé~Flg
    odbDatabase.Parameters.Add "InStrKojoCyusiFLG", strKoujyoFlg, ORAPARM_INPUT
    'DBçXêVFlg
    odbDatabase.Parameters.Add "OtUpdateFlg", "0", ORAPARM_OUTPUT
    odbDatabase.Parameters("OtUpdateFlg").ServerType = ORATYPE_VARCHAR2
    
    odbDatabase.Parameters.Add "InstrMenuID", gstrCommandLine(8), ORAPARM_INPUT         'ÉÅÉjÉÖÅ[ID
    odbDatabase.Parameters.Add "InstrModuleID", gcstrPrjName, ORAPARM_INPUT             'ÉvÉçÉOÉâÉÄID
    odbDatabase.Parameters.Add "InstrUserID", gstrCommandLine(1), ORAPARM_INPUT         'ÉÜÅ[ÉUID
    odbDatabase.Parameters.Add "InstrComputerNM", gstrCommandLine(5), ORAPARM_INPUT     'ÉRÉìÉsÉÖÅ[É^ñº
    odbDatabase.Parameters.Add "InstrTozaiKBN", Trim$(gstrCommandLine(10)), ORAPARM_INPUT   'ìåêºãÊï™(óòópé“)
    odbDatabase.Parameters.Add "InstrBushoCD", gstrCommandLine(11), ORAPARM_INPUT       'ïîèêÉRÅ[Éh
    odbDatabase.Parameters.Add "InstrTantoNM", gstrCommandLine(2), ORAPARM_INPUT        'íSìñé“ñº

    strSQL = "BEGIN QPAP_CEnt160PkG.QPAP_CEnt160UpdKoujyo(" & _
             ":InStrPRMSyainCD1," & _
             ":InStrPRMSyainCD2," & _
             ":InStrKojoCyusiFLG," & _
             ":OtUpdateFlg," & _
             ":InstrMenuID," & _
             ":InstrModuleID," & _
             ":InstrUserID," & _
             ":InstrComputerNM," & _
             ":InstrTozaiKBN," & _
             ":InstrBushoCD," & _
             ":InstrTantoNM" & _
             "); END;"

     'SPÇÃé¿çs
     odbDatabase.DbexecuteSQL (strSQL)
     
    'çXêVé∏îs
    If odbDatabase.Parameters("OtUpdateFlg") <> "0" Then
        Call gsubParaRemove(odbDatabase)  'ÉIÉuÉWÉFÉNÉgÇÃäJï˙
        Exit Function
    End If

    'çXêVê¨å˜

    'ÉIÉuÉWÉFÉNÉgÇÃäJï˙
    Call gsubParaRemove(odbDatabase)

    blnUpdKoujyo = True

    Exit Function
    
errUpdKoujyo:
'ÉGÉâÅ[èàóù
    'ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWï\é¶
    Call gsubDBErrorMessage(gstrCommandLine(8), gcstrPrjName, _
                           gstrCommandLine(3), gstrCommandLine(5), gstrGetErrDateFormat)
    'ÉIÉuÉWÉFÉNÉgÇÃäJï˙
    Call gsubParaRemove(odbDatabase)

End Function

'******************************************
'*ÉtÉãåÖíEèo
'******************************************
Private Sub txtSyainCd1_Change()

    If LenB(StrConv(txtSyainCD1.Text, vbFromUnicode)) = 1 Then
        txtSyainCD1.BackColor = vbWhite
        txtSyainCD2.SetFocus
    End If
    
End Sub

'******************************************
'*ÉtÉHÅ[ÉJÉXéÊìæéûëSÉeÉLÉXÉgëIë
'******************************************
Private Sub txtSyainCD1_GotFocus()
    Call gsubSelectText(txtSyainCD1)
End Sub
Private Sub txtSyainCD2_GotFocus()
    Call gsubSelectText(txtSyainCD2)
End Sub
'******************************************
'*é–àıÉRÅ[Éhì¸óÕï∂éöêßå‰ÅiêîéöÇÃÇ›Åj
'******************************************
Private Sub txtSyainCD2_KeyPress(KeyAscii As Integer)
    KeyAscii = gIntFilterKey(KeyAscii, "1234567890")
End Sub

