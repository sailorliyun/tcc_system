VERSION 5.00
Object = "{831FDD16-0C5C-11D2-A9FC-0000F8754DA1}#2.0#0"; "MSCOMCTL.OCX"
Object = "{B02F3647-766B-11CE-AF28-C3A2FBE76A13}#3.0#0"; "SPR32X30.ocx"
Object = "{00025600-0000-0000-C000-000000000046}#5.2#0"; "Crystl32.OCX"
Begin VB.Form frmQPAV_CEnt410 
   BorderStyle     =   1  'å≈íË(é¿ê¸)
   Caption         =   "äÆçœí ímèëàÛç¸"
   ClientHeight    =   8550
   ClientLeft      =   45
   ClientTop       =   330
   ClientWidth     =   14355
   KeyPreview      =   -1  'True
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   ScaleHeight     =   8550
   ScaleWidth      =   14355
   StartUpPosition =   2  'âÊñ ÇÃíÜâõ
   Begin Crystal.CrystalReport CrystalReport 
      Left            =   30
      Top             =   0
      _ExtentX        =   741
      _ExtentY        =   741
      _Version        =   348160
      WindowControlBox=   -1  'True
      WindowMaxButton =   -1  'True
      WindowMinButton =   -1  'True
      PrintFileLinesPerPage=   60
      WindowShowCloseBtn=   -1  'True
   End
   Begin VB.CommandButton cmdInitDisp 
      Caption         =   "èâä˙ï\é¶èá"
      Height          =   465
      Left            =   690
      TabIndex        =   8
      Top             =   6630
      Width           =   1305
   End
   Begin VB.CommandButton cmdPrint2 
      Caption         =   "èoóÕé“àÍóó"
      Height          =   465
      Left            =   12780
      TabIndex        =   11
      Top             =   6630
      Width           =   1335
   End
   Begin VB.Frame Frame2 
      Appearance      =   0  'Ã◊Øƒ
      ForeColor       =   &H80000008&
      Height          =   5145
      Left            =   120
      TabIndex        =   29
      Top             =   1380
      Width           =   14085
      Begin FPSpread.vaSpread spdIchiran 
         Height          =   4740
         Left            =   540
         TabIndex        =   7
         Top             =   240
         Width           =   12945
         _Version        =   196608
         _ExtentX        =   22834
         _ExtentY        =   8361
         _StockProps     =   64
         MaxCols         =   14
         MaxRows         =   20
         OperationMode   =   3
         ScrollBarExtMode=   -1  'True
         SelectBlockOptions=   0
         SpreadDesigner  =   "frmQPAV_CEnt410.frx":0000
         UserResize      =   2
         VisibleCols     =   5
         VisibleRows     =   20
         ScrollBarTrack  =   3
      End
   End
   Begin VB.Frame Frame1 
      Appearance      =   0  'Ã◊Øƒ
      ForeColor       =   &H80000008&
      Height          =   1245
      Left            =   120
      TabIndex        =   28
      Top             =   60
      Width           =   14085
      Begin VB.TextBox txtSyainCD1 
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   330
         IMEMode         =   3  'µÃå≈íË
         Left            =   1770
         MaxLength       =   1
         TabIndex        =   2
         Text            =   "9"
         Top             =   750
         Width           =   285
      End
      Begin VB.Frame Frame3 
         Appearance      =   0  'Ã◊Øƒ
         ForeColor       =   &H80000008&
         Height          =   615
         Left            =   10140
         TabIndex        =   34
         Top             =   540
         Width           =   3705
         Begin VB.TextBox txtHakkoubiY 
            BeginProperty Font 
               Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
               Size            =   11.25
               Charset         =   128
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   330
            IMEMode         =   3  'µÃå≈íË
            Left            =   1110
            MaxLength       =   4
            TabIndex        =   4
            Text            =   "9999"
            Top             =   180
            Width           =   645
         End
         Begin VB.TextBox txtHakkoubiM 
            BeginProperty Font 
               Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
               Size            =   11.25
               Charset         =   128
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   330
            IMEMode         =   3  'µÃå≈íË
            Left            =   2130
            MaxLength       =   2
            TabIndex        =   5
            Text            =   "99"
            Top             =   180
            Width           =   375
         End
         Begin VB.TextBox txtHakkoubiD 
            BeginProperty Font 
               Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
               Size            =   11.25
               Charset         =   128
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   330
            IMEMode         =   3  'µÃå≈íË
            Left            =   2880
            MaxLength       =   2
            TabIndex        =   6
            Text            =   "99"
            Top             =   180
            Width           =   375
         End
         Begin VB.Label Label4 
            Caption         =   "îN"
            BeginProperty Font 
               Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
               Size            =   11.25
               Charset         =   128
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   285
            Left            =   1800
            TabIndex        =   38
            Top             =   240
            Width           =   315
         End
         Begin VB.Label Label5 
            Caption         =   "åé"
            BeginProperty Font 
               Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
               Size            =   11.25
               Charset         =   128
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   285
            Left            =   2550
            TabIndex        =   37
            Top             =   240
            Width           =   315
         End
         Begin VB.Label Label7 
            Caption         =   "ì˙"
            BeginProperty Font 
               Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
               Size            =   11.25
               Charset         =   128
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   285
            Left            =   3300
            TabIndex        =   36
            Top             =   240
            Width           =   315
         End
         Begin VB.Label Label8 
            Caption         =   "î≠çsì˙"
            BeginProperty Font 
               Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
               Size            =   11.25
               Charset         =   128
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   285
            Left            =   120
            TabIndex        =   35
            Top             =   240
            Width           =   915
         End
      End
      Begin VB.TextBox txtSyainCD2 
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   330
         IMEMode         =   3  'µÃå≈íË
         Left            =   2130
         MaxLength       =   7
         TabIndex        =   3
         Text            =   "9999999"
         Top             =   750
         Width           =   975
      End
      Begin VB.TextBox txtKansaibiM 
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   330
         IMEMode         =   3  'µÃå≈íË
         Left            =   2820
         MaxLength       =   2
         TabIndex        =   1
         Text            =   "99"
         Top             =   270
         Width           =   375
      End
      Begin VB.TextBox txtKansaibiY 
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   330
         IMEMode         =   3  'µÃå≈íË
         Left            =   1770
         MaxLength       =   4
         TabIndex        =   0
         Text            =   "9999"
         Top             =   270
         Width           =   645
      End
      Begin VB.Label Label6 
         Caption         =   "é–àıÉRÅ[Éh"
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Left            =   570
         TabIndex        =   33
         Top             =   780
         Width           =   1155
      End
      Begin VB.Label Label3 
         Caption         =   "åé"
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Left            =   3300
         TabIndex        =   32
         Top             =   330
         Width           =   405
      End
      Begin VB.Label Label2 
         Caption         =   "îN"
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Left            =   2490
         TabIndex        =   31
         Top             =   330
         Width           =   315
      End
      Begin VB.Label Label1 
         Caption         =   "äÆçœì˙"
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Left            =   570
         TabIndex        =   30
         Top             =   330
         Width           =   1155
      End
   End
   Begin VB.PictureBox picMsg 
      BackColor       =   &H00FFFFFF&
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   8.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   405
      Left            =   60
      ScaleHeight     =   345
      ScaleWidth      =   14220
      TabIndex        =   25
      TabStop         =   0   'False
      Top             =   7170
      Width           =   14280
      Begin VB.Label lblMsg 
         BackStyle       =   0  'ìßñæ
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H000000FF&
         Height          =   285
         Left            =   60
         TabIndex        =   26
         Top             =   60
         Width           =   12405
      End
   End
   Begin VB.PictureBox picPfMenu 
      Align           =   2  'â∫ëµÇ¶
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   8.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   585
      Left            =   0
      ScaleHeight     =   525
      ScaleWidth      =   14295
      TabIndex        =   12
      TabStop         =   0   'False
      Top             =   7590
      Width           =   14355
      Begin VB.CommandButton cmdPFK 
         Caption         =   "F12:éÊè¡"
         Height          =   375
         Index           =   12
         Left            =   13140
         TabIndex        =   24
         Top             =   90
         Width           =   1155
      End
      Begin VB.CommandButton cmdPFK 
         Enabled         =   0   'False
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   11
         Left            =   11955
         TabIndex        =   23
         TabStop         =   0   'False
         Top             =   90
         Width           =   1155
      End
      Begin VB.CommandButton cmdPFK 
         Caption         =   "F10:ëOâÊñ "
         Height          =   375
         Index           =   10
         Left            =   10725
         TabIndex        =   22
         Top             =   90
         Width           =   1155
      End
      Begin VB.CommandButton cmdPFK 
         Enabled         =   0   'False
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   9
         Left            =   9540
         TabIndex        =   21
         TabStop         =   0   'False
         Top             =   90
         Width           =   1155
      End
      Begin VB.CommandButton cmdPFK 
         Enabled         =   0   'False
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   8
         Left            =   8355
         TabIndex        =   20
         TabStop         =   0   'False
         Top             =   90
         Width           =   1155
      End
      Begin VB.CommandButton cmdPFK 
         Enabled         =   0   'False
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   7
         Left            =   7170
         TabIndex        =   19
         TabStop         =   0   'False
         Top             =   90
         Width           =   1155
      End
      Begin VB.CommandButton cmdPFK 
         Enabled         =   0   'False
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   6
         Left            =   5985
         TabIndex        =   18
         TabStop         =   0   'False
         Top             =   90
         Width           =   1155
      End
      Begin VB.CommandButton cmdPFK 
         Caption         =   "F5:é¿çs"
         Height          =   375
         Index           =   5
         Left            =   4770
         TabIndex        =   17
         Top             =   90
         Width           =   1155
      End
      Begin VB.CommandButton cmdPFK 
         Enabled         =   0   'False
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   4
         Left            =   3585
         TabIndex        =   16
         TabStop         =   0   'False
         Top             =   90
         Width           =   1155
      End
      Begin VB.CommandButton cmdPFK 
         Enabled         =   0   'False
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   3
         Left            =   2400
         TabIndex        =   15
         TabStop         =   0   'False
         Top             =   90
         Width           =   1155
      End
      Begin VB.CommandButton cmdPFK 
         Caption         =   "F2: ∞ƒﬁ∫Àﬂ∞"
         Height          =   375
         Index           =   2
         Left            =   1215
         TabIndex        =   14
         Top             =   90
         Width           =   1155
      End
      Begin VB.CommandButton cmdPFK 
         Caption         =   "F1:“∆≠-"
         Height          =   375
         Index           =   1
         Left            =   30
         TabIndex        =   13
         Top             =   90
         Width           =   1155
      End
   End
   Begin VB.CommandButton cmdPrint 
      Caption         =   "ÉvÉåÉrÉÖÅ["
      Height          =   465
      Index           =   0
      Left            =   9780
      TabIndex        =   9
      Top             =   6630
      Width           =   1185
   End
   Begin VB.CommandButton cmdPrint 
      Caption         =   "àÛç¸"
      Height          =   465
      Index           =   1
      Left            =   11070
      TabIndex        =   10
      Top             =   6630
      Width           =   1185
   End
   Begin MSComctlLib.StatusBar stbSystem 
      Align           =   2  'â∫ëµÇ¶
      Height          =   375
      Left            =   0
      TabIndex        =   27
      Top             =   8175
      Width           =   14355
      _ExtentX        =   25321
      _ExtentY        =   661
      _Version        =   393216
      BeginProperty Panels {8E3867A5-8586-11D1-B16A-00C0F0283628} 
         NumPanels       =   5
         BeginProperty Panel1 {8E3867AB-8586-11D1-B16A-00C0F0283628} 
            AutoSize        =   1
            Object.Width           =   12841
            MinWidth        =   3528
         EndProperty
         BeginProperty Panel2 {8E3867AB-8586-11D1-B16A-00C0F0283628} 
            Object.Width           =   3351
            MinWidth        =   3351
            Text            =   "ïxémí Å@ëæòY"
            TextSave        =   "ïxémí Å@ëæòY"
         EndProperty
         BeginProperty Panel3 {8E3867AB-8586-11D1-B16A-00C0F0283628} 
            Object.Width           =   3881
            MinWidth        =   3881
            Text            =   "9999999999999999"
            TextSave        =   "9999999999999999"
         EndProperty
         BeginProperty Panel4 {8E3867AB-8586-11D1-B16A-00C0F0283628} 
            Style           =   6
            Alignment       =   1
            TextSave        =   "2006/04/06"
         EndProperty
         BeginProperty Panel5 {8E3867AB-8586-11D1-B16A-00C0F0283628} 
            Style           =   5
            Alignment       =   1
            TextSave        =   "12:36"
         EndProperty
      EndProperty
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
End
Attribute VB_Name = "frmQPAV_CEnt410"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit
'************************************************************************************
'  ˚¸ìáâÆÉNÉåÉWÉbÉg éxâáÉVÉXÉeÉÄ
'    ÉTÉuÉVÉXÉeÉÄñºÅF é–àıë›ïtÉVÉXÉeÉÄÅiÇoÇ`Åj
'---------------------------------------
'    ã@î\ñºÅ@Å@Å@Å@ÅF QPAV_CEnt410     äÆçœí ímèëàÛç¸
'    ã@î\ì‡óeÅ@Å@Å@ÅF äÆçœÇµÇΩé–àıÇ…äÆçœí ímèëÇàÛç¸Ç∑ÇÈ
'    ÉtÉHÅ[ÉÄÅ@Å@Å@ÅF frmQPAV_CEnt410  ÅF äÆçœí ímèëàÛç¸éwé¶âÊñ 
'---------------------------------------
'   çÏê¨ì˙Å@ ÅF 2005/01/20
'   íSìñé“Å@ ÅF FIP SEKINE
'---------------------------------------
'   èCê≥ì˙Å@ ÅF 9999/99/99
'   èCê≥ì‡óe ÅF ÇmÇmÇmÇmÇmÇmÇmÇmÇmÇmÇmÇmÇmÇmÇmÇmÇmÇmÇm
'************************************************************************************





'ÉtÉâÉO
Private blnNoChangeEvFlg       As Boolean    'ÉCÉxÉìÉgñ≥å¯ÉtÉâÉO
Private blnDbFlg               As Boolean    'DBê⁄ë±
Private bolwkTblEdit           As Boolean    'àÛç¸ópWKÉeÅ[ÉuÉãçÏê¨


'åüçıKEY
Private mstrKeyKansaibiFr      As String     'äÆçœì˙From   Å¶íPåééwíËÇÃà◊ FromÇÕ 1ì˙
Private mstrKeyKansaibiTo      As String     'äÆçœì˙To                     ToÇÕ ññì˙
Private mstrKeySyaincd1        As String     'é–àıÉRÅ[Éh1
Private mstrKeySyaincd2        As String     'é–àıÉRÅ[Éh2

'í†ï[ èåèóp
Private mstrKeyYushibi         As String     'óZéëì˙  Å¶é–àıéwíËéûÇ…óZéëì˙ÇèåèÇ…Ç∑ÇÈ

'Work
Private mstrHakkoubi           As String     'î≠çsì˙
Private mlngSvCol              As Long       'SORT KEY ÉZÅ[Éuíl
Private mintSort               As Integer    'SORTèáÅi0=èâä˙ÅA1=è∏èáÅA2=ç~èáÅj



'CONST
Const cnsTitle                 As String = "äÆçœí ímèëàÛç¸"






'***********************************************************************************
'    FORM LOAD
'***********************************************************************************
Private Sub Form_Load()

    'ÉtÉâÉOèâä˙âª
    blnNoChangeEvFlg = False
    blnDbFlg = False

    'ÉXÉeÅ[É^ÉXÉoÅ[ê›íË
    Call gsubInitStatusBar(stbSystem)
    
    'ÉtÉHÅ[ÉÄñºê›íË
    Me.Caption = cnsTitle & " (" & gstrCommandLine(8) & ")"
    
    'âÊñ èâä˙âª
    Call subInitScreen

End Sub

'***********************************************************************************
'    FORM Activate
'***********************************************************************************
Private Sub Form_Activate()

'ADD 2006.04.28 by NBC.Nomura >> ã@ñßèÓïÒÇÃàÛç¸ÅEÉRÉsÅ[êßå¿é¿é{ <<
    Dim clsActX490 As QSAV_ActX490.ActX490C

    If gblnInitFlg = True Then      'èâä˙ÉtÉâÉO = ÉIÉìÇÃèÍçá
        
        'ÉXÉeÅ[É^ÉXÉoÅ[ÉÅÉbÉZÅ[ÉW
        stbSystem.Panels.Item(1).Text = "èàóùíÜÅDÅDÅD"
        
        'âÊñ êßå‰
        Screen.MousePointer = vbHourglass
        Me.Enabled = False
        
        DoEvents
        
        'ÉZÉbÉVÉáÉìÇÃämóß
        If Not gblnCreateOracleSession() Then
            'ÉVÉXÉeÉÄÉGÉâÅ[
            Call QSAV_SysErr.subSysErr(gcstrPrjName, gstrCommandLine(1) _
                                    , gstrCommandLine(5), gstrGetErrDateFormat _
                                    , cnsTitle & "(" & gstrCommandLine(8) & ") " _
                                    , CStr(Err.Number), Err.Description)
            'èIóπ
            Unload Me
            Exit Sub
        End If
        
        'ÉfÅ[É^ÉxÅ[ÉXÇÃämóß
        If Not gblnConnectOracleDatabase(gstrCommandLine(3), gstrCommandLine(4) _
                                    , gstrCommandLine(0)) Then
            'ÉVÉXÉeÉÄÉGÉâÅ[
            Call QSAV_SysErr.subSysErr(gcstrPrjName, gstrCommandLine(1) _
                                    , gstrCommandLine(5), gstrGetErrDateFormat _
                                    , cnsTitle & "(" & gstrCommandLine(8) & ") " _
                                    , CStr(Err.Number), Err.Description)
            'èIóπ
            Unload Me
            Exit Sub
        End If
        
        'DBê⁄ë±OK
        blnDbFlg = True
        
        'SPèâä˙èàóù  ÉRÅ[ÉhÉeÅ[ÉuÉãèâä˙ì«çûÇ›
        Call gsubSPInit
        
        'ãNìÆèâä˙Ç…àÛç¸ópWKÉeÅ[ÉuÉãÉNÉäÉAÅié©í[ññÅïÉIÉyÉåÅ[É^Åj
        Call fncblnPrintDataDel
        
        'ÉXÉeÅ[É^ÉXÉoÅ[ÉÅÉbÉZÅ[ÉWè¡ãé
        Me.Enabled = True
        Screen.MousePointer = vbDefault
        stbSystem.Panels.Item(1).Text = ""
        
'-- Start Of ADD 2006.04.28 by NBC.Nomura >> ã@ñßèÓïÒÇÃàÛç¸ÅEÉRÉsÅ[êßå¿é¿é{ <<
        'ëÄçÏêßå¿âÊñ îªíËèàóù
        Set clsActX490 = CreateObject("QSAV_ActX490.ActX490C")
        Set clsActX490.podbDatabase = odbDatabase
        Call clsActX490.subQSAV_ActX490(Me.Name, _
                                        gstrCommandLine(1), _
                                        gstrCommandLine(5), _
                                        gstrCommandLine(8), _
                                        gstrCommandLine(10), _
                                        gstrCommandLine(11))
        Me.Caption = Me.Caption & clsActX490.strHcopyNotName
        Set clsActX490 = Nothing
'-- Finish Of ADD 2006.04.28 by NBC.Nomura >> ã@ñßèÓïÒÇÃàÛç¸ÅEÉRÉsÅ[êßå¿é¿é{ <<
        
        gblnInitFlg = False            'èâä˙ÉtÉâÉO = ÉIÉt
    End If

End Sub

'***********************************************************************************
'    FORM QueryUnload
'***********************************************************************************
Private Sub Form_QueryUnload(Cancel As Integer, UnloadMode As Integer)

     'ÇcÇaê⁄ë±ÇnÇj
    If blnDbFlg = True Then
    
        'WKÉeÅ[ÉuÉãçÌèú
        Call fncblnPrintDataDel
        
        'µ◊∏ŸæØºÆ›ÇÃêÿíf
        Call gsubTermOracleDB
    
    End If

End Sub


'***********************************************************************************
'    FORM KEY PRESS ÉCÉxÉìÉg
'***********************************************************************************
Private Sub Form_KeyPress(KeyAscii As Integer)

    'ÉGÉâÅ[ÉNÉäÉA
    Call subErrCrear

    
    'ENTER Beepâπè¡ãé
    If KeyAscii = vbKeyReturn Then
        KeyAscii = 0
    End If

End Sub

'***********************************************************************************
'    FORM KEY DOWN ÉCÉxÉìÉg
'***********************************************************************************
Private Sub Form_KeyDown(KeyCode As Integer, Shift As Integer)


    'ÉtÉ@ÉìÉNÉVÉáÉìÉLÅ[ê›íË
    Select Case KeyCode
         Case vbKeyReturn   'Enter
            'ÉGÉâÅ[ÉNÉäÉA
            Call subErrCrear
            'TAB
            SendKeys "{TAB}"
         Case vbKeyF1   'F1
            Call cmdPFK_Click(1)
         Case vbKeyF2   'F2
            Call cmdPFK_Click(2)
         Case vbKeyF5   'F5
            If cmdPFK(5).Enabled = True Then
                'ÉGÉâÅ[ÉNÉäÉA
                Call subErrCrear
                'F5
                Call cmdPFK_Click(5)
            End If
'         Case vbKeyF7   'F7
'            Call cmdPFK_Click(7)
'         Case vbKeyF8   'F8
'            Call cmdPFK_Click(8)
         Case vbKeyF10  'F10
            Call cmdPFK_Click(10)
         Case vbKeyF12   'F12
            Call cmdPFK_Click(12)
    End Select


End Sub






'***********************************************************************************
'    ÉtÉ@ÉìÉNÉVÉáÉìÉLÅ[ÉNÉäÉbÉNèàóù
'***********************************************************************************
Private Sub cmdPFK_Click(Index As Integer)
        
'ADD 2006.04.28 by NBC.Nomura >> ã@ñßèÓïÒÇÃàÛç¸ÅEÉRÉsÅ[êßå¿é¿é{ <<
    Dim clsActX1001     As QSAV_ActX1001.ActX1001C
    
    Select Case Index
        '***** ÉÅÉjÉÖÅ[ *****
        Case 1
            Unload Me
            Exit Sub
        
        '***** ÉnÅ[ÉhÉRÉsÅ[ *****
        Case 2
'DEL 2006.04.28 by NBC.Nomura >> ã@ñßèÓïÒÇÃàÛç¸ÅEÉRÉsÅ[êßå¿é¿é{ <<
'           Call gsubQSAV_ActX1001
'--Start Of ADD 2006.04.28 by NBC.Nomura >> ã@ñßèÓïÒÇÃàÛç¸ÅEÉRÉsÅ[êßå¿é¿é{ <<
            'ÉnÅ[ÉhÉRÉsÅ[ópDLLåƒèoèàóùÇ…âÊñ ÉLÉÉÉvÉVÉáÉìÇÉpÉâÉÅÅ[É^Ç∆ÇµÇƒí«â¡
            Set clsActX1001 = CreateObject("QSAV_ActX1001.ActX1001C")
            Call clsActX1001.subQSAV_ActX1001(Me.Caption)
            
            Set clsActX1001 = Nothing
'--Finish Of ADD 2006.04.28 by NBC.Nomura >> ã@ñßèÓïÒÇÃàÛç¸ÅEÉRÉsÅ[êßå¿é¿é{ <<
            
            picMsg.Refresh
        
        '***** é¿çs *****
        Case 5
            'ÉGÉâÅ[ÉNÉäÉA
            Call subErrCrear
            'é¿çs
            Call subExecute
            
        '***** ëOï≈ *****
        Case 7
'            If spdIchiran.DataRowCnt = 0 Or spdIchiran.ActiveRow = 1 Then
'                lblMsg.Caption = "WHOE09 " & gstrGetCodeMeisyo(odbDatabase, "E09", "WHO")   'Msg = ëOÉyÅ[ÉWÇÕÇ†ÇËÇ‹ÇπÇÒ
'                Exit Sub
'            End If
'            spdIchiran.SetFocus
'            SendKeys "{PGUP}"
        
        '***** éüï≈ *****
        Case 8
'            If spdIchiran.DataRowCnt = 0 Or spdIchiran.DataRowCnt <= spdIchiran.ActiveRow Then
'                lblMsg.Caption = "WHOE10 " & gstrGetCodeMeisyo(odbDatabase, "E10", "WHO")   'Msg = éüÉyÅ[ÉWÇÕÇ†ÇËÇ‹ÇπÇÒ
'                Exit Sub
'            End If
'            spdIchiran.SetFocus
'            SendKeys "{PGDN}"
        
        Case 10 'ëOâÊñ 
            Unload Me
            Exit Sub
        
        '***** éÊè¡ *****
        Case 12
            Call subCancel
    
    End Select
    
End Sub


'***********************************************************************************
'    é¿çs
'***********************************************************************************
Private Sub subExecute()
    
    'âÊñ êßå‰
    Screen.MousePointer = vbHourglass
    Me.Enabled = False
    
    'åüçıèåèì¸óÕÉ`ÉFÉbÉN
    If fncbolInputChk = False Then
        'ì¸óÕÉGÉâÅ[
        Exit Sub
    End If
    
    'àÍóóåüçı ï\é¶
    If fncblnListSel = False Then
        'ERR OR äYìñÉfÅ[É^Ç»Çµ
        GoTo subExecute_EXIT
    End If
    
    'î≠çsì˙ï“èW
    Call subHakkoubiEdit
    
    'É{É^Éìêßå‰ Åï åüçıèåèì¸óÕïsâ¬
    If spdIchiran.MaxRows > 0 Then
        'äÆçœí ím
        cmdPrint(0).Enabled = True
        cmdPrint(1).Enabled = True
        
        'èoóÕé“àÍóó
'''        'é–àıÉRÅ[ÉhéwíËÇ©ÅH  Å¶é–àıÉRÅ[ÉhéwíËÇ≈Ç©Ç¬äÆçœì˙ñ¢éwíËÇÕëŒè€äO
'''        If Trim$(mstrKeySyaincd2) <> "" And _
'''            Trim$(mstrKeyKansaibiFr) = "" Then
        'é–àıÉRÅ[ÉhéwíËÇ©ÅH  Å¶é–àıÉRÅ[ÉhéwíËÇÕëŒè€äO
        If Trim$(mstrKeySyaincd2) <> "" Then
            'é–àıÉRÅ[ÉhéwíË  èàóùëŒè€äO
            cmdPrint2.Enabled = False
        Else
            'ñ¢éwíË èàóùëŒè€
            cmdPrint2.Enabled = True
        End If
    
        'èâä˙ï\é¶èá
        cmdInitDisp.Enabled = True
        
        'åüçıèåè ì¸óÕïsâ¬
        txtKansaibiY.Enabled = False
        txtKansaibiM.Enabled = False
        txtSyainCD1.Enabled = False
        txtSyainCD2.Enabled = False
        
        'é¿çsÉ{É^Éì âüâ∫ïsâ¬
        cmdPFK(5).Enabled = False
        
    End If
    
subExecute_EXIT:
    
    'âÊñ êßå‰
    Me.Enabled = True
    Screen.MousePointer = vbDefault
    
    'àÍóóï\é¶åèêîÇ™ÇOåèÇ≈Ç©Ç¬ÅAì¸óÕèåèÇ™ì¸óÕâ¬î\èÛë‘ÇÃèÍçáÇ…
    If spdIchiran.MaxRows = 0 And txtKansaibiY.Enabled = True Then
        txtKansaibiY.SetFocus    'îNÇ…ÉtÉHÅ[ÉJÉX
    Else
        'àÍóóï\é¶åèêîÇ™ÇPåèà»è„Ç≈Ç©Ç¬ÅAé–àıÉRÅ[ÉhéwíËÇ≈
        If spdIchiran.MaxRows > 0 And txtHakkoubiY.Enabled = True Then
            'î≠çsì˙Ç…ÉtÉHÅ[ÉJÉX
            txtHakkoubiY.SetFocus
        Else
            'àÍóóÇ÷ÉtÉHÅ[ÉJÉX
            spdIchiran.SetFocus
        End If
    End If
    
End Sub


'***********************************************************************************
'    äÆçœí ímèë  àÛç¸ÅEÉvÉåÉrÉÖÅ[ É{É^ÉìÉNÉäÉbÉN
'***********************************************************************************
Private Sub cmdPrint_Click(Index As Integer)
    
    'î≠çsì˙É`ÉFÉbÉN
    If fncbolHakkoubiChk = False Then
        'ì¸óÕÉGÉâÅ[
        Exit Sub
    End If
    
    'àÛç¸ÅEÉvÉåÉrÉÖÅ[
    If Index = 0 Then
        If MsgBox("ÉvÉåÉrÉÖÅ[ÇäJénÇµÇ‹Ç∑ÅBÇÊÇÎÇµÇ¢Ç≈Ç∑Ç©ÅH", vbQuestion + vbOKCancel, "äÆçœí ímèë") = vbCancel Then
            Exit Sub
        End If
    Else
        If MsgBox("àÛç¸ÇäJénÇµÇ‹Ç∑ÅBÇÊÇÎÇµÇ¢Ç≈Ç∑Ç©ÅH", vbQuestion + vbOKCancel, "äÆçœí ímèë") = vbCancel Then
            Exit Sub
        End If
    End If
    
    'âÊñ êßå‰
    Screen.MousePointer = vbHourglass
    Me.Enabled = False
    
    'àÛç¸ópWKÉeÅ[ÉuÉãçÏê¨çœÇ›Ç©
    If bolwkTblEdit = False Then
        'àÛç¸ÉfÅ[É^çÏê¨
        If fncblnPrintDataEdit = False Then
            'âÊñ êßå‰
            Me.Enabled = True
            Screen.MousePointer = vbDefault
            'ÉfÅ[É^çÏê¨ÉGÉâÅ[
            Exit Sub
        End If
    End If
    
    'é–àıÉRÅ[ÉhéwíËéûÅAóZéëì˙ÇKEYÇ∆Ç∑ÇÈ
    If Trim$(mstrKeySyaincd2) <> "" Then
        mstrKeyYushibi = gVarSpdGetText(spdIchiran, 6, spdIchiran.ActiveRow)
    End If
    
    'âÊñ êßå‰
    Me.Enabled = True
    Screen.MousePointer = vbDefault
    
    'àÛç¸ÅEÉvÉåÉrÉÖÅ[
    If Index = 0 Then
        'ÉvÉåÉrÉÖÅ[
        Call sub410PrintRep(crptToWindow)
    Else
        'àÛç¸é¿çs
        Call sub410PrintRep(crptToPrinter)
    End If
    
    'àÛç¸ópWKÉeÅ[ÉuÉãçÏê¨çœÇ›
    bolwkTblEdit = True
    
End Sub
'***********************************************************************************
'    èoóÕé“àÍóó  É{É^ÉìÉNÉäÉbÉN
'***********************************************************************************
Private Sub cmdPrint2_Click()
    Dim datTmp         As Date
    
    Dim strTmpY        As String
    Dim strTmpM        As String
    '---------------------------------
    
    'àÛç¸ÅEÉvÉåÉrÉÖÅ[
    If MsgBox("ÉvÉåÉrÉÖÅ[ÇäJénÇµÇ‹Ç∑ÅBÇÊÇÎÇµÇ¢Ç≈Ç∑Ç©ÅH", vbQuestion + vbOKCancel, "äÆçœí ímèë") = vbCancel Then
        Exit Sub
    End If
    
    'âÊñ êßå‰
    Screen.MousePointer = vbHourglass
    Me.Enabled = False
    
    'àÛç¸ópWKÉeÅ[ÉuÉãçÏê¨çœÇ›Ç©
    If bolwkTblEdit = False Then
        'àÛç¸ÉfÅ[É^çÏê¨
        If fncblnPrintDataEdit = False Then
            'ÉfÅ[É^çÏê¨ÉGÉâÅ[
            
            'âÊñ êßå‰
            Me.Enabled = True
            Screen.MousePointer = vbDefault
            
            Exit Sub
        End If
    End If
    
    'âÊñ êßå‰
    Me.Enabled = True
    Screen.MousePointer = vbDefault
    
    'ÉvÉåÉrÉÖÅ[
    Call sub411PrintRep(crptToWindow)
    
    'àÛç¸ópWKÉeÅ[ÉuÉãçÏê¨çœÇ›
    bolwkTblEdit = True
    
End Sub

'***********************************************************************************
'    èâä˙ï\é¶èáÇ÷ É{É^ÉìÉNÉäÉbÉN
'***********************************************************************************
Private Sub cmdInitDisp_Click()
    
    'àÍóóÇÃï\é¶èáÇèâä˙ï\é¶èáÇ…Ç∑ÇÈ
    With spdIchiran
    
        If spdIchiran.MaxRows > 0 Then
        
            'èâä˙ï\é¶èáÇ÷SORT   èäëÆìXÉRÅ[ÉhÅAé–àıÉRÅ[Éh
            .Row = 1     'ÉZÉãÉuÉçÉbÉNÇê›íË
            .Col = 1
            .Row2 = .MaxRows
            .Col2 = .MaxCols
            
            'SORTÉpÉ^Å[Éì
            .SortBy = SS_SORT_BY_ROW
            .SortKey(1) = 4     'ëÊÇPÉ\Å[ÉgÉLÅ[ÅièäëÆìXÉRÅ[ÉhÅjÇê›íË
            .SortKey(2) = 2     'ëÊÇQÉ\Å[ÉgÉLÅ[Åié–àıÉRÅ[ÉhÅjÇê›íË
            .SortKey(3) = 6     'ëÊÇRÉ\Å[ÉgÉLÅ[ÅióZéëì˙ÅjÇê›íË
            
            'è∏èáÇ…ï¿Ç◊ë÷Ç¶
            .SortKeyOrder(1) = SS_SORT_ORDER_ASCENDING
            .SortKeyOrder(2) = SS_SORT_ORDER_ASCENDING
            .SortKeyOrder(3) = SS_SORT_ORDER_ASCENDING
                
            'é¿çs
            .Action = SS_ACTION_SORT
                
            'SAVEílÇèâä˙âª
            mintSort = 0       'ëOâÒÉ\Å[ÉgèáÅi0=èâä˙ 1=è∏èá 2=ç~èáÅj
            mlngSvCol = 0      'ëOâÒÉ\Å[ÉgCOL(0=èâä˙ à»äO=COL)
        
        End If
    End With
    
End Sub





'***********************************************************************************
'    âÊñ èâä˙âª
'***********************************************************************************
Private Sub subInitScreen()

    'ÉGÉâÅ[ÉNÉäÉA
    Call subErrCrear
    
    'ÉÅÉbÉZÅ[ÉWÉNÉäÉA
    lblMsg.Caption = ""

    'âÊñ çÄñ⁄èâä˙âª
    blnNoChangeEvFlg = True
    txtKansaibiY.Text = ""
    txtKansaibiM.Text = ""
    txtSyainCD1.Text = ""
    txtSyainCD2.Text = ""
    txtHakkoubiY.Text = ""
    txtHakkoubiM.Text = ""
    txtHakkoubiD.Text = ""
    blnNoChangeEvFlg = False
    
    'åüçıèåè ì¸óÕâ¬
    txtKansaibiY.Enabled = True
    txtKansaibiM.Enabled = True
    txtSyainCD1.Enabled = True
    txtSyainCD2.Enabled = True
    
    'àÍóóï\ ÉNÉäÉA
    spdIchiran.MaxRows = 0
    
    'èâä˙ï\é¶èá
    cmdInitDisp.Enabled = False

    'àÛç¸ÅEÉvÉåÉrÉÖÅ[
    cmdPrint(0).Enabled = False
    cmdPrint(1).Enabled = False
    'èoóÕé“àÍóó
    cmdPrint2.Enabled = False

    'î≠çsì˙
    txtHakkoubiY.Enabled = False
    txtHakkoubiM.Enabled = False
    txtHakkoubiD.Enabled = False
    
    'àÛç¸WKÉeÅ[ÉuÉã
    bolwkTblEdit = False  'ñ¢çÏê¨
    
End Sub


'***********************************************************************************
'    éÊè¡
'***********************************************************************************
Private Sub subCancel()

    'âÊñ èâä˙âª
    Call subInitScreen
    
    'é¿çsÉ{É^Éì âüâ∫â¬
    cmdPFK(5).Enabled = True
    
    'ì¸óÕèåè äÆçœì˙ îN Ç…ÉtÉHÅ[ÉJÉX
    txtKansaibiY.SetFocus
    
End Sub







'***********************************************************************************
'    î≠çsì˙ ï“èW
'***********************************************************************************
Private Sub subHakkoubiEdit()
    Dim datTmp         As Date
    '---------------------------------
    
    'é–àıÉRÅ[ÉhéwÇ©ÅH
    If Trim$(mstrKeySyaincd2) <> "" Then
        'é–àıÉRÅ[ÉhÇéwíËÇµÇΩèÍçá
        'èâä˙ílÇÕÉVÉXÉeÉÄì˙ïtÇê›íË
        txtHakkoubiY.Text = Mid$(gstrSysDate, 1, 4)
        txtHakkoubiM.Text = Mid$(gstrSysDate, 5, 2)
        txtHakkoubiD.Text = Mid$(gstrSysDate, 7, 2)
        'ïœçX â¬
        txtHakkoubiY.Enabled = True
        txtHakkoubiM.Enabled = True
        txtHakkoubiD.Enabled = True
    Else
        'é–àıÉRÅ[ÉhÇéwíËÇµÇƒÇ¢Ç»Ç¢èÍçá
        'äÓèÄílÇê›íËÅiäÆçœì˙ÇÃéüåé + ÉRÅ[ÉhÉeÅ[ÉuÉãÇÃî≠çsì˙
        If IsDate(mstrKeyKansaibiFr) = True Then
            datTmp = DateAdd("m", 1, CDate(mstrKeyKansaibiFr))
            txtHakkoubiY.Text = Format(datTmp, "YYYY")
            txtHakkoubiM.Text = Format(datTmp, "MM")
            txtHakkoubiD.Text = gstrCdT_Hakkoubi
        End If
        'ïœçX ïsâ¬  Å¶é–àıÉRÅ[ÉhÇÃì¸óÕÇ™Ç≥ÇÍÇΩèÍçáÇÃåüçıÇÕÅAî≠çsì˙ÇïœçXÇ≈Ç´ÇÈ
        txtHakkoubiY.Enabled = False
        txtHakkoubiM.Enabled = False
        txtHakkoubiD.Enabled = False
    End If
    
End Sub

'***********************************************************************************
'    ì¸óÕÉ`ÉFÉbÉN
'      à¯Å@êîÅF Ç»Çµ
'      ï‘ãpílÅF Boolean  ÅF True=OK  False=NG
'***********************************************************************************
Private Function fncbolInputChk() As Boolean
    Dim intErrNo             As Integer
    
    Dim strTmp               As String
    Dim datTmp               As Date
    '-------------------------------------
    
    
    'èâä˙âª
    fncbolInputChk = False
    
    intErrNo = 0
    
    mstrKeyKansaibiFr = ""
    mstrKeyKansaibiTo = ""
    mstrKeySyaincd1 = ""
    mstrKeySyaincd2 = ""
    
    'åüçıèåèï\é¶ï“èW
    If Len(Trim$(txtKansaibiM.Text)) = 1 Then
        blnNoChangeEvFlg = True
        txtKansaibiM.Text = "0" & Trim$(txtKansaibiM.Text)
        blnNoChangeEvFlg = False
    End If
    
    'Å°Å°Å° äÆçœì˙ Å°Å°Å°
    strTmp = txtKansaibiY.Text & "/" & txtKansaibiM.Text & "/01"
    If IsDate(strTmp) = True Then
        'FROM
        mstrKeyKansaibiFr = Format(strTmp, "YYYY/MM/DD")
        'TO
        datTmp = CDate(mstrKeyKansaibiFr)
        datTmp = DateAdd("m", 1, datTmp)        'óÇåé1ì˙ÇÃéÊìæ
        datTmp = DateAdd("d", -1, datTmp)       'óÇåé1ì˙ÇÊÇËëOì˙ÇÃéÊìæ
        mstrKeyKansaibiTo = Format(datTmp, "YYYY/MM/DD")
    Else
        If Trim$(txtKansaibiY.Text) = "" And _
           Trim$(txtKansaibiM.Text) = "" Then
            'ñ¢ì¸óÕ
        Else
            'ERR
            intErrNo = 1
            GoTo fncbolInputChk_ERR
        End If
    End If
    
    'Å°Å°Å° é–àıÉRÅ[Éh Å°Å°Å°
    If Trim$(txtSyainCD1.Text) = "" And Trim$(txtSyainCD2.Text) = "" Then
        'ñ¢ì¸óÕ
    Else
        'é–àıÉRÅ[ÉhÇPÇÃÇ›ÇÕÉGÉâÅ[ Å¶é–àıÉRÅ[ÉhÇQÇÃÇ›ÇÕóLÇËÇ¶ÇÈ
        If Trim$(txtSyainCD2.Text) = "" Then
            'ERR
            intErrNo = 2
            GoTo fncbolInputChk_ERR
        Else
            mstrKeySyaincd1 = IIf(txtSyainCD1.Text = "", " ", txtSyainCD1.Text)
            mstrKeySyaincd2 = Trim$(txtSyainCD2.Text)
        End If
    End If
    
    'Å°Å°Å° ä÷òAÉ`ÉFÉbÉN Å°Å°Å°
    If mstrKeyKansaibiFr = "" And mstrKeySyaincd2 = "" Then
        'äÆçœì˙Åïé–àıÉRÅ[Éh ñ¢éwíË
        intErrNo = 3
        GoTo fncbolInputChk_ERR
    End If
    
    'OK
    fncbolInputChk = True
    
    Exit Function

fncbolInputChk_ERR:

    'âÊñ êßå‰ âèú
    Me.Enabled = True
    Screen.MousePointer = vbDefault
    

    Select Case intErrNo
        Case 1
            'äÆçœì˙ îNåéÉGÉâÅ[
            txtKansaibiY.BackColor = vbRed
            txtKansaibiM.BackColor = vbRed
            lblMsg.Caption = "WHOE01 " & gstrGetCodeMeisyo(odbDatabase, "E01", "WHO")  'Msg = ì¸óÕçÄñ⁄Ç…åÎÇËÇ™Ç†ÇËÇ‹Ç∑
            txtKansaibiY.SetFocus
        Case 2
            'é–àıÉRÅ[ÉhÇPÇÃÇ›ÉGÉâÅ[
            txtSyainCD1.BackColor = vbRed
            txtSyainCD2.BackColor = vbRed
            lblMsg.Caption = "WHOE01 " & gstrGetCodeMeisyo(odbDatabase, "E01", "WHO")  'Msg = ì¸óÕçÄñ⁄Ç…åÎÇËÇ™Ç†ÇËÇ‹Ç∑
            txtSyainCD2.SetFocus
        Case 3
            'äÆçœì˙Åïé–àıÉRÅ[Éh ñ¢éwíË
            txtKansaibiY.BackColor = vbRed
            txtKansaibiM.BackColor = vbRed
            txtSyainCD1.BackColor = vbRed
            txtSyainCD2.BackColor = vbRed
            lblMsg.Caption = "WHOE07 " & gstrGetCodeMeisyo(odbDatabase, "E07", "WHO")  'Msg = åüçıèåèÇì¸óÕÇµÇƒÇ≠ÇæÇ≥Ç¢
            txtKansaibiY.SetFocus
    End Select
    
    
End Function

'***********************************************************************************
'    î≠çsì˙É`ÉFÉbÉN
'      à¯Å@êîÅF Ç»Çµ
'      ï‘ãpílÅF Boolean  ÅF True=OK  False=NG
'***********************************************************************************
Private Function fncbolHakkoubiChk() As Boolean
    Dim strTmp               As String
    '-------------------------------------
    
    'èâä˙âª
    fncbolHakkoubiChk = False
    
    'î≠çsì˙
    strTmp = txtHakkoubiY.Text & "/" & txtHakkoubiM.Text & "/" & txtHakkoubiD.Text
    If IsDate(strTmp) = True Then
        mstrHakkoubi = Format(strTmp, "ggg eîNmåédì˙î≠çs")
    Else
        'ERR
        GoTo fncbolHakkoubiChk_ERR
    End If
    
    'OK
    fncbolHakkoubiChk = True
    
    Exit Function
    
fncbolHakkoubiChk_ERR:
    'ERR

    txtHakkoubiY.BackColor = vbRed
    txtHakkoubiM.BackColor = vbRed
    txtHakkoubiD.BackColor = vbRed
    lblMsg.Caption = "WHOE01 " & gstrGetCodeMeisyo(odbDatabase, "E01", "WHO")  'Msg = ì¸óÕçÄñ⁄Ç…åÎÇËÇ™Ç†ÇËÇ‹Ç∑
    txtHakkoubiY.SetFocus
    
End Function


'***********************************************************************************
'    ÉGÉâÅ[âèú
'***********************************************************************************
Private Sub subErrCrear()

    '¥◊∞“Øæ∞ºﬁ∏ÿ±
    lblMsg.Caption = ""
    
    '¥◊∞çÄñ⁄BackcolorÇñﬂÇ∑
    txtKansaibiY.BackColor = vbWhite
    txtKansaibiM.BackColor = vbWhite
    txtSyainCD1.BackColor = vbWhite
    txtSyainCD2.BackColor = vbWhite
    
    txtHakkoubiY.BackColor = vbWhite
    txtHakkoubiM.BackColor = vbWhite
    txtHakkoubiD.BackColor = vbWhite
    
End Sub


'***********************************************************************************
'    àÍóóópÉfÅ[É^éÊìæ SP î≠çs
'        ï‘ãpílÅFBoolean       True=OK     False=NG
'***********************************************************************************
Private Function fncblnListSel() As Boolean
    Dim strSQL               As String
    Dim lngSprStartCnt       As Long
    Dim lngSprEndCnt         As Long
    Dim i                    As Long
    Dim lngSpCnt             As Long
    
    Const cnslngAryLen       As Long = 150   'îzóÒÇÃç≈ëÂåÖêî
    Const cnslngAryCnt       As Long = 35    'îzóÒÇÃåèêî  ãyÇ—ÅAÇPâÒÇ≈éÊìæÇ∑ÇÈÇlÇ`ÇwÇÃåèêî
    '----------------------------------------------

On Error GoTo fncblnListSel_ERR
    
    'èâä˙âª
    fncblnListSel = False

    lngSpCnt = 0

    'àÍóóéÊìæ ÇrÇo
    'Å°01Å° åüçıèåè äÆçœì˙FROM
    odbDatabase.Parameters.Add "InStrKansaibiFr", mstrKeyKansaibiFr, ORAPARM_INPUT
    odbDatabase.Parameters("InStrKansaibiFr").ServerType = ORATYPE_VARCHAR2
    'Å°02Å°Å@ Å@Å@Å@ äÆçœì˙To
    odbDatabase.Parameters.Add "InStrKansaibiTo", mstrKeyKansaibiTo, ORAPARM_INPUT
    odbDatabase.Parameters("InStrKansaibiTo").ServerType = ORATYPE_VARCHAR2
    'Å°03Å° Å@Å@Å@Å@ é–àıÉRÅ[ÉhÇP
    odbDatabase.Parameters.Add "InStrSyainCd1", mstrKeySyaincd1, ORAPARM_INPUT
    odbDatabase.Parameters("InStrSyainCd1").ServerType = ORATYPE_VARCHAR2
    'Å°04Å° Å@Å@Å@Å@ é–àıÉRÅ[ÉhÇQ
    odbDatabase.Parameters.Add "InStrSyainCd2", mstrKeySyaincd2, ORAPARM_INPUT
    odbDatabase.Parameters("InStrSyainCd2").ServerType = ORATYPE_VARCHAR2
    
    'Å°05Å° ç≈ëÂîzóÒäiî[åèêî
    odbDatabase.Parameters.Add "InNumMaxRec", cnslngAryCnt, ORAPARM_INPUT
    odbDatabase.Parameters("InNumMaxRec").ServerType = ORATYPE_NUMBER
    'Å°06Å° èàóù∂≥›ƒ
    odbDatabase.Parameters.Add "IoNumFetchCount", 0, ORAPARM_BOTH
    odbDatabase.Parameters("IoNumFetchCount").ServerType = ORATYPE_NUMBER
    'Å°07Å° ÉJÅ[É\ÉãÇhÇc
    odbDatabase.Parameters.Add "IoNumCursor", 0, ORAPARM_BOTH
    odbDatabase.Parameters("IoNumCursor").ServerType = ORATYPE_NUMBER
    'Å°08Å° ëçåüçıåèêî
    odbDatabase.Parameters.Add "IoNumRecCount", 0, ORAPARM_BOTH
    odbDatabase.Parameters("IoNumRecCount").ServerType = ORATYPE_NUMBER
    'Å°09Å° ⁄∫∞ƒﬁ∂≥›ƒ
    odbDatabase.Parameters.Add "OtNumAryCount", 0, ORAPARM_OUTPUT
    odbDatabase.Parameters("OtNumAryCount").ServerType = ORATYPE_NUMBER
    'Å°10Å° EndFlg
    odbDatabase.Parameters.Add "OtStrEndFlg", "0", ORAPARM_OUTPUT
    odbDatabase.Parameters("OtStrEndFlg").ServerType = ORATYPE_VARCHAR2
    'Å°11Å° ÉfÅ[É^îzóÒ
    odbDatabase.Parameters.AddTable "OtStrDataAry", ORAPARM_OUTPUT, ORATYPE_VARCHAR2, cnslngAryCnt, cnslngAryLen    '200çsÅE150åÖ
    
    strSQL = ""
    strSQL = strSQL & "BEGIN QPAP_CEnt410PKG.QPAP_CEnt410ListSel("
    strSQL = strSQL & ":InStrKansaibiFr,"               '01 äÆçœì˙From
    strSQL = strSQL & ":InStrKansaibiTo,"               '02 äÆçœì˙To
    strSQL = strSQL & ":InStrSyainCd1,"                 '03 é–àıÉRÅ[ÉhÇP
    strSQL = strSQL & ":InStrSyainCd2,"                 '04 é–àıÉRÅ[ÉhÇQ
    strSQL = strSQL & ":InNumMaxRec,"                   '05 ç≈ëÂîzóÒäiî[åèêî
    strSQL = strSQL & ":IoNumFetchCount,"               '06 èàóù∂≥›ƒ
    strSQL = strSQL & ":IoNumCursor,"                   '07 ÉJÅ[É\ÉãÇhÇc
    strSQL = strSQL & ":IoNumRecCount,"                 '08 ëçåüçıåèêî
    strSQL = strSQL & ":OtNumAryCount,"                 '09 ⁄∫∞ƒﬁ∂≥›ƒ
    strSQL = strSQL & ":OtStrEndFlg,"                   '10 EndFlg
    strSQL = strSQL & ":OtStrDataAry"                   '11 ÉfÅ[É^îzóÒ
    strSQL = strSQL & "); END;"
    
    i = 1               'ïœêîÇÃÉNÉäÉA
    lngSprStartCnt = 0
    lngSprEndCnt = 0
  
    spdIchiran.ReDraw = False
    Do
        'àÍóóÇÃéÊìæ
        odbDatabase.DbexecuteSQL (strSQL)

        If i = 1 Then
            If odbDatabase.Parameters("IoNumRecCount").Value = 0 Then     'äYìñÉfÅ[É^Ç»Çµ
                'ÉIÉuÉWÉFÉNÉgÇÃäJï˙
                Call gsubParaRemove(odbDatabase)
                'ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWï\é¶*****Msg=äYìñÇ∑ÇÈÉfÅ[É^Ç™Ç†ÇËÇ‹ÇπÇÒ
                lblMsg.Caption = "WHOE02 " & gstrGetCodeMeisyo(odbDatabase, "E02", "WHO")
                spdIchiran.ReDraw = True
                Exit Function
            End If
            spdIchiran.MaxRows = odbDatabase.Parameters("IoNumRecCount").Value   'àÍóóÇÃçsêîê›íË
        End If
        
        'àÍóóÇÃÉfÅ[É^ì‡óeÇê›íËÇ∑ÇÈäJénà íu
        lngSprStartCnt = (i - 1) * cnslngAryCnt + 1
        
        'àÍóóÇÃèIóπà íu
        lngSprEndCnt = lngSprEndCnt + CLng(odbDatabase.Parameters("OtNumAryCount").Value)
        
        'àÍóóï\ çÄñ⁄ÉZÉbÉg
        Call subItiranDsp(lngSprStartCnt, lngSprEndCnt)
        
        i = i + 1
    
    Loop Until odbDatabase.Parameters("OtStrEndFlg").Value = "1"

    'çƒï`âÊ
    spdIchiran.ReDraw = True

    'ÉIÉuÉWÉFÉNÉgÇÃäJï˙
    Call gsubParaRemove(odbDatabase)
    
    'åüçıï\é¶ OK
    fncblnListSel = True
    
    Exit Function

fncblnListSel_ERR:
'ÉGÉâÅ[èàóù
    
    'ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWï\é¶
    Call gsubDBErrorMessage(gstrCommandLine(8), gcstrPrjName, _
                           gstrCommandLine(3), gstrCommandLine(5), gstrGetErrDateFormat)
    'ÉIÉuÉWÉFÉNÉgÇÃäJï˙
    Call gsubParaRemove(odbDatabase)

End Function

'***********************************************************************************
'    àÍóóÇï\é¶
'        à¯êîÅF lngStCnt  ÅF Long    ÅF àÍóóÇÃäJénà íu
'        Å@Å@Å@ lngEdCnt  ÅF Long    ÅF àÍóóÇÃèIóπà íu
'***********************************************************************************
Private Sub subItiranDsp(lngStCnt As Long, lngEdCnt As Long)
    Dim i                  As Long
    Dim j                  As Long
    Dim k                  As Long
    Dim strDetail          As String
    Dim strValue           As String
    Dim strTmp             As String
    Dim strTmp1            As String
    Dim strTmp2            As String
    '----------------------------------------------
    
    With spdIchiran
        
        j = 0
        For i = lngStCnt To lngEdCnt
        
            'ñæç◊
            strDetail = odbDatabase.Parameters("OtStrDataAry").Get_Value(j)
            j = j + 1
            
            'Åy01Åz ìåêºãÊï™
            strValue = Trim$(gfncstrDlm2(strDetail, 9))
            Select Case strValue
                Case "1": strTmp = "ìå"
                Case "2": strTmp = "êº"
            End Select
            .SetText 1, i, strTmp
            
            'Åy02Åz é–àıÉRÅ[Éh  Å¶é–àıÉRÅ[ÉhÇPÅ{é–àıÉRÅ[ÉhÇQ
            strTmp1 = Trim$(gfncstrDlm2(strDetail, 1))
            strTmp2 = Trim$(gfncstrDlm2(strDetail, 2))
            strTmp = IIf(strTmp1 = "", " ", strTmp1) & strTmp2
            .SetText 2, i, strTmp
            .SetText 9, i, IIf(strTmp1 = "", " ", strTmp1)    'âBÇµ é–àıÉRÅ[ÉhÇP
            .SetText 10, i, strTmp2                           'âBÇµ é–àıÉRÅ[ÉhÇQ
            
            'Åy03Åz éÅñº
            strTmp1 = Trim$(gfncstrDlm2(strDetail, 6))    'ÉJÉiéÅñº
            strTmp2 = Trim$(gfncstrDlm2(strDetail, 7))    'äøéöéÅñº
            If Trim$(strTmp2) = "" Then
                strTmp = Trim$(strTmp1)
            Else
                strTmp = Trim$(strTmp2)
            End If
            .SetText 3, i, strTmp
            
            'Åy04Åz èäëÆìX  Å¶èäëÆìXÉRÅ[Éh & èäëÆìXñº
            strTmp1 = Trim$(gfncstrDlm2(strDetail, 8))
            strTmp2 = Trim$(gfncstrDlm2(strDetail, 11))
            strTmp = strTmp1 & " " & strTmp2
            .SetText 4, i, strTmp
            .SetText 11, i, strTmp1                           'âBÇµ èäëÆìXÉRÅ[Éh
            .SetText 12, i, strTmp2                           'âBÇµ èäëÆìXñº
            
            'Åy05Åz èäëÆïîñÂ  Å¶èäëÆïîñÂÉRÅ[Éh & èäëÆïîñÂñº
            strTmp1 = Trim$(gfncstrDlm2(strDetail, 10))
            strTmp2 = Trim$(gfncstrDlm2(strDetail, 12))
            strTmp = strTmp1 & " " & strTmp2
            .SetText 5, i, strTmp
            .SetText 13, i, strTmp1                           'âBÇµ èäëÆïîñÂÉRÅ[Éh
            .SetText 14, i, strTmp2                           'âBÇµ èäëÆïîñÂñº
            
            'Åy06Åz óZéëì˙
            strValue = Trim$(gfncstrDlm2(strDetail, 3))
            .SetText 6, i, strValue
            
            'Åy07Åz óZéëã‡äz
            strValue = Trim$(gfncstrDlm2(strDetail, 5))
            strTmp = ""
            If IsNumeric(strValue) = True Then
                strTmp = Format(strValue, "#,###,##0")
            End If
            .SetText 7, i, strTmp
            
            'Åy08Åz äÆçœì˙
            strValue = Trim$(gfncstrDlm2(strDetail, 4))
            .SetText 8, i, strValue
            
        Next i
    End With

End Sub


'***********************************************************************************
'    àÛç¸ÉfÅ[É^çÏê¨ SP î≠çs
'        ï‘ãpílÅFBoolean       True=OK     False=NG
'***********************************************************************************
Private Function fncblnPrintDataEdit() As Boolean
    Dim strSQL               As String
    Dim i                    As Long
    Dim strTmpY              As String
    Dim strTmpM              As String
    Dim strTmpD              As String
    Dim datTmp               As Date
    Dim strTmp               As String
    
    Dim lngArySetCnt         As Long        'îzóÒäiî[åèêîÉJÉEÉìÉ^Å[
    
    Dim str411Title          As String      'äÆçœí ímèoóÕé“àÍóó É^ÉCÉgÉã
    
    Dim OraPArray1           As Object      '01 é–àıÉRÅ[ÉhÇP
    Dim OraPArray2           As Object      '02 é–àıÉRÅ[ÉhÇQ
    Dim OraPArray3           As Object      '03 óZéëì˙
    Dim OraPArray4           As Object      '04 óZéëì˙ÅiòaóÔÅj
    Dim OraPArray5           As Object      '05 ï\é¶ópé–àıéÅñº
    Dim OraPArray6           As Object      '06 èäëÆìXÉRÅ[Éh
    Dim OraPArray7           As Object      '07 èäëÆìXñºèÃ
    Dim OraPArray8           As Object      '08 ìåêºãÊï™
    Dim OraPArray9           As Object      '09 èäëÆïîñÂÉRÅ[Éh
    Dim OraPArray10          As Object      '10 èäëÆïîñÂñºèÃ
    Dim OraPArray11          As Object      '11 óZéëã‡äz
    Dim OraPArray12          As Object      '12 äÆçœì˙
    Dim OraPArray13          As Object      '13 äÆçœì˙ÅiòaóÔÅj
    
    Const cnslngKeta1        As Long = 1    '01 é–àıÉRÅ[ÉhÇP
    Const cnslngKeta2        As Long = 7    '02 é–àıÉRÅ[ÉhÇQ
    Const cnslngKeta3        As Long = 10   '03 óZéëì˙
    Const cnslngKeta4        As Long = 20   '04 óZéëì˙ÅiòaóÔÅj
    Const cnslngKeta5        As Long = 30   '05 ï\é¶ópé–àıéÅñº
    Const cnslngKeta6        As Long = 3    '06 èäëÆìXÉRÅ[Éh
    Const cnslngKeta7        As Long = 24   '07 èäëÆìXñºèÃ
    Const cnslngKeta8        As Long = 2    '08 ìåêºãÊï™
    Const cnslngKeta9        As Long = 6    '09 èäëÆïîñÂÉRÅ[Éh
    Const cnslngKeta10       As Long = 24   '10 èäëÆïîñÂñºèÃ
    Const cnslngKeta11       As Long = 13   '11 óZéëã‡äz
    Const cnslngKeta12       As Long = 10   '12 äÆçœì˙
    Const cnslngKeta13       As Long = 20   '13 äÆçœì˙ÅiòaóÔÅj
    
    Const cnslngAryCnt       As Long = 2
    '----------------------------------------------

On Error GoTo fncblnPrintDataEdit_ERR
    
    'èâä˙âª
    fncblnPrintDataEdit = False
    
    'ëŒè€é“àÍóó(411)ópÉ^ÉCÉgÉã ï“èW  Å¶åüçıèåèÇÃäÆçœì˙ÇÃéüåé
    strTmpY = "Å@Å@Å@Å@"
    strTmpM = "Å@Å@"
    If IsDate(mstrKeyKansaibiFr) = True Then
        datTmp = DateAdd("m", 1, CDate(mstrKeyKansaibiFr))
        strTmpY = StrConv(Format(datTmp, "YYYY"), vbWide)
        strTmpM = StrConv(Format(datTmp, "M"), vbWide)
        str411Title = strTmpY & "îN" & _
                      IIf(Len(strTmpM) = 1, "Å@" & strTmpM, strTmpM) & "åéìx äÆçœí ímèoóÕé“àÍóó"
    Else
        str411Title = ""
    End If

    'àÛç¸ÉfÅ[É^çÏê¨ ÇrÇo
    'Å°01Å° ÉIÉyÉåÅ[É^ID
    odbDatabase.Parameters.Add "InStrOperatorID", gstrCommandLine(1), ORAPARM_INPUT
    odbDatabase.Parameters("InStrOperatorID").ServerType = ORATYPE_VARCHAR2
    'Å°02Å° í[ññID
    odbDatabase.Parameters.Add "InStrComputerMei", gstrCommandLine(5), ORAPARM_INPUT
    odbDatabase.Parameters("InStrComputerMei").ServerType = ORATYPE_VARCHAR2
    
    'Å°03Å° îzóÒäiî[åèêî
    'îzóÒåèêî
    odbDatabase.Parameters.Add "InNumAryCount", 0, ORAPARM_INPUT    'ç≈èâÇÕÇOÇê›íË CALLëOÇ…åèêîÇê›íË
    odbDatabase.Parameters("InNumAryCount").ServerType = ORATYPE_NUMBER
    
    'ïœìÆçÄñ⁄  Å¶îzóÒìnÇµ
    'Å°04Å° îzóÒ01 é–àıÉRÅ[ÉhÇP
    odbDatabase.Parameters.AddTable "InStrSyainCd1Ary", ORAPARM_INPUT, ORATYPE_VARCHAR2, cnslngAryCnt, cnslngKeta1
    Set OraPArray1 = odbDatabase.Parameters("InStrSyainCd1Ary")
    'Å°05Å° îzóÒ02 é–àıÉRÅ[ÉhÇQ
    odbDatabase.Parameters.AddTable "InStrSyainCd2Ary", ORAPARM_INPUT, ORATYPE_VARCHAR2, cnslngAryCnt, cnslngKeta2
    Set OraPArray2 = odbDatabase.Parameters("InStrSyainCd2Ary")
    'Å°06Å° îzóÒ03 óZéëì˙
    odbDatabase.Parameters.AddTable "InStrYushibiAry", ORAPARM_INPUT, ORATYPE_VARCHAR2, cnslngAryCnt, cnslngKeta3
    Set OraPArray3 = odbDatabase.Parameters("InStrYushibiAry")
    'Å°07Å° îzóÒ04 óZéëì˙ÅiòaóÔÅj
    odbDatabase.Parameters.AddTable "InStrYushibiWaAry", ORAPARM_INPUT, ORATYPE_VARCHAR2, cnslngAryCnt, cnslngKeta4
    Set OraPArray4 = odbDatabase.Parameters("InStrYushibiWaAry")
    'Å°08Å° îzóÒ05 ï\é¶ópé–àıéÅñº
    odbDatabase.Parameters.AddTable "InStrDispNmAry", ORAPARM_INPUT, ORATYPE_VARCHAR2, cnslngAryCnt, cnslngKeta5
    Set OraPArray5 = odbDatabase.Parameters("InStrDispNmAry")
    'Å°09Å° îzóÒ06 èäëÆìXÉRÅ[Éh
    odbDatabase.Parameters.AddTable "InStrTenCdAry", ORAPARM_INPUT, ORATYPE_VARCHAR2, cnslngAryCnt, cnslngKeta6
    Set OraPArray6 = odbDatabase.Parameters("InStrTenCdAry")
    'Å°10Å° îzóÒ07 èäëÆìXñºèÃ
    odbDatabase.Parameters.AddTable "InStrTenNmAry", ORAPARM_INPUT, ORATYPE_VARCHAR2, cnslngAryCnt, cnslngKeta7
    Set OraPArray7 = odbDatabase.Parameters("InStrTenNmAry")
    'Å°11Å° îzóÒ08 ìåêºãÊï™
    odbDatabase.Parameters.AddTable "InStrTozaiAry", ORAPARM_INPUT, ORATYPE_VARCHAR2, cnslngAryCnt, cnslngKeta8
    Set OraPArray8 = odbDatabase.Parameters("InStrTozaiAry")
    'Å°12Å° îzóÒ09 èäëÆïîñÂÉRÅ[Éh
    odbDatabase.Parameters.AddTable "InStrBumonCdAry", ORAPARM_INPUT, ORATYPE_VARCHAR2, cnslngAryCnt, cnslngKeta9
    Set OraPArray9 = odbDatabase.Parameters("InStrBumonCdAry")
    'Å°13Å° îzóÒ10 èäëÆïîñÂñºèÃ
    odbDatabase.Parameters.AddTable "InStrBumonNmAry", ORAPARM_INPUT, ORATYPE_VARCHAR2, cnslngAryCnt, cnslngKeta10
    Set OraPArray10 = odbDatabase.Parameters("InStrBumonNmAry")
    'Å°14Å° îzóÒ11 óZéëã‡äz
    odbDatabase.Parameters.AddTable "InStrYushiKngAry", ORAPARM_INPUT, ORATYPE_VARCHAR2, cnslngAryCnt, cnslngKeta11
    Set OraPArray11 = odbDatabase.Parameters("InStrYushiKngAry")
    'Å°15Å° îzóÒ12 äÆçœì˙
    odbDatabase.Parameters.AddTable "InStrKansaibiAry", ORAPARM_INPUT, ORATYPE_VARCHAR2, cnslngAryCnt, cnslngKeta12
    Set OraPArray12 = odbDatabase.Parameters("InStrKansaibiAry")
    'Å°16Å° îzóÒ13 äÆçœì˙ÅiòaóÔÅj
    odbDatabase.Parameters.AddTable "InStrKansaibiWaAry", ORAPARM_INPUT, ORATYPE_VARCHAR2, cnslngAryCnt, cnslngKeta13
    Set OraPArray13 = odbDatabase.Parameters("InStrKansaibiWaAry")
    
    'å≈íËçÄñ⁄
    'Å°17Å° Å@Å@Å@Å@ î≠çsì˙ÅiäÆçœí ímópÅj
    odbDatabase.Parameters.Add "InStrHakkoubi", mstrHakkoubi, ORAPARM_INPUT
    odbDatabase.Parameters("InStrHakkoubi").ServerType = ORATYPE_VARCHAR2
    'Å°18Å° Å@Å@Å@Å@ î≠çsé“èÓïÒÇPÅiäÆçœí ímópÅj
    odbDatabase.Parameters.Add "InStrHakkouInfo1", gtblCdT_Hakkousya(1).Meisyou, ORAPARM_INPUT
    odbDatabase.Parameters("InStrHakkouInfo1").ServerType = ORATYPE_VARCHAR2
    'Å°19Å° Å@Å@Å@Å@ î≠çsé“èÓïÒÇQÅiäÆçœí ímópÅj
    odbDatabase.Parameters.Add "InStrHakkouInfo2", gtblCdT_Hakkousya(2).Meisyou, ORAPARM_INPUT
    odbDatabase.Parameters("InStrHakkouInfo2").ServerType = ORATYPE_VARCHAR2
    'Å°20Å° Å@Å@Å@Å@ î≠çsé“èÓïÒÇRÅiäÆçœí ímópÅj
    odbDatabase.Parameters.Add "InStrHakkouInfo3", gtblCdT_Hakkousya(3).Meisyou, ORAPARM_INPUT
    odbDatabase.Parameters("InStrHakkouInfo3").ServerType = ORATYPE_VARCHAR2
    'Å°21Å° Å@Å@Å@Å@ î≠çsé“èÓïÒÇSÅiäÆçœí ímópÅj
    odbDatabase.Parameters.Add "InStrHakkouInfo4", gtblCdT_Hakkousya(4).Meisyou, ORAPARM_INPUT
    odbDatabase.Parameters("InStrHakkouInfo4").ServerType = ORATYPE_VARCHAR2
    'Å°22Å° Å@Å@Å@Å@ ÉçÅ[ÉìñºèÃÅiäÆçœí ímópÅj
    odbDatabase.Parameters.Add "InStrLoanNm", gstrCdT_LoanNm, ORAPARM_INPUT
    odbDatabase.Parameters("InStrLoanNm").ServerType = ORATYPE_VARCHAR2
    'Å°23Å° Å@Å@Å@Å@ äÆçœí ímèoóÕé“àÍóóÉ^ÉCÉgÉã
    odbDatabase.Parameters.Add "InStrTitle", str411Title, ORAPARM_INPUT
    odbDatabase.Parameters("InStrTitle").ServerType = ORATYPE_VARCHAR2
    
    'Å°23Å° çÌèúÉtÉâÉO ÇrÇo1âÒñ⁄ÇÃÇ›çÌèúÅiÅhÇPÅhÅj
    odbDatabase.Parameters.Add "InStrDeleteFlg", "1", ORAPARM_INPUT
    odbDatabase.Parameters("InStrDeleteFlg").ServerType = ORATYPE_CHAR
    
    'SQLï∂ ï“èW
    strSQL = ""
    strSQL = strSQL & "BEGIN QPAP_CEnt410PKG.QPAP_CEnt410InsWkTbl("
    strSQL = strSQL & ":InStrOperatorID,"               '01 ÉIÉyÉåÅ[É^ID
    strSQL = strSQL & ":InStrComputerMei,"              '02 í[ññID
    
    strSQL = strSQL & ":InNumAryCount,"                 '03 îzóÒäiî[åèêî
    strSQL = strSQL & ":InStrSyainCd1Ary,"              '04 é–àıÉRÅ[ÉhÇP
    strSQL = strSQL & ":InStrSyainCd2Ary,"              '05 é–àıÉRÅ[ÉhÇQ
    strSQL = strSQL & ":InStrYushibiAry,"               '06 óZéëì˙
    strSQL = strSQL & ":InStrYushibiWaAry,"             '07 óZéëì˙ÅiòaóÔÅj
    strSQL = strSQL & ":InStrDispNmAry,"                '08 ï\é¶ópé–àıéÅñº
    strSQL = strSQL & ":InStrTenCdAry,"                 '09 èäëÆìXÉRÅ[Éh
    strSQL = strSQL & ":InStrTenNmAry,"                 '10 èäëÆìXñºèÃ
    strSQL = strSQL & ":InStrTozaiAry,"                 '11 ìåêºãÊï™
    strSQL = strSQL & ":InStrBumonCdAry,"               '12 èäëÆïîñÂÉRÅ[Éh
    strSQL = strSQL & ":InStrBumonNmAry,"               '13 èäëÆïîñÂñºèÃ
    strSQL = strSQL & ":InStrYushiKngAry,"              '14 óZéëã‡äz
    strSQL = strSQL & ":InStrKansaibiAry,"              '15 äÆçœì˙
    strSQL = strSQL & ":InStrKansaibiWaAry,"            '16 äÆçœì˙ÅiòaóÔÅj
    
    strSQL = strSQL & ":InStrHakkoubi,"                 '17 î≠çsì˙ÅiäÆçœí ímópÅj
    strSQL = strSQL & ":InStrHakkouInfo1,"              '18 î≠çsé“èÓïÒÇPÅiäÆçœí ímópÅj
    strSQL = strSQL & ":InStrHakkouInfo2,"              '19 î≠çsé“èÓïÒÇQÅiäÆçœí ímópÅj
    strSQL = strSQL & ":InStrHakkouInfo3,"              '20 î≠çsé“èÓïÒÇRÅiäÆçœí ímópÅj
    strSQL = strSQL & ":InStrHakkouInfo4,"              '21 î≠çsé“èÓïÒÇSÅiäÆçœí ímópÅj
    strSQL = strSQL & ":InStrLoanNm,"                   '22 ÉçÅ[ÉìñºèÃÅiäÆçœí ímópÅj
    strSQL = strSQL & ":InStrTitle,"                    '23 äÆçœí ímèoóÕé“àÍóóÉ^ÉCÉgÉã
    strSQL = strSQL & ":InStrDeleteFlg "                '24 äÆçœí ímèoóÕé“àÍóóÉ^ÉCÉgÉã
    strSQL = strSQL & "); END;"
    
    
    'àÍóóåèêîï™LOOP
    lngArySetCnt = 1
    For i = 1 To spdIchiran.MaxRows
        
        '04 é–àıÉRÅ[ÉhÇP
        strTmp = gVarSpdGetText(spdIchiran, 9, i)
        OraPArray1.Put_value Mid$(strTmp, 1, 1), lngArySetCnt - 1
        '05 é–àıÉRÅ[ÉhÇQ
        strTmp = gVarSpdGetText(spdIchiran, 10, i)
        OraPArray2.Put_value Mid$(strTmp, 1, 7), lngArySetCnt - 1
        '06 óZéëì˙
        strTmp = gVarSpdGetText(spdIchiran, 6, i)
        If IsDate(strTmp) = False Then
            strTmp = ""
        End If
        OraPArray3.Put_value strTmp, lngArySetCnt - 1
        '07 óZéëì˙ÅiòaóÔÅj
        If IsDate(strTmp) = True Then
            strTmpY = Trim$(Format(strTmp, "e"))
            strTmpM = Trim$(Format(strTmp, "m"))
            strTmpD = Trim$(Format(strTmp, "d"))
            strTmp = Format(strTmp, "ggg") & " " & _
                     IIf(Len(strTmpY) = 1, Space(1) & strTmpY & "îN", strTmpY & "îN") & _
                     IIf(Len(strTmpM) = 1, Space(1) & strTmpM & "åé", strTmpM & "åé") & _
                     IIf(Len(strTmpD) = 1, Space(1) & strTmpD & "ì˙", strTmpD & "ì˙")
        End If
        OraPArray4.Put_value strTmp, lngArySetCnt - 1
        '08 ï\é¶ópé–àıéÅñº
        strTmp = gVarSpdGetText(spdIchiran, 3, i)
        OraPArray5.Put_value Trim$(strTmp), lngArySetCnt - 1
        '09 èäëÆìXÉRÅ[Éh
        strTmp = gVarSpdGetText(spdIchiran, 11, i)
        OraPArray6.Put_value Mid$(strTmp, 1, 3), lngArySetCnt - 1
        '10 èäëÆìXñºèÃ
        strTmp = gVarSpdGetText(spdIchiran, 12, i)
        OraPArray7.Put_value Trim$(strTmp), lngArySetCnt - 1
        '11 ìåêºãÊï™
        strTmp = gVarSpdGetText(spdIchiran, 1, i)
        OraPArray8.Put_value Trim$(strTmp), lngArySetCnt - 1
        '12 èäëÆïîñÂÉRÅ[Éh
        strTmp = gVarSpdGetText(spdIchiran, 13, i)
        OraPArray9.Put_value Mid$(strTmp, 1, 6), lngArySetCnt - 1
        '13 èäëÆïîñÂñºèÃ
        strTmp = gVarSpdGetText(spdIchiran, 14, i)
        OraPArray10.Put_value Trim$(strTmp), lngArySetCnt - 1
        '14 óZéëã‡äz
        strTmp = gVarSpdGetText(spdIchiran, 7, i)
        If IsNumeric(strTmp) = True Then
            strTmp = "\" & fncstrMojiEdit(Format(strTmp, "#,##0"), 12, 0) 'SPACEïtâ¡ÅiëOÅj
        Else
            strTmp = ""
        End If
        OraPArray11.Put_value strTmp, lngArySetCnt - 1
        '15 äÆçœì˙
        strTmp = gVarSpdGetText(spdIchiran, 8, i)
        If IsDate(strTmp) = False Then
            strTmp = ""
        End If
        OraPArray12.Put_value strTmp, lngArySetCnt - 1
        '16 äÆçœì˙ÅiòaóÔÅj
        If IsDate(strTmp) = True Then
            strTmpY = Trim$(Format(strTmp, "e"))
            strTmpM = Trim$(Format(strTmp, "m"))
            strTmpD = Trim$(Format(strTmp, "d"))
            strTmp = Format(strTmp, "ggg") & " " & _
                     IIf(Len(strTmpY) = 1, Space(1) & strTmpY & "îN", strTmpY & "îN") & _
                     IIf(Len(strTmpM) = 1, Space(1) & strTmpM & "åé", strTmpM & "åé") & _
                     IIf(Len(strTmpD) = 1, Space(1) & strTmpD & "ì˙", strTmpD & "ì˙")
        End If
        OraPArray13.Put_value strTmp, lngArySetCnt - 1
        
        
        'îzóÒåèêîÇÃílÉZÉbÉg
        odbDatabase.Parameters("InNumAryCount").Value = lngArySetCnt
        
        If lngArySetCnt >= cnslngAryCnt Or _
           i = spdIchiran.MaxRows Then
            'ç≈ëÂåèêîÇ…íBÇµÇΩÇÃÇ≈SPÇCALL
            'SP é¿çs
            odbDatabase.DbexecuteSQL (strSQL)
        
            'çÌèúÉtÉâÉOÇÃílÇÃÉäÉZÉbÉg
            odbDatabase.Parameters("InStrDeleteFlg").Value = "0"
        
            lngArySetCnt = 1
        Else
            lngArySetCnt = lngArySetCnt + 1
        End If
    Next i
        
        
    
    
    'ÉIÉuÉWÉFÉNÉgÇÃäJï˙
    Call gsubParaRemove(odbDatabase)
    
    'àÛç¸ÉfÅ[É^çÏê¨ OK
    fncblnPrintDataEdit = True
    
    Exit Function

fncblnPrintDataEdit_ERR:
'ÉGÉâÅ[èàóù
    
    'ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWï\é¶
    Call gsubDBErrorMessage(gstrCommandLine(8), gcstrPrjName, _
                           gstrCommandLine(3), gstrCommandLine(5), gstrGetErrDateFormat)
    'ÉIÉuÉWÉFÉNÉgÇÃäJï˙
    Call gsubParaRemove(odbDatabase)

End Function

'***********************************************************************************
'    àÛç¸ÉfÅ[É^çÌèú SP î≠çs
'        ï‘ãpílÅFBoolean       True=OK     False=NG
'***********************************************************************************
Private Function fncblnPrintDataDel() As Boolean
    Dim strSQL               As String
    '----------------------------------------------

On Error GoTo fncblnPrintDataDel_ERR
    
    'èâä˙âª
    fncblnPrintDataDel = False

    'àÛç¸ÉfÅ[É^çÏê¨ ÇrÇo
    'Å°01Å° ÉIÉyÉåÅ[É^ID
    odbDatabase.Parameters.Add "InStrOperatorID", gstrCommandLine(1), ORAPARM_INPUT
    odbDatabase.Parameters("InStrOperatorID").ServerType = ORATYPE_VARCHAR2
    'Å°02Å° í[ññID
    odbDatabase.Parameters.Add "InStrComputerMei", gstrCommandLine(5), ORAPARM_INPUT
    odbDatabase.Parameters("InStrComputerMei").ServerType = ORATYPE_VARCHAR2
    
    strSQL = ""
    strSQL = strSQL & "BEGIN QPAP_CEnt410PKG.QPAP_CEnt410DelWkTbl("
    strSQL = strSQL & ":InStrOperatorID,"               '01 ÉIÉyÉåÅ[É^ID
    strSQL = strSQL & ":InStrComputerMei "              '02 í[ññID
    strSQL = strSQL & "); END;"
    
    'SP é¿çs
    odbDatabase.DbexecuteSQL (strSQL)

    'ÉIÉuÉWÉFÉNÉgÇÃäJï˙
    Call gsubParaRemove(odbDatabase)
    
    'àÛç¸ÉfÅ[É^çÏê¨ OK
    fncblnPrintDataDel = True
    
    Exit Function

fncblnPrintDataDel_ERR:
'ÉGÉâÅ[èàóù
    
    'ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWï\é¶
    Call gsubDBErrorMessage(gstrCommandLine(8), gcstrPrjName, _
                           gstrCommandLine(3), gstrCommandLine(5), gstrGetErrDateFormat)
    'ÉIÉuÉWÉFÉNÉgÇÃäJï˙
    Call gsubParaRemove(odbDatabase)

End Function



'***********************************************************************************
'    ÉNÉäÉXÉ^ÉãÉåÉ|Å[Ég ÉvÉåÉrÉÖÅ[ÅEàÛç¸ÅiäÆçœí ímÅj
'        ï‘ãpílÅFBoolean       True=OK     False=NG
'***********************************************************************************
Private Sub sub410PrintRep(intDestinationConstants As DestinationConstants)
    Dim strJoken                As String
    Dim strConectPoint          As String
    Dim intRet                  As Integer
    '--------------------------------------------
    
On Error GoTo sub410PrintRep_ERR

    With CrystalReport
        'ÉAÉNÉZÉXÇ∑ÇÈÉfÅ[É^ÉxÅ[ÉXÇ»Ç«ÇãLèq
        strConectPoint = "  DSN = " & gstrCommandLine(0) & _
                         " ;UID = " & gstrCommandLine(3) & _
                         " ;PWD = " & gstrCommandLine(4)
        
        'ãLèqÇ≥ÇÍÇΩÉAÉNÉZÉXÉ|ÉCÉìÉgÇ…ê⁄ë±
        .Connect = strConectPoint
        
        'èoóÕêÊê›íË
        .Destination = intDestinationConstants
        
        'ÉvÉåÉrÉÖÅ[ÉEÉBÉìÉhÉEÇÃê›íË
        If intDestinationConstants = crptToWindow Then
'''''            .WindowTitle = gcstrPrjName & " (" & gstrCommandLine(8) & ")"
            .WindowTitle = "äÆçœí ímèë"
            If Me.Top < 0 Then
                .WindowTop = 0
            Else
                .WindowTop = Me.Top / Screen.TwipsPerPixelY
            End If
            If Me.Left < 0 Then
                .WindowLeft = 0
            Else
                .WindowLeft = Me.Left / Screen.TwipsPerPixelX
            End If
            .WindowHeight = Me.Height / Screen.TwipsPerPixelY
            .WindowWidth = Me.Width / Screen.TwipsPerPixelX
        End If
        
        'ÉNÉäÉXÉ^ÉãÉåÉ|Å[ÉgÇÃÉtÉ@ÉCÉãÇ™Ç†ÇÈèÍèäÇãLèqÇ∑ÇÈ
        .ReportFileName = App.Path & "\QPAV_CEnt410.rpt"
        .DiscardSavedData = True
            
        'íäèoèåèÇãLèqÇ∑ÇÈÅiÉRÉìÉsÉÖÅ[É^ñºÅj
        strJoken = ""
        strJoken = strJoken & "{QPAZ_KansaiWT.QPAZ_TanmatsuId} = '" & gstrCommandLine(5) & "'"
        strJoken = strJoken & " AND {QPAZ_KansaiWT.QPAZ_TantoId} = '" & gstrCommandLine(1) & "'"
        If Trim$(mstrKeySyaincd2) <> "" Then
            'é–àıÉRÅ[ÉhéwíË  Å¶ëIëÇ≥ÇÍÇΩçsÇÃÇ›èoóÕëŒè€Ç∆Ç∑ÇÈ
            strJoken = strJoken & " AND {QPAZ_KansaiWT.QPAZ_Yushibi} = '" & mstrKeyYushibi & "'"
        End If
        .SelectionFormula = strJoken
            
        .DiscardSavedData = True
        
        'ÉNÉäÉXÉ^ÉãÉåÉ|Å[ÉgÇé¿çsÇ∑ÇÈ
        intRet = .PrintReport
            
        If intRet = 20545 Then
            Exit Sub
        ElseIf intRet <> 0 Then
            'ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWï\é¶
            Call QSAV_SysErr.subSysErr(gcstrPrjName, gstrCommandLine(1) _
                                    , gstrCommandLine(5), gstrGetErrDateFormat() _
                                    , Me.Caption, CStr(.LastErrorNumber), .LastErrorString)
        End If
    
    End With
    
    Exit Sub
    
sub410PrintRep_ERR:
    'ÉGÉâÅ[èàóù

    'ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWï\é¶
    Call gsubDBErrorMessage(gstrCommandLine(8), gcstrPrjName, gstrCommandLine(3), _
                            gstrCommandLine(5), gstrGetErrDateFormat)

End Sub

'***********************************************************************************
'    ÉNÉäÉXÉ^ÉãÉåÉ|Å[Ég ÉvÉåÉrÉÖÅ[ÅEàÛç¸ÅiäÆçœí ímÅj
'        ï‘ãpílÅFBoolean       True=OK     False=NG
'***********************************************************************************
Private Sub sub411PrintRep(intDestinationConstants As DestinationConstants)
    Dim strJoken                As String
    Dim strConectPoint          As String
    Dim intRet                  As Integer
    '--------------------------------------------
    
On Error GoTo sub411PrintRep_ERR

    With CrystalReport
        'ÉAÉNÉZÉXÇ∑ÇÈÉfÅ[É^ÉxÅ[ÉXÇ»Ç«ÇãLèq
        strConectPoint = "  DSN = " & gstrCommandLine(0) & _
                         " ;UID = " & gstrCommandLine(3) & _
                         " ;PWD = " & gstrCommandLine(4)
        
        'ãLèqÇ≥ÇÍÇΩÉAÉNÉZÉXÉ|ÉCÉìÉgÇ…ê⁄ë±
        .Connect = strConectPoint
        
        'èoóÕêÊê›íË
        .Destination = intDestinationConstants
        
        'ÉvÉåÉrÉÖÅ[ÉEÉBÉìÉhÉEÇÃê›íË
        If intDestinationConstants = crptToWindow Then
'''''            .WindowTitle = gcstrPrjName & " (" & gstrCommandLine(8) & ")"
            .WindowTitle = "äÆçœí ímèoóÕëŒè€é“àÍóó"
            If Me.Top < 0 Then
                .WindowTop = 0
            Else
                .WindowTop = Me.Top / Screen.TwipsPerPixelY
            End If
            If Me.Left < 0 Then
                .WindowLeft = 0
            Else
                .WindowLeft = Me.Left / Screen.TwipsPerPixelX
            End If
            .WindowHeight = Me.Height / Screen.TwipsPerPixelY
            .WindowWidth = Me.Width / Screen.TwipsPerPixelX
        End If
        
        'ÉNÉäÉXÉ^ÉãÉåÉ|Å[ÉgÇÃÉtÉ@ÉCÉãÇ™Ç†ÇÈèÍèäÇãLèqÇ∑ÇÈ
        .ReportFileName = App.Path & "\QPAV_CEnt411.rpt"
        .DiscardSavedData = True
            
        'íäèoèåèÇãLèqÇ∑ÇÈÅiÉRÉìÉsÉÖÅ[É^ñºÅj
        strJoken = ""
        strJoken = strJoken & "{QPAZ_KansaiWT.QPAZ_TanmatsuId} = '" & gstrCommandLine(5) & "'"
        strJoken = strJoken & " AND {QPAZ_KansaiWT.QPAZ_TantoId} = '" & gstrCommandLine(1) & "'"
        .SelectionFormula = strJoken
            
        .DiscardSavedData = True
        
        'ÉNÉäÉXÉ^ÉãÉåÉ|Å[ÉgÇé¿çsÇ∑ÇÈ
        intRet = .PrintReport
            
        If intRet = 20545 Then
            Exit Sub
        ElseIf intRet <> 0 Then
            'ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWï\é¶
            Call QSAV_SysErr.subSysErr(gcstrPrjName, gstrCommandLine(1) _
                                    , gstrCommandLine(5), gstrGetErrDateFormat() _
                                    , Me.Caption, CStr(.LastErrorNumber), .LastErrorString)
        End If
    
    End With
    
    Exit Sub
    
sub411PrintRep_ERR:
    'ÉGÉâÅ[èàóù

    'ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWï\é¶
    Call gsubDBErrorMessage(gstrCommandLine(8), gcstrPrjName, gstrCommandLine(3), _
                            gstrCommandLine(5), gstrGetErrDateFormat)

End Sub

'***********************************************************************************
'    ï∂éöï“èW ÅiÉXÉyÅ[ÉXñÑÇﬂÅj
'    à¯Å@êîÅF strPara_Moji ÅFString  ÅF ï“èWÇ∑ÇÈï∂éöóÒ
'    Å@Å@Å@ÅF intPara_Keta ÅFInteger ÅF ç≈èIìIÇ»åÖêî
'    Å@Å@Å@ÅF intPara_Mode ÅFInteger ÅF êÊì™Ç…ïtâ¡Ç∑ÇÈÇ©å„ÇÎÇ©ÅH  0=êÊì™  1=å„
'    ï‘ãpílÅF String ÅFï“èWÇ≥ÇÍÇΩåãâ ï∂éöóÒ
'***********************************************************************************
Private Function fncstrMojiEdit(strPara_Moji As String, intPara_Keta As Integer, intPara_Mode As Integer) As String
    Dim i        As Integer
    Dim strTmp   As String
    Dim strEdit  As String

    strTmp = StrConv(strPara_Moji, vbFromUnicode)

    If LenB(strTmp) = intPara_Keta Then
        'OKÅiåÖêîàÍívÇÃÇΩÇﬂèàóùÇ»ÇµÅj
        fncstrMojiEdit = strPara_Moji
    Else
        'NG
        If intPara_Mode = 0 Then
            'ëOÇ…ïtâ¡
            strEdit = ""
            For i = 1 To (intPara_Keta - LenB(strTmp))
                strEdit = strEdit & Space(1)
            Next i
            strEdit = strEdit & strPara_Moji
            fncstrMojiEdit = strEdit
        Else
            'å„ÇÎÇ…ïtâ¡
            strEdit = strPara_Moji
            For i = 1 To (intPara_Keta - LenB(strTmp))
                strEdit = strEdit & Space(1)
            Next i
            fncstrMojiEdit = strEdit
        End If
    End If

End Function







'***********************************************************************************
'    àÍóó  ÉNÉäÉbÉN    ï\é¶èáïœçX
'***********************************************************************************
Private Sub spdIchiran_Click(ByVal Col As Long, ByVal Row As Long)


    If Row = 0 And Col > 0 Then
        'SORT
        With spdIchiran
            If .MaxRows > 1 Then
                'SORTÉpÉ^Å[Éì
                .Row = 1     'ÉZÉãÉuÉçÉbÉNÇê›íË
                .Col = 1
                .Row2 = .MaxRows
                .Col2 = .MaxCols
                .SortBy = SS_SORT_BY_ROW
                .SortKey(1) = Col   'ëÊÇPÉ\Å[ÉgÉLÅ[Çê›íË
                
                If mlngSvCol = Col Then
                    'ëOâÒÇÃSORTÉLÅ[Ç∆ìØÇ∂
                    
                    Select Case mintSort
                        Case 0, 2   'èâä˙ OR ç~èá
                            'SORT
                            'è∏èáÇ…ï¿Ç◊ë÷Ç¶
                            .SortKeyOrder(1) = SS_SORT_ORDER_ASCENDING
                            
                            mintSort = 1
                        Case 1    'è∏èá
                            'SORT
                            'ç~èáÇ…ï¿Ç◊ë÷Ç¶
                            .SortKeyOrder(1) = SS_SORT_ORDER_DESCENDING
                            
                            mintSort = 2
                    End Select
                Else
                    'ëOâÒÇÃSORTÉLÅ[Ç∆à·Ç§
                    
                    'è∏èáÇ…ï¿Ç◊ë÷Ç¶
                    .SortKeyOrder(1) = SS_SORT_ORDER_ASCENDING
                    
                    mintSort = 1
                End If
                
                'é¿çs
                .Action = SS_ACTION_SORT
                mlngSvCol = Col
            End If
        End With
    End If

End Sub





'***********************************************************************************
'    äÆçœì˙FromTo îN  Chenge Event ÉtÉãåÖíEèo
'***********************************************************************************
Private Sub txtKansaibiY_Change()

    If blnNoChangeEvFlg = True Then Exit Sub

    'äÆçœì˙FromTo ÉtÉãåÖíEèo
    Call gsubMaxCharSkipEX(txtKansaibiY, 4)
    
    'ÉGÉâÅ[ÉNÉäÉA
    Call subErrCrear

End Sub
'***********************************************************************************
'    äÆçœì˙FromTo îN  GotFocus EventÅ@ÉeÉLÉXÉgëIë
'***********************************************************************************
Private Sub txtKansaibiY_GotFocus()
    Call gsubSelectText(txtKansaibiY)
End Sub
'***********************************************************************************
'    äÆçœì˙FromTo îN  KeyPress EventÅ@ì¸óÕï∂éöêßå‰
'***********************************************************************************
Private Sub txtKansaibiY_KeyPress(KeyAscii As Integer)
    KeyAscii = gIntFilterKey(KeyAscii, "1234567890")
End Sub


'***********************************************************************************
'    äÆçœì˙FromTo åé  GotFocus EventÅ@ÉeÉLÉXÉgëIë
'***********************************************************************************
Private Sub txtKansaibiM_GotFocus()
    Call gsubSelectText(txtKansaibiM)
End Sub
'***********************************************************************************
'    äÆçœì˙FromTo åé  KeyPress EventÅ@ì¸óÕï∂éöêßå‰
'***********************************************************************************
Private Sub txtKansaibiM_KeyPress(KeyAscii As Integer)
    'ÉGÉâÅ[ÉNÉäÉA
    Call subErrCrear
    KeyAscii = gIntFilterKey(KeyAscii, "1234567890")
End Sub
'***********************************************************************************
'    äÆçœì˙FromTo åé  LostFocus Event
'***********************************************************************************
Private Sub txtKansaibiM_LostFocus()
    If IsNumeric(txtKansaibiM.Text) = True Then
        blnNoChangeEvFlg = True
        txtKansaibiM.Text = Format(txtKansaibiM.Text, "00")
        blnNoChangeEvFlg = False
    End If
End Sub




'***********************************************************************************
'    é–àıÉRÅ[ÉhÇP  Chenge Event ÉtÉãåÖíEèo
'***********************************************************************************
Private Sub txtSyainCD1_Change()

    If blnNoChangeEvFlg = True Then Exit Sub

    Call gsubMaxCharSkipEX(txtSyainCD1, 1)
    
    'ÉGÉâÅ[ÉNÉäÉA
    Call subErrCrear

End Sub
'***********************************************************************************
'    é–àıÉRÅ[ÉhÇP  GotFocus EventÅ@ÉeÉLÉXÉgëIë
'***********************************************************************************
Private Sub txtSyainCD1_GotFocus()
    Call gsubSelectText(txtSyainCD1)
End Sub
'''''''***********************************************************************************
'''''''    é–àıÉRÅ[ÉhÇP  KeyPress EventÅ@ì¸óÕï∂éöêßå‰
'''''''***********************************************************************************
''''''Private Sub txtSyainCD1_KeyPress(KeyAscii As Integer)
''''''    KeyAscii = gIntFilterKey(KeyAscii, "1234567890")
''''''End Sub
'***********************************************************************************
'    é–àıÉRÅ[ÉhÇP  LostFocus Event
'***********************************************************************************
Private Sub txtSyainCD1_LostFocus()
    
    blnNoChangeEvFlg = True
    txtSyainCD1 = StrConv(txtSyainCD1, vbUpperCase)
    blnNoChangeEvFlg = False
    
End Sub


'***********************************************************************************
'    é–àıÉRÅ[ÉhÇQ  GotFocus EventÅ@ÉeÉLÉXÉgëIë
'***********************************************************************************
Private Sub txtSyainCD2_GotFocus()
    Call gsubSelectText(txtSyainCD2)
End Sub
'***********************************************************************************
'    é–àıÉRÅ[ÉhÇQ  KeyPress EventÅ@ì¸óÕï∂éöêßå‰
'***********************************************************************************
Private Sub txtSyainCD2_KeyPress(KeyAscii As Integer)
    'ÉGÉâÅ[ÉNÉäÉA
    Call subErrCrear
    KeyAscii = gIntFilterKey(KeyAscii, "1234567890")
End Sub



'***********************************************************************************
'    î≠çsì˙ îN  Chenge Event ÉtÉãåÖíEèo
'***********************************************************************************
Private Sub txtHakkoubiY_Change()

    If blnNoChangeEvFlg = True Then Exit Sub

    'î≠çsì˙ ÉtÉãåÖíEèo
    Call gsubMaxCharSkipEX(txtHakkoubiY, 4)
    
    'ÉGÉâÅ[ÉNÉäÉA
    Call subErrCrear

End Sub
'***********************************************************************************
'    î≠çsì˙ îN  GotFocus EventÅ@ÉeÉLÉXÉgëIë
'***********************************************************************************
Private Sub txtHakkoubiY_GotFocus()
    Call gsubSelectText(txtHakkoubiY)
End Sub
'***********************************************************************************
'    î≠çsì˙ îN  KeyPress EventÅ@ì¸óÕï∂éöêßå‰
'***********************************************************************************
Private Sub txtHakkoubiY_KeyPress(KeyAscii As Integer)
    KeyAscii = gIntFilterKey(KeyAscii, "1234567890")
End Sub


'***********************************************************************************
'    î≠çsì˙ åé  Chenge Event ÉtÉãåÖíEèo
'***********************************************************************************
Private Sub txtHakkoubiM_Change()

    If blnNoChangeEvFlg = True Then Exit Sub

    'î≠çsì˙ ÉtÉãåÖíEèo
    Call gsubMaxCharSkipEX(txtHakkoubiM, 2)
    
    'ÉGÉâÅ[ÉNÉäÉA
    Call subErrCrear

End Sub
'***********************************************************************************
'    î≠çsì˙ åé  GotFocus EventÅ@ÉeÉLÉXÉgëIë
'***********************************************************************************
Private Sub txtHakkoubiM_GotFocus()
    Call gsubSelectText(txtHakkoubiM)
End Sub
'***********************************************************************************
'    î≠çsì˙ åé  KeyPress EventÅ@ì¸óÕï∂éöêßå‰
'***********************************************************************************
Private Sub txtHakkoubiM_KeyPress(KeyAscii As Integer)
    'ÉGÉâÅ[ÉNÉäÉA
    Call subErrCrear
    KeyAscii = gIntFilterKey(KeyAscii, "1234567890")
End Sub
'***********************************************************************************
'    î≠çsì˙ åé  LostFocus Event
'***********************************************************************************
Private Sub txtHakkoubiM_LostFocus()
    If IsNumeric(txtHakkoubiM.Text) = True Then
        blnNoChangeEvFlg = True
        txtHakkoubiM.Text = Format(txtHakkoubiM.Text, "00")
        blnNoChangeEvFlg = False
    End If
End Sub


'***********************************************************************************
'    î≠çsì˙ ì˙  GotFocus EventÅ@ÉeÉLÉXÉgëIë
'***********************************************************************************
Private Sub txtHakkoubiD_GotFocus()
    Call gsubSelectText(txtHakkoubiD)
End Sub
'***********************************************************************************
'    î≠çsì˙ ì˙  KeyPress EventÅ@ì¸óÕï∂éöêßå‰
'***********************************************************************************
Private Sub txtHakkoubiD_KeyPress(KeyAscii As Integer)
    'ÉGÉâÅ[ÉNÉäÉA
    Call subErrCrear
    KeyAscii = gIntFilterKey(KeyAscii, "1234567890")
End Sub
'***********************************************************************************
'    î≠çsì˙ ì˙  LostFocus Event
'***********************************************************************************
Private Sub txtHakkoubiD_LostFocus()
    If IsNumeric(txtHakkoubiD.Text) = True Then
        blnNoChangeEvFlg = True
        txtHakkoubiD.Text = Format(txtHakkoubiD.Text, "00")
        blnNoChangeEvFlg = False
    End If
End Sub




























